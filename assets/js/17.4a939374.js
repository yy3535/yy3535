(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{173:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("p"),t._m(2),a("p"),t._v(" "),t._m(3),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://docs.docker.com/install/linux/docker-ce/centos/",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker 连接"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("docker 自带DNS功能  可以通过名字 互相访问")]),t._v(" "),a("li",[t._v("所有的指令都是 docker 打头")])]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("img",{attrs:{src:t.$withBase("/img/docker.jpg")}}),t._v(" "),t._m(6),t._v(" "),t._m(7),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),t._m(22),t._m(23),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),t._m(28),t._m(29),t._v(" "),t._m(30),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._m(36),t._v(" "),t._m(37),t._m(38),t._v(" "),t._m(39),t._m(40),t._v(" "),t._m(41),t._m(42),t._v(" "),t._m(43),t._m(44),t._v(" "),t._m(45),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._m(50),t._v(" "),t._m(51),t._v(" "),t._m(52),t._m(53),t._v(" "),t._m(54),t._m(55),t._v(" "),t._m(56),t._v(" "),t._m(57),t._v(" "),t._m(58),t._v(" "),t._m(59),t._v(" "),t._m(60),t._m(61),t._v(" "),t._m(62),t._m(63),t._v(" "),t._m(64),t._m(65),t._v(" "),t._m(66),t._m(67),t._v(" "),t._m(68)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"docker"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker","aria-hidden":"true"}},[this._v("#")]),this._v(" docker")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 Linux 容器解决方案。Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#安装"}},[t._v("安装")])]),a("li",[a("a",{attrs:{href:"#docker架构"}},[t._v("Docker架构")])]),a("li",[a("a",{attrs:{href:"#阿里云加速"}},[t._v("阿里云加速")])]),a("li",[a("a",{attrs:{href:"#image"}},[t._v("image")])]),a("li",[a("a",{attrs:{href:"#容器"}},[t._v("容器")])]),a("li",[a("a",{attrs:{href:"#制作镜像-使用"}},[t._v("制作镜像 && 使用")]),a("ul",[a("li",[a("a",{attrs:{href:"#制作dockerfile"}},[t._v("制作Dockerfile")])]),a("li",[a("a",{attrs:{href:"#dockerfile编写例子-使用"}},[t._v("Dockerfile编写例子 && 使用")])])])]),a("li",[a("a",{attrs:{href:"#数据盘"}},[t._v("数据盘")])]),a("li",[a("a",{attrs:{href:"#网络"}},[t._v("网络")])]),a("li",[a("a",{attrs:{href:"#compose"}},[t._v("compose")]),a("ul",[a("li",[a("a",{attrs:{href:"#docker-compose-yml-使用"}},[t._v("docker-compose.yml 使用")])])])]),a("li",[a("a",{attrs:{href:"#实战"}},[t._v("实战")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("centos7.2中安装docker")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("yum -y install docker-io")])]),t._v(" "),a("li",[a("p",[t._v("docker version")])]),t._v(" "),a("li",[a("p",[t._v("docker info")])]),t._v(" "),a("li",[a("p",[t._v("启动docker服务 systemctl start docker")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"docker架构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker架构","aria-hidden":"true"}},[this._v("#")]),this._v(" Docker架构")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"阿里云加速"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#阿里云加速","aria-hidden":"true"}},[this._v("#")]),this._v(" 阿里云加速")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("mkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("docker\ntee "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("docker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("daemon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'EOF'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"registry-mirrors"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://fwvjnv59.mirror.aliyuncs.com"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EOF")]),t._v("\nsystemctl daemon"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("reload\nsystemctl restart docker\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"image"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#image","aria-hidden":"true"}},[this._v("#")]),this._v(" image")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("镜像  image 文件可以看作是容器的模板 一个 image 文件往往通过继承另一个 image 文件，加上一些个性化设置而生成  用来实例化的  可比喻一个类")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("基本操作")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("命令")]),t._v(" "),a("th",[t._v("含义")]),t._v(" "),a("th",[t._v("案例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("images")]),t._v(" "),a("td",[t._v("查看全部镜像")]),t._v(" "),a("td",[t._v("docker image ls")])]),t._v(" "),a("tr",[a("td",[t._v("search")]),t._v(" "),a("td",[t._v("查找镜像")]),t._v(" "),a("td",[t._v("docker search [imageName]")])]),t._v(" "),a("tr",[a("td",[t._v("pull")]),t._v(" "),a("td",[t._v("拉取镜像")]),t._v(" "),a("td",[t._v("docker pull [imageName]")])]),t._v(" "),a("tr",[a("td",[t._v("rmi")]),t._v(" "),a("td",[t._v("删除镜像")]),t._v(" "),a("td",[t._v("docker rmi [imageName]")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#容器","aria-hidden":"true"}},[this._v("#")]),this._v(" 容器")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("docker run 命令会从 image 文件，生成一个正在运行的容器实例 就像 new object 一样")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("table",[a("thead",[a("tr",[a("th",[t._v("命令")]),t._v(" "),a("th",[t._v("含义")]),t._v(" "),a("th",[t._v("案例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("run")]),t._v(" "),a("td",[t._v("从镜像运行一个容器")]),t._v(" "),a("td",[t._v("docker run ubuntu /bin/echo 'hello-world'")])]),t._v(" "),a("tr",[a("td",[t._v("--rm")]),t._v(" "),a("td",[t._v("运行完自动删除")]),t._v(" "),a("td",[t._v("docker run --rm ubuntu /bin/bash")])]),t._v(" "),a("tr",[a("td",[t._v("ps")]),t._v(" "),a("td",[t._v("查看当前运行的容器")]),t._v(" "),a("td",[t._v("docker ps -a -l")])]),t._v(" "),a("tr",[a("td",[t._v("kill [containerId]")]),t._v(" "),a("td",[t._v("终止容器(发送SIGKILL )")]),t._v(" "),a("td",[t._v("docker kill [containerId]")])]),t._v(" "),a("tr",[a("td",[t._v("rm [containerId]")]),t._v(" "),a("td",[t._v("删除容器")]),t._v(" "),a("td",[t._v("docker rm [containerId]")])]),t._v(" "),a("tr",[a("td",[t._v("start [containerId]")]),t._v(" "),a("td",[t._v("启动已经生成、已经停止运行的容器文件")]),t._v(" "),a("td",[t._v("docker start [containerId]")])]),t._v(" "),a("tr",[a("td",[t._v("stop [containerId]")]),t._v(" "),a("td",[t._v("终止容器运行 (发送 SIGTERM )")]),t._v(" "),a("td",[t._v("docker stop [containerId]")])]),t._v(" "),a("tr",[a("td",[t._v("logs [containerId]")]),t._v(" "),a("td",[t._v("查看 docker 容器的输出")]),t._v(" "),a("td",[t._v("docker logs [containerId]")])]),t._v(" "),a("tr",[a("td",[t._v("attach [containerId]")]),t._v(" "),a("td",[t._v("进入容器")]),t._v(" "),a("td",[t._v("docker attach [containerId]")])]),t._v(" "),a("tr",[a("td",[t._v("exec [containerId]")]),t._v(" "),a("td",[t._v("进入一个正在运行的 docker 容器")]),t._v(" "),a("td",[t._v("docker container exec -it [containerID] /bin/bash")])]),t._v(" "),a("tr",[a("td",[t._v("cp [containerId]")]),t._v(" "),a("td",[t._v("从正在运行的 Docker 容器里面，将文件拷贝到本机")]),t._v(" "),a("td",[t._v("docker container cp [containID]:app/package.json")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"制作镜像-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#制作镜像-使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 制作镜像 && 使用")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("制作个性化镜像\n    docker commit "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("m"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"songge"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("containerId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" songge"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hello"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    docker images\n    docker run zhangrenyang"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("hello "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"制作dockerfile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#制作dockerfile","aria-hidden":"true"}},[this._v("#")]),this._v(" 制作Dockerfile")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("docker inspect centos")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("Docker 的镜像是用一层一层的文件组成的")]),t._v(" "),a("li",[t._v("docker inspect命令可以查看镜像或者容器")]),t._v(" "),a("li",[t._v("Layers就是镜像的层文件，只读不能修改。基于镜像创建的容器会共享这些文件层")]),t._v(" "),a("li",[t._v(".dockerignore(忽略文件)\n"),a("ul",[a("li",[t._v(".git")]),t._v(" "),a("li",[t._v("node_modules")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("编写Dockerfile")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("命令")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("含义")]),t._v(" "),a("th",[t._v("案例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("FROM")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("继承的镜像")]),t._v(" "),a("td",[t._v("FROM node")])]),t._v(" "),a("tr",[a("td",[t._v("COPY")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("拷贝")]),t._v(" "),a("td",[t._v("COPY ./app /app")])]),t._v(" "),a("tr",[a("td",[t._v("WORKDIR")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("指定工作路径")]),t._v(" "),a("td",[t._v("WORKDIR /app")])]),t._v(" "),a("tr",[a("td",[t._v("RUN")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("编译打包阶段运行命令")]),t._v(" "),a("td",[t._v("RUN npm install")])]),t._v(" "),a("tr",[a("td",[t._v("EXPOSE")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("暴露端口")]),t._v(" "),a("td",[t._v("EXPOSE 3000")])]),t._v(" "),a("tr",[a("td",[t._v("CMD")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("容器运行阶段运行命令")]),t._v(" "),a("td",[t._v("CMD npm run start")])])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"dockerfile编写例子-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile编写例子-使用","aria-hidden":"true"}},[this._v("#")]),this._v(" Dockerfile编写例子 && 使用")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("、node 安装\n    wget "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("qO"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" https"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("raw"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("githubusercontent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("creationix"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nvm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("v0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("33.11")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" bash\n    nvm install stable\n    node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v\n    npm i cnpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g\n    npm i nrm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("、安装express\n    npm install express"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("generator "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("g\n    express app\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("、Dockerfile\n    vim Dockerfile\n    写入 \n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" node\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("COPY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WORKDIR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" npm install\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXPOSE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("、运行 docker build "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t express"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("demo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t用来指定image镜像的名称，后面还可以加冒号指定标签，如果不指定默认就是latest\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("表示Dockerfile文件的所有路径"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("就表示当前路径\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("、使用\ndocker container run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3333")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("it express"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("demo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bash\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("、发布\ndocker login\ndocker image tag "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("imageName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndocker image build "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("repository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\ndocker tag express"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("demo songge"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),t._v("\ndocker push songge"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("express"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("demo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("3注释\n"),a("ul",[a("li",[t._v("FROM 表示该镜像继承的镜像 :表示标签")]),t._v(" "),a("li",[t._v("COPY 是将当前目录下的app目录下面的文件都拷贝到image里的/app目录中")]),t._v(" "),a("li",[t._v("WORKDIR 指定工作路径，类似于执行 cd 命令")]),t._v(" "),a("li",[t._v("RUN npm install 在/app目录下安装依赖，安装后的依赖也会打包到image目录中")]),t._v(" "),a("li",[t._v("EXPOSE 暴露3000端口，允许外部连接这个端口")])])]),t._v(" "),a("li",[t._v("4注释\n"),a("ul",[a("li",[t._v("-p 参数是将容器的3000端口映射为本机的3333端口,通过访问本机的3333端口就可以 访问到容器的3000")]),t._v(" "),a("li",[t._v("-it 参数是将容器的shell容器映射为当前的shell,在本机容器中执行的命令都会发送到容器当中执行express-demo image的名称")]),t._v(" "),a("li",[t._v("/bin/bash 容器启动后执行的第一个命令,这里是启动了bash容器以便执行脚本")]),t._v(" "),a("li",[t._v("--rm 在容器终止运行后自动删除容器文件")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"数据盘"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据盘","aria-hidden":"true"}},[this._v("#")]),this._v(" 数据盘")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[a("p",[t._v("删除容器的时候，容器层里创建的文件也会被删除掉，如果有些数据你想永久保存，比如Web服务器的日志，数据库管理系统中的数据，可以为容器创建一个数据盘。")])]),t._v(" "),a("li",[a("p",[t._v("创建容器的时候我们可以通过-v或--volumn给它指定一下数据盘")])]),t._v(" "),a("li",[a("p",[t._v("指定数据盘")]),t._v(" "),a("ul",[a("li",[t._v("~/data:/mnt 把当前用户目录中的data目录映射到/mnt上")]),t._v(" "),a("li",[t._v(": 前是linux内的空间  后是容器内的空间")])])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("mkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data\ndocker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("ti "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name logs2 centos bash\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt\necho "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v("txt\nexit\ncat "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.")]),t._v("txt\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("容器共享数据盘")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("docker create "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name logger "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("centos")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("在linux中创建数据盘"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("logger"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndocker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("volumes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name logger3 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t centos "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("初始化容器指定logger容器"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt \ntouch logger3\ndocker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("volumes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name logger4 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("t centos bash\ncd "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt\ntouch logger4\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("管理数据盘")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("docker volume ls 列出所有的数据盘\ndocker volume ls "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f dangling"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" 列出已经孤立的数据盘\ndocker volume rm xxxx\ndocker volume ls\ndocker rm logger1 logger2\ndocker volume inspect xxx\ndocker rm logger "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("v\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#网络","aria-hidden":"true"}},[this._v("#")]),this._v(" 网络")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("docker里面有一个DNS服务，可以通过容器名称访问主机 网络类型")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),s("p",[this._v("none 无网络，对外界完全隔离")]),this._v(" "),s("p",[this._v("host 主机网络")]),this._v(" "),s("p",[this._v("bridge 桥接网络，默认网络")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("bridge")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("docker network ls\ndocker inspect bridge\ndocker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name server1 nginx\ndocker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name server2 nginx\ndocker exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("it server1 bash\nping server2\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("none")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name server_none "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("net none nginx\ndocker inspect none\ndocker exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("it server_none bash\nip addr\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("host")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("docker run "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("name server_host "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("net host nginx\ndocker inspect none\ndocker exec "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("it server_host bash\nip addr\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("访问桥接网络里面的服务\n"),s("ul",[s("li",[this._v("访问主机的8080端口会被定向到容器的80端口")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('docker inspect nginx\ndocker run -d --name server_nginx -p "8080:80"  nginx\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("查看主机绑定的端口")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[this._v("docker inspect "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("[")]),this._v("容器名称"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[this._v("]")]),this._v("\ndocker port server_nginx\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"compose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compose","aria-hidden":"true"}},[this._v("#")]),this._v(" compose")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[this._v(" 安装 pip install docker"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("-")]),this._v("compose\n")])])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ul",[a("li",[t._v("Compose 通过一个配置文件来管理多个Docker容器，在配置文件中，所有的容器通过services来定义，然后使用docker-compose脚本来启动，停止和重启应用，和应用中的服务以及所有依赖服务的容器，非常适合组合使用多个容器进行开发的场景 步骤：")]),t._v(" "),a("li",[t._v("在 docker-compose.yml 中定义组成应用程序的服务，以便它们可以在隔离的环境中一起运行。")]),t._v(" "),a("li",[t._v("最后，运行docker-compose up，Compose 将启动并运行整个应用程序。 配置文件组成")]),t._v(" "),a("li",[t._v("services 可以定义需要的服务，每个服务都有自己的名字、使用的镜像、挂载的数据卷所属的网络和依赖的其它服务。")]),t._v(" "),a("li",[t._v("networks 是应用的网络，在它下面可以定义使用的网络名称，类性。")]),t._v(" "),a("li",[t._v("volumes是数据卷，可以在此定义数据卷，然后挂载到不同的服务上面使用。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"docker-compose-yml-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-yml-使用","aria-hidden":"true"}},[this._v("#")]),this._v(" docker-compose.yml 使用")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("空格缩进表示层次")]),this._v(" "),s("li",[this._v("冒号空格后面有空格")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('version: \'2\'\nservices:\n  zfpx1:\n    image: nginx\n    port:\n      - "8080:80"\n  zfpx2:\n    image: nginx\n    port:\n      - "8081:80"\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("nginx工具包")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("docker体积很小")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[this._v("apt update\n#ping\napt install inetutils"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("-")]),this._v("ping \n#nslookup\napt install dnsutils   \n#ifconfig \napt install net"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("-")]),this._v("tools    \n#ip\napt install iproute2     \n#curl\napt install curl\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("启动")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("docker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose up 启动所有的服务\ndocker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("d 后台启动所有的服务\ndocker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose ps 打印所有的容器\ndocker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose stop 停止所有服务\ndocker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose logs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("f 持续跟踪日志\ndocker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose exec zfpx1 bash 进入zfpx服务系统\ndocker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose rm 删除服务容器\ndocker network ls 网络不会删除\ndocker"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("compose down 删除网路\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"实战"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实战","aria-hidden":"true"}},[this._v("#")]),this._v(" 实战")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("nodeapp 是一个用 Docker 搭建的本地 Node.js 应用开发与运行环境。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("服务")]),this._v(" "),s("p",[this._v("node：启动node服务")]),this._v(" "),s("p",[this._v("web：使用 nginx 作为应用的 web 服务器")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("结构")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("app：这个目录存储应用")]),t._v(" "),a("ul",[a("li",[t._v("web 放应用的代码")])])]),t._v(" "),a("li",[a("p",[t._v("services： 环境里定义的服务需要的一些服务")])]),t._v(" "),a("li",[a("p",[t._v("images: 方式一些贬义的脚本和镜像")])]),t._v(" "),a("li",[a("p",[t._v("docker-compose.yml：定义本地开发环境需要的服务")])]),t._v(" "),a("li",[a("p",[t._v("images/nginx/config/default.conf 放置nginx 配置文件")])]),t._v(" "),a("li",[a("p",[t._v("node 的Dockfile配置文件")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("docker-compose.yml")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\nservices"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  build"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("images"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("node\n    dockerfile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Dockerfile\n  volumes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("web\n  depends_on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" db\n web"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n  ports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8080:80"')]),t._v("\n  volumes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("images"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("nginx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("d\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("app"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("web"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("views"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("views  \n  depends_on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" node\n db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mariadb\n  environment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root"')]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MYSQL_DATABASE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node"')]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MYSQL_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"zfpx"')]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MYSQL_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),t._v("\n  volumes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mysql\nvolumes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  driver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" local\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("app/web/server.js")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mysql  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" connection "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  host     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'db'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  user     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zfpx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  password "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  database "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nconnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" server"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SELECT 2 + 2 AS solution'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" results"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fields")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("results"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("solution"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nserver"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("package.json")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node server.js"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("images/node/Dockerfile")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FROM")]),t._v(" node\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MAINTAINER")]),t._v(" zhangrenyang "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("zhang_renyang@"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("126.")]),t._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WORKDIR")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("web\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUN")]),t._v(" npm install\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CMD")]),t._v(" npm start\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("images/nginx/config/default.conf")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("upstream backend "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    server node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nserver "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    root "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("mnt"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("views"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    index index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    location "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("api "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        proxy_pass http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("backend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])}],!1,null,null,null);s.default=n.exports}}]);