"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6832],{4398:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-ed83b73a",path:"/Backend/node.html",title:"node",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"浏览器事件环（event loop）",slug:"浏览器事件环-event-loop",children:[]},{level:2,title:"Node",slug:"node-1",children:[{level:3,title:"node安装",slug:"node安装",children:[]},{level:3,title:"node start",slug:"node-start",children:[]},{level:3,title:"node event loop",slug:"node-event-loop",children:[]},{level:3,title:"global",slug:"global",children:[]}]},{level:2,title:"内置模块",slug:"内置模块",children:[{level:3,title:"vm",slug:"vm",children:[]},{level:3,title:"path",slug:"path",children:[]},{level:3,title:"fs模块",slug:"fs模块",children:[]},{level:3,title:"events模块",slug:"events模块",children:[]},{level:3,title:"流",slug:"流",children:[]},{level:3,title:"http模块",slug:"http模块",children:[]},{level:3,title:"crypto模块",slug:"crypto模块",children:[]},{level:3,title:"util模块",slug:"util模块",children:[]},{level:3,title:"readline模块",slug:"readline模块",children:[]}]},{level:2,title:"手写一个common.js规范",slug:"手写一个common-js规范",children:[]},{level:2,title:"第三方模块",slug:"第三方模块",children:[{level:3,title:"npm",slug:"npm",children:[]},{level:3,title:"第三方模块的查找",slug:"第三方模块的查找",children:[]}]},{level:2,title:"实现全局命令",slug:"实现全局命令",children:[{level:3,title:"把我的包发布到npm官网",slug:"把我的包发布到npm官网",children:[]}]},{level:2,title:"Buffer类",slug:"buffer类",children:[{level:3,title:"声明方式",slug:"声明方式",children:[]},{level:3,title:"方法（数组的方法 length 字节的个数）",slug:"方法-数组的方法-length-字节的个数",children:[]},{level:3,title:"mz模块",slug:"mz模块",children:[]},{level:3,title:"websocket",slug:"websocket",children:[]}]},{level:2,title:"express",slug:"express-1",children:[]}],filePathRelative:"Backend/node.md",git:{updatedTime:1629449373e3,contributors:[]}}},1069:(n,s,a)=>{a.r(s),a.d(s,{default:()=>bt});var t=a(6252),e=a(9882);const o=(0,t._)("h1",{id:"node",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#node","aria-hidden":"true"},"#"),(0,t.Uk)(" node")],-1),c={class:"table-of-contents"},p=(0,t.Uk)("浏览器事件环（event loop）"),l=(0,t.Uk)("Node"),u=(0,t.Uk)("node安装"),k=(0,t.Uk)("node start"),_=(0,t.Uk)("node event loop"),i=(0,t.Uk)("global"),r=(0,t.Uk)("内置模块"),U=(0,t.Uk)("vm"),b=(0,t.Uk)("path"),m=(0,t.Uk)("fs模块"),d=(0,t.Uk)("events模块"),f=(0,t.Uk)("流"),g=(0,t.Uk)("http模块"),y=(0,t.Uk)("crypto模块"),h=(0,t.Uk)("util模块"),w=(0,t.Uk)("readline模块"),v=(0,t.Uk)("手写一个common.js规范"),x=(0,t.Uk)("第三方模块"),j=(0,t.Uk)("npm"),q=(0,t.Uk)("第三方模块的查找"),S=(0,t.Uk)("实现全局命令"),L=(0,t.Uk)("把我的包发布到npm官网"),C=(0,t.Uk)("Buffer类"),P=(0,t.Uk)("声明方式"),E=(0,t.Uk)("方法（数组的方法 length 字节的个数）"),O=(0,t.Uk)("mz模块"),T=(0,t.Uk)("websocket"),z=(0,t.Uk)("express"),N=(0,t._)("p",null,"文档：http://nodejs.cn/api/",-1),R=(0,t._)("h2",{id:"浏览器事件环-event-loop",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#浏览器事件环-event-loop","aria-hidden":"true"},"#"),(0,t.Uk)(" 浏览器事件环（event loop）")],-1),H=(0,t._)("ul",null,[(0,t._)("li",null,"js是单线程，也可以说是多线程(比如setTimeout)"),(0,t._)("li",null,"代码从上到下执行 会先执行同步 再执行异步"),(0,t._)("li",null,[(0,t.Uk)("异步任务 "),(0,t._)("ul",null,[(0,t._)("li",null,"宏任务：慢"),(0,t._)("li",null,"微任务：快")])])],-1),F=(0,t._)("p",null,[(0,t._)("strong",null,"宏任务macro"),(0,t.Uk)("： "),(0,t._)("code",null,"setTimeout"),(0,t.Uk)(),(0,t._)("code",null,"ie的setImmediate"),(0,t.Uk)(),(0,t._)("code",null,"ie的 MessageChannel")],-1),M=(0,t._)("p",null,[(0,t._)("strong",null,"微任务micro"),(0,t.Uk)("： "),(0,t._)("code",null,"promise.then方法"),(0,t.Uk)(),(0,t._)("code",null,"MutationObserver对象（监听dom元素的变化）")],-1),W=(0,t._)("ul",null,[(0,t._)("li",null,"vm.$nextTick(function(){})，会判断所有的宏任务和微任务，让其代码最后执行")],-1),I=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"windows原生对象 MutationObserver和MessageChannel"),(0,t._)("ul",null,[(0,t._)("li",null,"MutationObserver 微任务 监听dom元素的变化 会等待所有代码都执行完再去执行回调")]),(0,t._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t._)("pre",{class:"language-html"},[(0,t._)("code",null,[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("div")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"id"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("div")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("script")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t._)("span",{class:"token script"},[(0,t._)("span",{class:"token language-javascript"},[(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" observer"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"MutationObserver"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'节点已更新'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// 节点已更新"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("childList"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// 40"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("document"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getElementById"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'app'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  observer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"observe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    childList"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token boolean"},"true"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"for"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"<"),(0,t._)("span",{class:"token number"},"20"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"appendChild"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("document"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'p'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"for"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"<"),(0,t._)("span",{class:"token number"},"20"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"appendChild"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("document"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createElement"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'span'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("script")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br")])]),(0,t._)("ul",null,[(0,t._)("li",null,"MessageChannel 消息通道 宏任务")]),(0,t._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t._)("pre",{class:"language-html"},[(0,t._)("code",null,[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("div")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"id"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("div")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("script")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t._)("span",{class:"token script"},[(0,t._)("span",{class:"token language-javascript"},[(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" channel"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"MessageChannel"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  channel"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("port1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"postMessage"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'我爱你'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  channel"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("port2"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"onmessage"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'hello'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// hello"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// 我爱你"),(0,t.Uk)("\n")])]),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("script")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br")])])],-1),D=(0,t._)("p",null,"浏览器中，先执行主栈同步任务，微任务放入微任务队列，宏任务到时间了放入宏任务队列（按执行顺序放入，setTimeout先放入缓存，到时间了再放），主栈执行完后，执行完微任务，再取出宏任务队列中第一个执行，执行完后再次执行完微任务，再取第二个宏任务。",-1),A=(0,t._)("p",null,"————— 环",-1),B=(0,t._)("p",null,[(0,t._)("img",{src:e,alt:"eventloop"})],-1),$=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 宏任务微任务执行顺序"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'timeout1'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  Promise"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"then"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'then1'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nPromise"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"then"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'then2'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'timeout2'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// then2"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// timeout1"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// then1"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// timeout2"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br")])],-1),G=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 求执行顺序"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"async1"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'async1 start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"async2"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"async2"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'async2'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'script start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'setTimeout'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("  \n"),(0,t._)("span",{class:"token function"},"async1"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Promise"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"resolve"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'promise1'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"then"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'promise2'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'script end'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// script start"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// async1 start"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// async2"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// promise1"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// script end"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// promise2"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// setTimeout"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br")])],-1),J=(0,t._)("h2",{id:"node-1",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#node-1","aria-hidden":"true"},"#"),(0,t.Uk)(" Node")],-1),K=(0,t._)("ul",null,[(0,t._)("li",null,"node不包含JavaScript全集(es+dom+bom)，node基于v8，"),(0,t._)("li",null,"node包含ecmascript+模块(读写文件等)"),(0,t._)("li",null,"提供简单 高性能服务器（cup密集 计算 i/o密集 文件读取） 适合做工具类，扩展类，中间层等"),(0,t._)("li",null,[(0,t.Uk)("分配单位 靠的是"),(0,t._)("strong",null,"进程"),(0,t.Uk)(" 进程中 一个环境 环境中可以开很多线程 （主线程是单线程 node api异步的） 底层还是通过多线程来模拟了异步 libuv库来实现异步")]),(0,t._)("li",null,[(0,t.Uk)("java 多"),(0,t._)("strong",null,"线程"),(0,t.Uk)("（切换执行上下文 切换的很快） 并发操作同一个文件 锁的概念。 "),(0,t._)("ul",null,[(0,t._)("li",null,"线程池里有固定线程数，一个线程用完就返回到线程池中，等待下一次调用"),(0,t._)("li",null,"缺点：要锁文件 和 频繁的切换上下文导致性能消耗")])]),(0,t._)("li",null,[(0,t.Uk)("node 通过回调（"),(0,t._)("strong",null,"事件驱动"),(0,t.Uk)("）的方式 "),(0,t._)("img",{src:"/img/多线程单线程.png",alt:"屏幕快照 2019-04-06 21.46.45"})]),(0,t._)("li",null,"异步/同步 被调用方 可以决定此方法是 同步还是异步的"),(0,t._)("li",null,[(0,t._)("strong",null,"阻塞和非阻塞"),(0,t.Uk)(" 调用方的状态就是 阻塞或者非阻塞 同步阻塞 异步非阻塞")])],-1),X=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"TIP"),(0,t._)("ul",null,[(0,t._)("li",null,"heap:堆，对象引用函数地址放在堆里"),(0,t._)("li",null,"stack:栈，代码执行放在栈里，后进先出"),(0,t._)("li",null,"队列，先进先出"),(0,t._)("li",null,"栈，后进先出")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 队列"),(0,t.Uk)("\npush"),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)("shift\n"),(0,t._)("span",{class:"token comment"},"// 栈"),(0,t.Uk)("\npush"),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)("pop\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])])],-1),V=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("浏览器为什么是单线程的？ "),(0,t._)("ul",null,[(0,t._)("li",null,"防止同时操作dom")])])],-1),Y=(0,t._)("h3",{id:"node安装",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#node安装","aria-hidden":"true"},"#"),(0,t.Uk)(" node安装")],-1),Z=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("npm包管理器 "),(0,t._)("ul",null,[(0,t._)("li",null,"npm install --save esri-loader@1")])]),(0,t._)("li",null,[(0,t.Uk)("nvm mac切换node版本"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("npm install nvm "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("g\n"),(0,t._)("span",{class:"token comment"},"// 安装某个node版本"),(0,t.Uk)("\nnvm install "),(0,t._)("span",{class:"token number"},"6.14"),(0,t._)("span",{class:"token number"},".4"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 列出已安装版本"),(0,t.Uk)("\nnvm ls"),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("remote\n"),(0,t._)("span",{class:"token comment"},"// 使用某个版本"),(0,t.Uk)("\nnvm use "),(0,t._)("span",{class:"token number"},"8.9"),(0,t._)("span",{class:"token number"},".1"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// window切换版本"),(0,t.Uk)("\nnvm"),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("windows\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br")])])])],-1),Q=(0,t._)("h3",{id:"node-start",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#node-start","aria-hidden":"true"},"#"),(0,t.Uk)(" node start")],-1),nn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("p",null,"global可以直接访问global，没有window的概念")]),(0,t._)("li",null,[(0,t._)("p",null,[(0,t.Uk)("浏览器中"),(0,t._)("code",null,"window"),(0,t.Uk)("代理了"),(0,t._)("code",null,"global"),(0,t.Uk)("属性")])]),(0,t._)("li",null,[(0,t._)("p",null,"global里面有什么"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("code",null,"process"),(0,t.Uk)("进程，node每开一个服务都会有一个进程(当前的运行环境)")]),(0,t._)("li",null,[(0,t._)("code",null,"Buffer"),(0,t.Uk)("十六进制的内存 缓存，可以和字符串相互转化")]),(0,t._)("li",null,[(0,t._)("code",null,"clearImmediate"),(0,t.Uk)(),(0,t._)("code",null,"setImmediate"),(0,t.Uk)(" 宏任务")]),(0,t._)("li",null,[(0,t._)("code",null,"setTimeout"),(0,t.Uk)(),(0,t._)("code",null,"clearTimeout"),(0,t.Uk)(" 宏任务")]),(0,t._)("li",null,[(0,t._)("code",null,"clearInterval"),(0,t.Uk)(" 宏任务")]),(0,t._)("li",null,"...浏览器的方法基本上都支持")])])],-1),sn=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 显示出global的隐藏属性"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"dir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("global"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("showHidden"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\nObject"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("global"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("\n  global"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("Circular"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  process"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)("\n  \tprocess "),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" \n      title"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'node'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      version"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'v11.10.0'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  Buffer"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)("\n  clearImmediate setImmediate\n  setTimeout clearTimeout\n  "),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br")])],-1),an=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"REPL"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("REPL（read evaluate print loop） 循环求值打印 "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("安装node后输入"),(0,t._)("code",null,"node"),(0,t.Uk)("，然后就可以不断地输入命令得到值")])])])])],-1),tn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("node中打印this是{} "),(0,t._)("ul",null,[(0,t._)("li",null,"因为node的文件默认在外面套了一层函数，在函数运行时把this指向改变了")])])],-1),en=(0,t._)("h4",{id:"console",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#console","aria-hidden":"true"},"#"),(0,t.Uk)(" console")],-1),on=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"//1 标准输出"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'log'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'info'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(" \nprocess"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("stdout"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'呵呵'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//2 错误输出"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"warn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'warn'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"error"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'error'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nprocess"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("stderr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'错误'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 监控输出类型"),(0,t.Uk)("\nprocess"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("stdin"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"//0 表示标准输入"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br")])],-1),cn=(0,t._)("h4",{id:"process",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#process","aria-hidden":"true"},"#"),(0,t.Uk)(" process")],-1),pn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("process.cwd() "),(0,t._)("ul",null,[(0,t._)("li",null,"当前工作目录(current working directory) 。在哪执行文件 就可以打印出位置")])]),(0,t._)("li",null,[(0,t.Uk)("process.env "),(0,t._)("ul",null,[(0,t._)("li",null,"environment")]),(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"TIP"),(0,t._)("p",null,"往命令行的process.env注入内容：window:set a=1 mac:export a=1"),(0,t._)("ul",null,[(0,t._)("li",null,"命令行中可设置当前的process.env.NODE_ENV为’production‘，只在当前命令行生效")])])]),(0,t._)("li",null,[(0,t.Uk)("process.argv "),(0,t._)("ul",null,[(0,t._)("li",null,"arguments，一个数组，前两个是固定的路径，后面是node命令行执行时以空格分开的参数")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("node "),(0,t._)("span",{class:"token number"},"1."),(0,t.Uk)("node"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("js "),(0,t._)("span",{class:"token operator"},"--"),(0,t.Uk)("port "),(0,t._)("span",{class:"token number"},"3000"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/usr/local/bin/node'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t._)("span",{class:"token string"},"'/Users/yinyi/study/yy3535/docs/Backend/1.node.js'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t._)("span",{class:"token string"},"'--port'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n"),(0,t._)("span",{class:"token string"},"'3000'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br")])]),(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"传递参数解析成对象"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"//yargs把执行命令的时候传递参数解析成对象，可以自己手动将其变成对象"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" args"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("process"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("argv"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"slice"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nargs"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"reduce"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("total"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("currentIndex"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("arr")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"includes"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'-'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    total"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"slice"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("currentIndex"),(0,t._)("span",{class:"token operator"},"+"),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" total"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("p"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br")])])])]),(0,t._)("li",null,[(0,t.Uk)("process.nextTick() "),(0,t._)("ul",null,[(0,t._)("li",null,"下一队列，微任务")])]),(0,t._)("li",null,[(0,t.Uk)("process.pid "),(0,t._)("ul",null,[(0,t._)("li",null,"进程id")])]),(0,t._)("li",null,[(0,t.Uk)("process.exit() "),(0,t._)("ul",null,[(0,t._)("li",null,"手动退出应用")])]),(0,t._)("li",null,[(0,t.Uk)("process.chdir('6.node') "),(0,t._)("ul",null,[(0,t._)("li",null,"改变当前工作目录")])])],-1),ln=(0,t._)("h3",{id:"node-event-loop",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#node-event-loop","aria-hidden":"true"},"#"),(0,t.Uk)(" node event loop")],-1),un=(0,t._)("ul",null,[(0,t._)("li",null,"node中有如下六个队列，依次执行。"),(0,t._)("li",null,"每次都把队列清空后，或者达到执行的最大限制切换到下一个队列中会再执行微任务")],-1),kn=(0,t._)("p",null,[(0,t._)("img",{src:"/img/node事件环.png",alt:"node事件环"})],-1),_n=(0,t._)("ul",null,[(0,t._)("li",null,"微任务（promise.then < process.nextTick）"),(0,t._)("li",null,"主执行栈，先执行完，然后依次执行六个队列，每次队列切换都会把微任务队列清空"),(0,t._)("li",null,"timers 时间 settimeout 回调"),(0,t._)("li",null,"poll 轮询 i/o 回调 fs.readFile()"),(0,t._)("li",null,"check setImmediate 方法")],-1),rn=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 面试题"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//poll阶段下一个阶段是check,所以执行的话一定是走的setImmidaite"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'note.md'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'utf-8'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'timeout'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"setImmediate"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'setImmediate2'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br")])],-1),Un=(0,t._)("h3",{id:"global",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#global","aria-hidden":"true"},"#"),(0,t.Uk)(" global")],-1),bn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("每个node文件都被一个函数包裹，这个函数有如下五个参数 "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("code",null,"exports")]),(0,t._)("li",null,[(0,t._)("code",null,"module")]),(0,t._)("li",null,[(0,t._)("code",null,"require")]),(0,t._)("li",null,[(0,t._)("code",null,"__dirname"),(0,t._)("ul",null,[(0,t._)("li",null,"当前文件所在文件夹路径")])]),(0,t._)("li",null,[(0,t._)("code",null,"__filename"),(0,t._)("ul",null,[(0,t._)("li",null,"当前文件的绝对路径")])])])]),(0,t._)("li",null,[(0,t.Uk)("node 实现模块化（命名冲突 代码方便维护 方便协作 依赖关系） "),(0,t._)("ul",null,[(0,t._)("li",null,"浏览器中实现模块化，用 var obj={a} 不能完全解决命名冲突，而且调用过长（单例模式）"),(0,t._)("li",null,"自执行函数来实现 sea.js cmd require.js amd（异步）"),(0,t._)("li",null,[(0,t.Uk)("common.js规范 通过文件读取 (utf8) 实现了模块化 "),(0,t._)("ul",null,[(0,t._)("li",null,"文件即模块"),(0,t._)("li",null,"定义了导出方式 module.exports exports"),(0,t._)("li",null,"定义了导入方式 require")])])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// Promise.js"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("Promise"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" a"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./Promise.js'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])])],-1),mn=(0,t._)("h2",{id:"内置模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#内置模块","aria-hidden":"true"},"#"),(0,t.Uk)(" 内置模块")],-1),dn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("NODE模块分为"),(0,t._)("strong",null,"内置/核心模块"),(0,t.Uk)("、"),(0,t._)("strong",null,"文件模块/自定义模块"),(0,t.Uk)("、"),(0,t._)("strong",null,"第三方模块")])],-1),fn=(0,t._)("h3",{id:"vm",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#vm","aria-hidden":"true"},"#"),(0,t.Uk)(" vm")],-1),gn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("vm.runInThisContext() "),(0,t._)("ul",null,[(0,t._)("li",null,"让字符串在一个干净的环境里执行（不会去找作用域外面的变量）")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" vm"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'vm'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" hello"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nvm"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"runInThisContext"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"console.log(hello)"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// hello is not defined"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])])])],-1),yn=(0,t._)("h3",{id:"path",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#path","aria-hidden":"true"},"#"),(0,t.Uk)(" path")],-1),hn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("path.basename() "),(0,t._)("ul",null,[(0,t._)("li",null,"取基础名")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"basename"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'1.min.js'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'.js'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// 1.min"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("path.extname() "),(0,t._)("ul",null,[(0,t._)("li",null,"取扩展名")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"extname"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'1.min.js'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// .js"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("path.dirname() "),(0,t._)("ul",null,[(0,t._)("li",null,"取父级名")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"dirname"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"//a/b"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("path.join() "),(0,t._)("ul",null,[(0,t._)("li",null,"路径拼接")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'d/e/f'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t._)("span",{class:"token comment"},"// a/b/c/d/e/f"),(0,t.Uk)("\npath"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'../'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'d/e/f'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t._)("span",{class:"token comment"},"// a/b/d/e/f"),(0,t.Uk)("\npath"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'../'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'d/e/f'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// Users/maoerbaby/Desktop/1.promise/doc/a/b/d/e/f "),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("path.resolve() "),(0,t._)("ul",null,[(0,t._)("li",null,"路径拼接（比join多个当前命令行的路径）"),(0,t._)("li",null,"__dirname是当前文件的路径"),(0,t._)("li",null,"碰到/会直接去根目录")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'../'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'d/e/f'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// Users/maoerbaby/Desktop/1.promise/a/b/d/e/f"),(0,t.Uk)("\npath"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'../'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'d/e/f'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// Users/maoerbaby/Desktop/1.promise/doc/a/b/d/e/f "),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br")])])])],-1),wn=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"TIP"),(0,t._)("ul",null,[(0,t._)("li",null,"join和resolve与__dirname拼接时结果是一样的。都是当前文件目录下的路径。")])],-1),vn=(0,t._)("h3",{id:"fs模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#fs模块","aria-hidden":"true"},"#"),(0,t.Uk)(" fs模块")],-1),xn=(0,t._)("ul",null,[(0,t._)("li",null,"fs将文件读取成buffer。")],-1),jn=(0,t._)("h4",{id:"fs方法",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#fs方法","aria-hidden":"true"},"#"),(0,t.Uk)(" fs方法")],-1),qn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("fs.readfile() "),(0,t._)("ul",null,[(0,t._)("li",null,"异步读取文件")])]),(0,t._)("li",null,[(0,t.Uk)("fs.readFileSync() "),(0,t._)("ul",null,[(0,t._)("li",null,"同步读取文件"),(0,t._)("li",null,[(0,t.Uk)("第二个参数"),(0,t._)("code",null,"utf8"),(0,t.Uk)("，将读取的内存二进制Buffer转为字符串格式")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readFileSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./name.txt'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'utf8'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("data")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// age.txt"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("fs.writeFile() "),(0,t._)("ul",null,[(0,t._)("li",null,"写入文件(写入时，文件不存在会创建文件，如有内容会清空内容)")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"writeFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./note.md'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("data")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t\tconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\tconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("fs.access() "),(0,t._)("ul",null,[(0,t._)("li",null,"异步判断一个文件是否有权限访问")])]),(0,t._)("li",null,[(0,t.Uk)("fs.accessSync() "),(0,t._)("ul",null,[(0,t._)("li",null,"同步判断一个文件是否有权限访问"),(0,t._)("li",null,"存在就没有反应，不存在会报错")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"access"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" mode"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"try"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"accessSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./name.txt'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"catch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// {Error...}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("fs.stat() "),(0,t._)("ul",null,[(0,t._)("li",null,"判断文件或文件夹是否存在"),(0,t._)("li",null,"不存在会报错")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'name.txt'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("statObj")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"//是否是目录"),(0,t.Uk)("\n  statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"//是否是文件"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("fs.readdir() "),(0,t._)("ul",null,[(0,t._)("li",null,"返回路径下的所有列表")])])],-1),Sn=(0,t._)("h4",{id:"fs原理",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#fs原理","aria-hidden":"true"},"#"),(0,t.Uk)(" fs原理")],-1),Ln=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"flag"),(0,t._)("table",null,[(0,t._)("thead",null,[(0,t._)("tr",null,[(0,t._)("th",null,"符号"),(0,t._)("th",null,"含义")])]),(0,t._)("tbody",null,[(0,t._)("tr",null,[(0,t._)("td",null,"r"),(0,t._)("td",null,"读文件，文件不存在报错")]),(0,t._)("tr",null,[(0,t._)("td",null,"r+"),(0,t._)("td",null,"读取并写入，文件不存在报错")]),(0,t._)("tr",null,[(0,t._)("td",null,"w"),(0,t._)("td",null,"写入文件，不存在则创建，存在则清空")]),(0,t._)("tr",null,[(0,t._)("td",null,"w+"),(0,t._)("td",null,"读取并写入文件，不存在则创建，存在则清空")]),(0,t._)("tr",null,[(0,t._)("td",null,"wx"),(0,t._)("td",null,"排它写入文件")]),(0,t._)("tr",null,[(0,t._)("td",null,"a"),(0,t._)("td",null,"追加写入")])])])],-1),Cn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("p",null,"fs.appendFile"),(0,t._)("ul",null,[(0,t._)("li",null,"追加写入（里面使用flag:a）")])]),(0,t._)("li",null,[(0,t._)("p",null,"fs.copyFile"),(0,t._)("ul",null,[(0,t._)("li",null,"拷贝文件")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"copyFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("source"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("target"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'ok'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t._)("p",null,"从指定位置开始读取文件"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("p",null,[(0,t.Uk)("打开文件：fs.open('./1,txt','r',0600,"),(0,t._)("strong",null,"function"),(0,t.Uk)("(err,fd){});")])]),(0,t._)("li",null,[(0,t._)("p",null,"读取文件：fs.read(fd, buffer, offset, length, position, callback((err, bytesRead, buffer)))")]),(0,t._)("li",null,[(0,t._)("p",null,"写入文件：fs.write(fd, buffer[, offset[, length[, position]]], callback)")])]),(0,t._)("p",null,"process.stdin 0"),(0,t._)("p",null,"process.stdout 1"),(0,t._)("p",null,"process.stderr 2"),(0,t._)("p",null,"0,1,2是标识符，node中默认会占用0,1,2十三个描述符，所以自定义fd的是从3开始数"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"/*打开文件*/"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"open"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a.md'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'r'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"name"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("fd")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("fd"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"//3,fd是标识符，每次打开会累加"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" buffer"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"alloc"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t._)("span",{class:"token comment"},"//只能放三勺水"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"/*读取文件*/"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"//fd 文件描述符 buffer读取到哪里"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"//0 是从buffer的哪个位置读取"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"//3 读取的个数"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"//0 读取文件的位置"),(0,t.Uk)("\n  fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"read"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("fd"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("buffer"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("bytesRead")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  \t"),(0,t._)("span",{class:"token comment"},"//bytesRead 真实读取的字节数 <Buffer 31 00 00>"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"/*关闭文件*/"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"close"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("fd"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'关闭'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"/*打开文件*/"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"open"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a.md'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'w'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("fd")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" buffer"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"from"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"4"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"/*写入文件*/"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"//fd 代表文件描述符"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"//0 代表把buffer的第几个位置开始写入"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"//2 代表写入的个数"),(0,t.Uk)("\n\t"),(0,t._)("span",{class:"token comment"},"//0 写到文件的哪个位置"),(0,t.Uk)("\n  fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("fd"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("buffer"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("written")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'写入成功'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"fsync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t._)("span",{class:"token comment"},"//最后应该调用此方法，更新内存，将文件写入到磁盘中。"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"//实现一个拷贝，用fs.open fs.read fs.write实现拷贝文件的功能，控制读取速率，防止内存占用过多"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//第三个参数写Null，就会自动往后，不用自己计算位置"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//流的原理，发布订阅来简化"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"copy"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("source"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("target"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" BufferSize"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"open"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("source"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'r'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("rfd")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"open"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("target"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'w'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("wfd")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    \t"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" buffer"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"aloc"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    \t"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"read"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("rfd"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("buffer"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token constant"},"BUFFERSIZE"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("bytesRead")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("bytesRead"),(0,t._)("span",{class:"token operator"},">"),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("wfd"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("buffer"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("bytesRead"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("written")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n              "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"else"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          \tfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"close"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("rfd"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n          \tfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"close"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("wfd"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n              fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"fsync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n          \t"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    \t"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    \t"),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"copy"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a.md'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'b.md'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'复制成功'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t._)("p",null,"direction"),(0,t._)("ul",null,[(0,t._)("li",null,"基本操作")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"//创建目录(必须保证父级存在)"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"mkdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a/b'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(" 或者fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"mkdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("或者 fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"mkdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a\\\\b'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("双杠为了转义成\\\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"mkdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//判断一个文件是否有权限访问"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"access"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" mode"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//删除目录(必须保证目录中没有子文件和子文件夹，否则会出错)"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//删除文件"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("unlinkSync\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("unlink\n"),(0,t._)("span",{class:"token comment"},"//读取目录下所有文件"),(0,t.Uk)("\nfs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" options"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//查看文件目录信息"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" stat"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"statSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" stat"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nstat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"//是否是目录"),(0,t.Uk)("\nstat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"//是否是目录"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br")])]),(0,t._)("ul",null,[(0,t._)("li",null,"做一个创建任意目录的工具")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//同步,使用for循环"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"mkdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"p"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" dirs"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("p"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"for"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"<"),(0,t.Uk)("dirs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  \t"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" currentPath"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("dirs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"slice"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("i"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  \t"),(0,t._)("span",{class:"token keyword"},"try"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"accessSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  \t"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"catch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"mkdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  \t"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"mkdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'m/q/d'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"//异步，使用递归，next方法来帮助进行迭代操作"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//fs.access"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"mkdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("p"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" dirs"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("p"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" index"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  \t"),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)("dirs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" currentPath"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("dirs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"slice"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token operator"},"++"),(0,t.Uk)("index"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"access"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"mkdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"else"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t._)("span",{class:"token comment"},"//当前文件夹存在就继续迭代"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"mkdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a/b/c'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'创建完成'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br")])]),(0,t._)("ul",null,[(0,t._)("li",null,"同步先序深度优先删除目录")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"rmSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"try"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" stat "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"statSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"unlinkSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" files"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            files\n                "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("file "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("file"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("item"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"rmSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("item"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"catch"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'删除失败!'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"rmSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br")])]),(0,t._)("ul",null,[(0,t._)("li",null,"异步串行删除目录深度优先")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"rmAsyncSeries"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" paths "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" files"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("file "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("file"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"index"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},">="),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" current"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("paths"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token function"},"rmAsyncSeries"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},"+"),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"unlink"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"1000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"time"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'cost'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"rmAsyncSeries"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("err "),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n     console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"timeEnd"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'cost'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"//异步并行删除目录深度优先"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"rmAsyncParallel"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" paths"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("file "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("file"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("paths"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token operator"},">"),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"done"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"++"),(0,t.Uk)("i "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(" paths"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                      paths"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"p"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token function"},"rmAsyncParallel"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("p"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("done"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"unlink"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"1000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"time"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'cost'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"rmAsyncParallel"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("err "),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n     console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"timeEnd"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'cost'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"//异步删除非空目录(Promise版)"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"rmPromise"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Promise"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("resolve"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("reject"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"reject"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" paths "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" files"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("file "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("file"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" promises "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" paths"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"p"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token function"},"rmPromise"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("p"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    Promise"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"all"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("promises"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"then"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("resolve"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"unlink"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("resolve"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"rmPromise"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"then"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'删除成功'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"//同步删除目录(广度优先) "),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"rmSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" index"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"while"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" current"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" stat"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"statSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" dirs"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            arr"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("dirs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("d "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("d"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" item"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"while"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"null"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"!="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("item "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pop"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" stat "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"statSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("item"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdirSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("item"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"unlinkSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("item"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"//异步删除目录(广度优先)"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"rmdirWideAsync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" dirs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" index"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" current "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" dirs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pop"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("rmdir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"unlink"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("rmdir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token operator"},"!"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" current"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("dirs"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        dirs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("dirs"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("item "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("item"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token function"},"rmdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"63"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"64"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"65"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"66"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"67"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"68"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"69"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"70"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"71"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"72"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"73"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"74"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"75"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"76"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"77"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"78"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"79"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"80"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"81"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"82"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"83"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"84"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"85"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"86"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"87"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"88"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"89"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"90"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"91"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"92"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"93"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"94"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"95"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"96"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"97"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"98"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"99"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"100"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"101"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"102"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"103"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"104"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"105"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"106"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"107"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"108"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"109"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"110"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"111"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"112"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"113"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"114"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"115"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"116"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"117"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"118"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"119"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"120"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"121"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"122"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"123"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"124"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"125"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"126"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"127"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"128"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"129"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"130"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"131"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"132"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"133"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"134"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"135"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"136"),(0,t._)("br")])])])],-1),Pn=(0,t._)("h3",{id:"events模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#events模块","aria-hidden":"true"},"#"),(0,t.Uk)(" events模块")],-1),En=(0,t._)("ul",null,[(0,t._)("li",null,"是个类")],-1),On=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" EventEmitter"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'events'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" e "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"EventEmitter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br")])],-1),Tn=(0,t._)("h4",{id:"方法",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#方法","aria-hidden":"true"},"#"),(0,t.Uk)(" 方法")],-1),zn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("e.on() "),(0,t._)("ul",null,[(0,t._)("li",null,"绑定事件"),(0,t._)("li",null,"可以绑定多次，多个回调都会触发")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'吃饭'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'吃米饭'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("e.emit() "),(0,t._)("ul",null,[(0,t._)("li",null,"触发事件")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"emit"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'吃饭'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("e.removeListener/off() "),(0,t._)("ul",null,[(0,t._)("li",null,"解除绑定"),(0,t._)("li",null,"第二个参数是绑定事件")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"off"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'吃饭'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\ne"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"off"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'吃饭'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'吃米饭'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("e.defaultMaxListeners "),(0,t._)("ul",null,[(0,t._)("li",null,"默认最大绑定数")])]),(0,t._)("li",null,[(0,t.Uk)("e.setMaxListener(1) "),(0,t._)("ul",null,[(0,t._)("li",null,"设置最大绑定数")])]),(0,t._)("li",null,[(0,t.Uk)("e.once() "),(0,t._)("ul",null,[(0,t._)("li",null,"不管绑定多少次，仅触发一次")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"once"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'失恋'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("cry"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])])],-1),Nn=(0,t._)("h4",{id:"events自定义事件原理",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#events自定义事件原理","aria-hidden":"true"},"#"),(0,t.Uk)(" events自定义事件原理")],-1),Rn=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"EventEmitter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"create"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"EventEmitter"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"prependListener"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"EventEmitter"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"on"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" flag")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"create"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"null"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("eventName "),(0,t._)("span",{class:"token operator"},"!="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'newListener'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("newListener"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"fn"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token function"},"fn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("flag"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"unshift"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"EventEmitter"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"off"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"//当前函数绑定的是cry,删除的也是cry"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"filter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"l"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(" l "),(0,t._)("span",{class:"token operator"},"!="),(0,t.Uk)(" callback "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" l"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("l "),(0,t._)("span",{class:"token operator"},"!="),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"EventEmitter"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"once"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"one"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"off"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" one"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    one"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("l "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" one"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token class-name"},"Emitter"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("prototype"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"emit"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"fn"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"fn"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"call"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" EventEmitter"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br")])],-1),Hn=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"EventEmitter"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"constructor"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"emit"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"eventName"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"fn"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token function"},"fn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"off"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_events"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("eventName"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"filter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"fn"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" fn "),(0,t._)("span",{class:"token operator"},"!="),(0,t.Uk)(" callback"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br")])],-1),Fn=(0,t._)("h3",{id:"流",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#流","aria-hidden":"true"},"#"),(0,t.Uk)(" 流")],-1),Mn=(0,t._)("ul",null,[(0,t._)("li",null,"用fs模块读取文件，如果文件很大的话，会占用大量的内存空间。")],-1),Wn=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"文件的拷贝"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("readFile+writeFile实现拷贝功能 "),(0,t._)("ul",null,[(0,t._)("li",null,"readfile将内容整个读取到内存中，再写入文件中。占用两倍内存。不能读大文件")])])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("source"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("data")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"writeFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("target"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'成功'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br")])])],-1),In=(0,t._)("ul",null,[(0,t._)("li",null,"流 边读边写（可以控制读取的速率） 流是基于事件的。"),(0,t._)("li",null,"可读流，可写流，双工流(可读可写)，转化流(压缩流)"),(0,t._)("li",null,"可以分段读取 可以控制速率")],-1),Dn=(0,t._)("h4",{id:"fs-createreadstream-path-options",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#fs-createreadstream-path-options","aria-hidden":"true"},"#"),(0,t.Uk)(" fs.createReadStream(path,[options]);")],-1),An=(0,t._)("ul",null,[(0,t._)("li",null,"创建可读流")],-1),Bn=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" rs"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'name.txt'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])],-1),$n=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"options"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("options "),(0,t._)("ul",null,[(0,t._)("li",null,"flags:'r'/'w'"),(0,t._)("li",null,"highWaterMark:3(每次读多少个,默认64k)"),(0,t._)("li",null,"encoding:null,默认为null(buffer)"),(0,t._)("li",null,"autoClose:true,默认true(读取完毕后关闭文件)"),(0,t._)("li",null,"start:1,开始读取的索引位置"),(0,t._)("li",null,"end:5,结束读取的索引位置(包前包后)")])])])],-1),Gn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("rs.on('data',function(){}) "),(0,t._)("ul",null,[(0,t._)("li",null,"默认是暂停模式，非流动模式 内部每读一次就会触发data事件 rs.emit('data',123)"),(0,t._)("li",null,"绑定了data事件，就变成流动模式")])])],-1),Jn=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nrs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"chunk"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("chunk"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])],-1),Kn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("rs.on('end',function(){}) "),(0,t._)("ul",null,[(0,t._)("li",null,"绑定读取完毕事件"),(0,t._)("li",null,"客户端发来的数据一定要采用Buffer.concat来拼")])])],-1),Xn=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("rs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'end'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"concat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])],-1),Vn=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("rs.pause() "),(0,t._)("ul",null,[(0,t._)("li",null,"暂停data事件的触发")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("rs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"chunk"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("chunk"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  rs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pause"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("rs.resume() "),(0,t._)("ul",null,[(0,t._)("li",null,"恢复data事件的触发")])]),(0,t._)("li",null,[(0,t.Uk)("rs.on('error',function(err){}) "),(0,t._)("ul",null,[(0,t._)("li",null,"绑定读取出错事件")])])],-1),Yn=(0,t._)("h4",{id:"fs-createwritestream-path-options",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#fs-createwritestream-path-options","aria-hidden":"true"},"#"),(0,t.Uk)(" fs.createWriteStream(path,[options])")],-1),Zn=(0,t._)("ul",null,[(0,t._)("li",null,"w在文件不存在，会创建一个文件，如果有内容会清空内容")],-1),Qn=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"options"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("options "),(0,t._)("ul",null,[(0,t._)("li",null,"flags:'r'/'w'"),(0,t._)("li",null,"encoding:'utf8'"),(0,t._)("li",null,"highWaterMark:3(每次预计写入多少个，默认16k)"),(0,t._)("li",null,"autoClose:true,默认true(写入完毕后关闭文件)"),(0,t._)("li",null,"start:1,开始写入的索引位置")])])])],-1),ns=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ws"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createWriteStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'name.txt'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])],-1),ss=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("ws.write('123',function(err){}) "),(0,t._)("ul",null,[(0,t._)("li",null,"写入的内容必须是buffer/字符串"),(0,t._)("li",null,"返回值是当前写入长度和预计长度是否符合")])])],-1),as=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" flag"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("ws"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'123'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'写入成功'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("flag"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// "),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])],-1),ts=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("ws.end('结束',function(){}) "),(0,t._)("ul",null,[(0,t._)("li",null,"全部写入完成后回调，必须加上，代表关闭写入的文件"),(0,t._)("li",null,"第一个参数会写入到写入文件末尾")])]),(0,t._)("li",null,[(0,t.Uk)("ws.on('drain',function(){}) "),(0,t._)("ul",null,[(0,t._)("li",null,"当前次写入完成")])])],-1),es=(0,t._)("h4",{id:"read-write-pipe方法",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#read-write-pipe方法","aria-hidden":"true"},"#"),(0,t.Uk)(" read+write==>(pipe方法)")],-1),os=(0,t._)("ul",null,[(0,t._)("li",null,"readFile 可以读取64k以下的文件"),(0,t._)("li",null,"否则就使用流的方式")],-1),cs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" r "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'name.txt'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    highWaterMark"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"3"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" w "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createWriteStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'write.txt'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    highWaterMark"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"1"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("r"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" w")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    r"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" flag "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" w"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("flag"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(" r"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pause"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    w"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'drain'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'抽干'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        r"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resume"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    r"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'end'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'文件读取完毕'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        w"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("r"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" w"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br")])],-1),ps=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("官方封装pipe 把可读流导入到可写流中 "),(0,t._)("ul",null,[(0,t._)("li",null,"r.pipe(w)")])])],-1),ls=(0,t._)("h3",{id:"http模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#http模块","aria-hidden":"true"},"#"),(0,t.Uk)(" http模块")],-1),us=(0,t._)("ul",null,[(0,t._)("li",null,"客户端 浏览器"),(0,t._)("li",null,"服务端 监听请求 监听特定的ip和端口（最大65535）")],-1),ks=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])],-1),_s=(0,t._)("h4",{id:"http-createserver",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#http-createserver","aria-hidden":"true"},"#"),(0,t.Uk)(" http.createServer()")],-1),is=(0,t._)("ul",null,[(0,t._)("li",null,"创建服务端"),(0,t._)("li",null,"只有当请求到来时触发"),(0,t._)("li",null,"端口用的时候不要用3000以下的"),(0,t._)("li",null,[(0,t.Uk)("请求分为三部分 "),(0,t._)("ul",null,[(0,t._)("li",null,"请求行 方法 路径 协议"),(0,t._)("li",null,"请求头 浏览器信息 自定义"),(0,t._)("li",null,"请求体")])]),(0,t._)("li",null,[(0,t.Uk)("响应也分为三部分 "),(0,t._)("ul",null,[(0,t._)("li",null,"响应行 状态码"),(0,t._)("li",null,"响应头"),(0,t._)("li",null,"响应体")])])],-1),rs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("response")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br")])],-1),Us=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("server.listen() "),(0,t._)("ul",null,[(0,t._)("li",null,"监听的端口号（默认80）"),(0,t._)("li",null,"主机名"),(0,t._)("li",null,"启动服务成功后回调")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'localhost'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'3000 starts'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("server.on('request',function(req,res){}) "),(0,t._)("ul",null,[(0,t._)("li",null,"等待请求到来时执行，等价于createServer里的回调函数")])])],-1),bs=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"curl工具发请求"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("curl "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("v https"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token operator"},"/"),(0,t._)("span",{class:"token operator"},"/"),(0,t.Uk)("www"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("baidu"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("com\ncurl "),(0,t._)("span",{class:"token operator"},"-"),(0,t._)("span",{class:"token constant"},"X"),(0,t.Uk)(),(0,t._)("span",{class:"token constant"},"POST"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("d "),(0,t._)("span",{class:"token string"},'"username=123&password=456"'),(0,t.Uk)(" http"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token operator"},"/"),(0,t._)("span",{class:"token operator"},"/"),(0,t.Uk)("localhost"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token number"},"3000"),(0,t.Uk)("\ncurl "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("v "),(0,t._)("span",{class:"token operator"},"-"),(0,t._)("span",{class:"token constant"},"X"),(0,t.Uk)(),(0,t._)("span",{class:"token constant"},"POST"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("d "),(0,t._)("span",{class:"token string"},'"username=123&password=456"'),(0,t.Uk)(" http"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token operator"},"/"),(0,t._)("span",{class:"token operator"},"/"),(0,t.Uk)("localhost"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token number"},"3000"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])],-1),ms=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("request "),(0,t._)("ul",null,[(0,t._)("li",null,"可读流"),(0,t._)("li",null,"请求体需要ondata来接受数据"),(0,t._)("li",null,[(0,t.Uk)("querystring模块 "),(0,t._)("ul",null,[(0,t._)("li",null,"querystring.parse，将参数字符串转成对象")])]),(0,t._)("li",null,[(0,t.Uk)("url模块 "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("url.parse "),(0,t._)("ul",null,[(0,t._)("li",null,"第二个参数true，将url字符串变对象")])])])])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" response")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// request.method // 方法名是大写的"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// request.url"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// request.httpVersion"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// request.headers // 所有的属性名都是小写的"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" querystring "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'querystring'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'end'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" str "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"concat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// querystring 原理 start"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// username=123&password=456"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// let obj = {};"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// str.replace(/([^=&]*)=([^=&]*)/g, function() {"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//         obj[arguments[1]] = arguments[2];"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//     })"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// querystring 原理 end"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" obj "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" querystring"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'&'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'='"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        response"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 要写有意义的"),(0,t.Uk)("\n        response"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'1'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 设置响应头，给客户端"),(0,t.Uk)("\n        response"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stringify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("obj"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\nserver"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'3000启动成功'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("query"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("response "),(0,t._)("ul",null,[(0,t._)("li",null,"双工流")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("response"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'hello'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 必须有这句，否则一直是pending等待状态，end后不能调write，但可以调end"),(0,t.Uk)("\nresponse"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])])],-1),ds=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"nodemon"),(0,t._)("p",null,"npm install -g nodemon nodemon 6.http.js"),(0,t._)("ul",null,[(0,t._)("li",null,"用nodemon启动node服务文件，只要文件发生变化，就会重启服务")])],-1),fs=(0,t._)("h4",{id:"客户端发请求",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#客户端发请求","aria-hidden":"true"},"#"),(0,t.Uk)(" 客户端发请求")],-1),gs=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("p",null,"通过服务端发请求，没有跨域问题")]),(0,t._)("li",null,[(0,t._)("p",null,"应用场景"),(0,t._)("ul",null,[(0,t._)("li",null,"爬虫"),(0,t._)("li",null,"中间层（转发请求，解决跨域问题）")])]),(0,t._)("li",null,[(0,t._)("p",null,"http.get()")]),(0,t._)("li",null,[(0,t._)("p",null,"http.request()"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" client"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"request"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  hostname"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'localhost'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  port"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  path"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'/xxx'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  method"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'post'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  headers"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    a"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'application/json'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'application/x-www-form-urlencoded'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 表单类型"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"response"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  response"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nclient"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'name=zf&a=1'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br")])])])],-1),ys=(0,t._)("h4",{id:"http静态服务",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#http静态服务","aria-hidden":"true"},"#"),(0,t.Uk)(" http静态服务")],-1),hs=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("一般服务端 会处理两种类型 "),(0,t._)("ul",null,[(0,t._)("li",null,"静态的 html css"),(0,t._)("li",null,"动态数据 ajax获取")])]),(0,t._)("li",null,[(0,t.Uk)("fs.stat() "),(0,t._)("ul",null,[(0,t._)("li",null,"判断文件或文件夹是否存在"),(0,t._)("li",null,"statObj.isFile()")])])],-1),ws=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"TIP"),(0,t._)("p",null,"在服务端中没有.././")],-1),vs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 第三方模块mime"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" mime"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mime'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" absPath"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stats"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("statObj")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Not found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token comment"},"// 1.css => text/css 1.png => img/png"),(0,t.Uk)("\n      res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("mime"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getType"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"+"),(0,t._)("span",{class:"token string"},"':charset=utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"else"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" realPath"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'index.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"access"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("realPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n          res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Not found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n          "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'text/html;charset=utf-8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("realPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'你访问的是/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br")])],-1),xs=(0,t._)("ul",null,[(0,t._)("li",null,"封装以上启动服务的代码")],-1),js=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" mime"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mime'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mz/fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Server"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"handleRequest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// this"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" absPath"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 先判断是否是用调用的接口 /user get/post/delete/put"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" method"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toLowerCase"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"switch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"case"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/userList'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method"),(0,t._)("span",{class:"token operator"},"==="),(0,t._)("span",{class:"token string"},"'get'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n          res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stringify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("name"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n      "),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token keyword"},"try"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" statObj"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" realPath"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'index.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"access"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("realPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("realPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"else"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"catch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendError"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("mime"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getType"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"sendError"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("err")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Not found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token function"},"start"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"port"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"handleRequest"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"bind"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("port"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Server"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nserver"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"start"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br")])],-1),qs=(0,t._)("h4",{id:"http跨域-cors",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#http跨域-cors","aria-hidden":"true"},"#"),(0,t.Uk)(" http跨域 cors")],-1),Ss=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" mime "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mime'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mz/fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Server"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"handleRequest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// this"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" absPath "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 先判断是否是用调用的接口 /user get/post/delete/put"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" method "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toLowerCase"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Access-Control-Allow-Origin'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'http://127.0.0.1:5500'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 允许的请求方法"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Access-Control-Allow-Methods'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'GET,PUT,DELETE,OPTIONS,POST'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 允许的跨域头"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Access-Control-Allow-Headers'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'Content-Type,token'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// options的发送间隔，如果请求不是get或者post，并且带请求头的话(复杂请求)，在请求前，会先发一个options请求，来是否支持跨域（预检查），然后再发送请求"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Access-Control-Max-age'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"10"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 允许前端访问 强制跨域携带cookie"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Access-Control-Allow-Credentials'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// options不进行处理（解决options出错问题）"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'options'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 可以访问"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"switch"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"case"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/userList'"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'get'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'application/json'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stringify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" name"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'put'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'application/json'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stringify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" name"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"try"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" statObj "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" realPath "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'index.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"access"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("realPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("realPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"catch"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendError"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" mime"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getType"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"sendError"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" err")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Not found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"start"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"port"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"handleRequest"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"bind"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("port"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Server"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nserver"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"start"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"63"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"64"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"65"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"66"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"67"),(0,t._)("br")])],-1),Ls=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" xhr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"XMLHttpRequest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nxhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"open"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'PUT'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'http://localhost:3000/userList'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nxhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("responseType "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'json'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 凭证 默认跨域不支持cookie"),(0,t.Uk)("\ndocument"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("cookie "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'token=100'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 强制带上cookie"),(0,t.Uk)("\nxhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("withCredentials "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nxhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setRequestHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'token'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'asd.askfs.g'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nxhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"onreadystatechange"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("xhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("status "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"200"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" xhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("readyState "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"4"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("xhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("response"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nxhr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br")])],-1),Cs=(0,t._)("h4",{id:"cookie-session",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#cookie-session","aria-hidden":"true"},"#"),(0,t.Uk)(" cookie&session")],-1),Ps=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("cookie 客户端的 （请求头） Set-Cookie "),(0,t._)("ul",null,[(0,t._)("li",null,"不重要的放在cookie中"),(0,t._)("li",null,"用户可以随意篡改，不安全。即使签名了，还是可以明显看到.之前就是它的值。或者一些注入把当前的cookie带着发ajax请求")])]),(0,t._)("li",null,[(0,t.Uk)("session 服务端的 "),(0,t._)("ul",null,[(0,t._)("li",null,"重要信息放在session中"),(0,t._)("li",null,"会员卡的总额存在服务器，客户端只存个会员卡卡号")])]),(0,t._)("li",null,"crypto 核心模块(签名)")],-1),Es=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"登录"),(0,t._)("ul",null,[(0,t._)("li",null,"cookie和session一般做客户端服务端同构"),(0,t._)("li",null,"spa react+vue token jwt 用户token正确，就是正确，服务端不存储信息，直接加盐把内容返回去，客户端拿到后使用。（密钥丢失 可以伪造用户）")])],-1),Os=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" querystring "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'querystring'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 设置cookie 读取cookie "),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/read'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cookies "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" querystring"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("cookie"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'; '"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stringify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("cookies"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/write'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// res.setHeader('Set-Cookie', ['name=zf', 'age=10']);"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// domain 默认只针对某个域名 .zhufe.cn 表示a.zhufe b.zhufe c.zhufe 都可以共用cookie"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// path 一般不会设置 表示只能在某个域名显示"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// expires 绝对时间 / max-age 相对时间 5秒后重新登录"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// httpOnly(一般情况下服务端设置都是true)"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Set-Cookie'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'name=zf; httpOnly=true'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'write ok'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br")])],-1),Ts=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" querystring "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'querystring'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" crypto "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'crypto'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n\n"),(0,t._)("span",{class:"token comment"},"// 签名 给cookie标个记号 下次带上记号和内容，可以确认这个东西有没有更改"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"sign"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" crypto"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createHmac"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'sha256'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"update"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"digest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'base64'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"replace"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},"[+/]"),(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-flags"},"g")]),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"''"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"setCookie"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" value"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" options "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" optionsArr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("maxAge"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            optionsArr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"Max-Age="),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("maxAge"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("httpOnly"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            optionsArr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"httpOnly="),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("httpOnly"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            optionsArr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"path="),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("signed"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            value "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" value "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'.'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"sign"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("key"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"="),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("value"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"; "),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" optionsArr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'; '"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Set-Cookie'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"getCookie"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"key"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cookies "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" querystring"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("cookie"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'; '"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" cookies"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"getSignCookie"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"key"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cookies "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" querystring"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("cookie"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'; '"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("cookies"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" signValue"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" cookies"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'.'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token function"},"sign"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" signValue"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" value\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"''"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 设置cookie 读取cookie "),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/read'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getSignCookie"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'name'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/write'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// res.setHeader('Set-Cookie', ['name=zf', 'age=10']);"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// domain 默认只针对某个域名 .zhufe.cn 表示a.zhufe b.zhufe c.zhufe 都可以共用cookie"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// path 一般不会设置 表示只能在某个域名显示"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// expires 绝对时间 / max-age 相对时间 5秒后重新登录"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// httpOnly(一般情况下服务端设置都是true)"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setCookie"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'name'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" maxAge"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"10"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" path"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" httpOnly"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" signed"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setCookie"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'age'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'10'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" maxAge"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"10"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" path"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" httpOnly"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'write ok'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br")])],-1),zs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" querystring "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'querystring'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" uuid "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'uuid'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" sessionId "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zhufengwash'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" session "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/towash'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cookies "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" querystring"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("cookie"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'; '"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" username "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" cookies"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("sessionId"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("username "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" session"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("username"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            session"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("username"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("mny "),(0,t._)("span",{class:"token operator"},"-="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"10"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("username"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'text/html;charset=utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"当前您的额度是"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("username"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("mny"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// 第一次来"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cardId "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" uuid"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"v4"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Set-Cookie'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("sessionId"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"="),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("cardId"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"; httpOnly=true"),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            session"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("cardId"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                mny"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"100"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'text/html;charset=utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"当前您的额度是"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("cardId"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("mny"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br")])],-1),Ns=(0,t._)("h4",{id:"ejs模板",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#ejs模板","aria-hidden":"true"},"#"),(0,t.Uk)(" ejs模板")],-1),Rs=(0,t._)("ul",null,[(0,t._)("li",null,"自己实现ejs")],-1),Hs=(0,t._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t._)("pre",{class:"language-html"},[(0,t._)("code",null,[(0,t._)("span",{class:"token doctype"},[(0,t._)("span",{class:"token punctuation"},"<!"),(0,t._)("span",{class:"token doctype-tag"},"DOCTYPE"),(0,t.Uk)(),(0,t._)("span",{class:"token name"},"html"),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("html")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"lang"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("en"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("head")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("meta")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"charset"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("UTF-8"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("meta")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"name"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("viewport"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"content"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("width=device-width, initial-scale=1.0"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("meta")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"http-equiv"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("X-UA-Compatible"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"content"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("ie=edge"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("title")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("Document"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("title")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("head")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("body")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    <%arr.forEach(a=>{%>\n        "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("<%=a%>"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("li")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n        <%})%>\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("body")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("html")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)(" \n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br")])],-1),Fs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ejs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'ejs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" data "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" name"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" age"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"10"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" arr"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// with(data){} 模板里才用得到(添加一个作用域，this指向data)"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" tempStr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readFileSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'index.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"render"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" data")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    str"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"replace"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},"<%=([\\s\\S]*?)%>"),(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-flags"},"g")]),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'${'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" arguments"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'}'"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" head "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'let str;\\r\\nwith(obj){\\r\\n'"),(0,t.Uk)("\n    head "),(0,t._)("span",{class:"token operator"},"+="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'str=`'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" content "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" str"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"replace"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},"<%([\\s\\S]*?)%>"),(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-flags"},"g")]),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'`\\r\\n'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" arguments"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'\\r\\nstr+=`'"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" tail "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'`\\r\\n}\\r\\nreturn str;'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fn "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'obj'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" head "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" content "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" tail"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"fn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 取值表达式的替换"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// function render(str, data) {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     return str.replace(/<%=([\\s\\S]*?)%>/g, function() {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//         return data[arguments[1]]"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     })"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// }"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" str "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"render"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("tempStr"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br")])],-1),Ms=(0,t._)("h4",{id:"static-server",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#static-server","aria-hidden":"true"},"#"),(0,t.Uk)(" static-server")],-1),Ws=(0,t._)("ul",null,[(0,t._)("li",null,"使用node http自己实现一个http-server启动服务小工具"),(0,t._)("li",null,"解析用户传入的数据，根据数据启动一个http-server")],-1),Is=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token string"},'"bin"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token string"},'"zf-http-server"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"./bin/www.js"'),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])],-1),Ds=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token hashbang comment"},"#! /usr/bin/env node"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 默认启动一个http-server port ip地址"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 定义 一个port属性"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" config "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        port"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        host"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'127.0.0.1'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        dir"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'./'"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// process.argv"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// yargs comander 做命令行工具需要这种工具"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" commander "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'commander'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" json "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'../package.json'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\ncommander"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"version"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("json"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("version"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"option"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'-p, --port <n>'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'set http-server port'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"option"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'-o, --host <n>'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'set http-server host'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"option"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'-d, --dir <n>'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'set http-server directory'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'--help'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Examples'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'  $ zf-http-server --port --host'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("process"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("argv"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// console.log(commander.port);"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// console.log(commander.host);"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// console.log(commander.dir);"),(0,t.Uk)("\nconfig "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("config"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("commander "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("config"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br")])],-1),As=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" chalk "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'chalk'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 颜色模块"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mz/fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ejs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'ejs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// "),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" mime "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mime'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 解析类型的"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" template "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readFileSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'template.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Server"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"constructor"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"config"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("host "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" config"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("host"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dir "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" config"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("port "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" config"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("port"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("template "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" template"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"async"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"handleRequest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token comment"},"// 1. 判断是目录还是文件 如果是文件，直接将内容展示给用户"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"try"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// 防止中文文件名浏览器不认就自动给转成buffer二进制"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" absPath "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dir"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"decodeURIComponent"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" statObj "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token comment"},"// 先读取当前目录下的所有列表"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" dirs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readdir"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token comment"},"// 需要拿到当前url和目录的每一项拼接"),(0,t.Uk)("\n\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" href "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" str "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ejs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"render"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("template"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    arrs"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" dirs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"dir"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        href"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" dir"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                        content"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" dir\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'text/html;charset=utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" statObj"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n            "),(0,t._)("span",{class:"token comment"},"// 2. 如果是目录 列出目录列表"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"catch"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendError"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"sendError"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" absPath")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Not Found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" statObj"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" absPath")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// last-modified"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" client "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'if-modified-since'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("ctime"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toUTCString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("client "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" server"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"304"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Last-Modified'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" server"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Cache-Control'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'no-cache'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" mime"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"getType"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"';charset=utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token comment"},"// etag"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token function"},"start"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"handleRequest"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"bind"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("port"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("host"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("chalk"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"yellow"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"Starting up http-server, serving "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("dir"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"\\r\\nAvailable on\\r\\n"),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("chalk"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"green"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"http://"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("host"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},":"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("port"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Server"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"63"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"64"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"65"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"66"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"67"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"68"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"69"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"70"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"71"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"72"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"73"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"74"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"75"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"76"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"77"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"78"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"79"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"80"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"81"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"82"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"83"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"84"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"85"),(0,t._)("br")])],-1),Bs=(0,t._)("h4",{id:"服务器304cache实现-服务端来实现的",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#服务器304cache实现-服务端来实现的","aria-hidden":"true"},"#"),(0,t.Uk)(" 服务器304cache实现（服务端来实现的）")],-1),$s=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("前端 pwa 实现缓存 "),(0,t._)("ul",null,[(0,t._)("li",null,"即离线缓存 网络不通也可以缓存起来 使用的是Caches api(Cache Storage)")])]),(0,t._)("li",null,[(0,t.Uk)("服务端 http 缓存，分为两种 "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("强制缓存（首页没法强制缓存） "),(0,t._)("ul",null,[(0,t._)("li",null,"Cache-Control max-age"),(0,t._)("li",null,"Expires"),(0,t._)("li",null,"有的文件设置上了 可能会导致内容是老的内容 相对时间优先级更高")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Cache-Control'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'max-age=10'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 低版本浏览器只支持这个绝对时间"),(0,t.Uk)("\nres"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Expires'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Date"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Date"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"now"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"10000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toGMTString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("对比缓存 "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("last-modified(服务端)) if-modified-since(客户端) "),(0,t._)("ul",null,[(0,t._)("li",null,"If-Modified-Since"),(0,t._)("li",null,"第一次访问时，请求头的last-modified最后修改时间8：00 以后请求时，带着这个时间，发现变成了10：00就返回新的文件"),(0,t._)("li",null,"If-Modified-Since 是浏览器自己携带的，如果服务器设置过last-modified，下次请求就会带上这个头"),(0,t._)("li",null,"缺陷：如果文件没改，时间变了 时间精确到秒，可能会有问题")])]),(0,t._)("li",null,[(0,t.Uk)("Etag(服务端) if-none-match(客户端) "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("Etag 实体内容 "),(0,t._)("ul",null,[(0,t._)("li",null,"根据文件内容算出一个唯一的值 md5"),(0,t._)("li",null,"方式比较靠谱，精确，但不能对大文件进行etag 一般用文件的大小和文件的最后修改时间来组成etag")])])])])])])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" mime "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mime'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" abs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" stat")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Not Found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ctime "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("ctime"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toUTCString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'if-modified-since'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(" ctime"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"304"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Last-Modified'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" ctime"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("abs"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" mime "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mime'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" crypto "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'crypto'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" abs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" stat")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Not Found'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("stat"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" md5 "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" crypto"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createHash"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'md5'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("abs"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                md5"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"update"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'end'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" etag "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" md5"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"digest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'base64'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'if-none-match'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" etag"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"304"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Etag'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" etag"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"concat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("abs"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br")])])]),(0,t._)("li",null,"全部都使用 如果浏览器访问服务端 会先加一个强制缓存 强制缓存- 5s，5s后会再次发送请求 对比缓存 先判断 last-modified 再判断etag如果都成立 返回304"),(0,t._)("li",null,"继续强制5s，5s后再次发请求 如果有变化 会再返回新的文件 304=last-modified+etag")],-1),Gs=(0,t._)("h4",{id:"express",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#express","aria-hidden":"true"},"#"),(0,t.Uk)(" express")],-1),Js=(0,t._)("ul",null,[(0,t._)("li",null,"express 大 全 集成路由的功能，集成了内置的方法"),(0,t._)("li",null,"koa 小+插件 egg"),(0,t._)("li",null,"express 使用")],-1),Ks=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"//监听函数"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// use 中间件 get/post/delete/put"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 从上往下的顺序找"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 请求方法+请求路径"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'home'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/a'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'home-a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"post"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'post home'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n\n"),(0,t._)("span",{class:"token comment"},"// 所有方法，没有具体的就走这个"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"all"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'*'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// // 匹配所有路径"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// app.all('*', function(req, res) {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     res.end('all * ')"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3001"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"//可监听多个服务"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br")])],-1),Xs=(0,t._)("ul",null,[(0,t._)("li",null,"实现express监听方法和路径")],-1),Vs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// methods模块，所有的ajax方法"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" methods "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'methods'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"application"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"app"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的方法"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" method "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toLowerCase"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的路径"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"for"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(" i "),(0,t._)("span",{class:"token operator"},"<"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(" i"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" currentLayer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("i"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'*'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'进来'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"Cannot "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("method"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"}," "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 批量添加所有方法"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("methods"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"method"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        app"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" layer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                method"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                callback\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("layer"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 实现all"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"listen"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" application"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br")])],-1),Ys=(0,t._)("ul",null,[(0,t._)("li",null,"实现express参数传递")],-1),Zs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 当有两个值时就会进入这个方法"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 常见传递参数的方式 ?a=1&b=2 req.query /1/2 req.params"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// pathToRegExp '/username/1/2/a'=>[1,2]=>{xid:1,xname:2}"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/username/:xid/:xname'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("params"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("xid"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("params"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("xname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("params"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("xid"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},","),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("params"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("xname"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/username'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"ok"),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n\n"),(0,t._)("span",{class:"token comment"},"// app.get('/username', function(req, res) {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     console.log('ok service');"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     res.end(`fadsfads`)"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n\n\n"),(0,t._)("span",{class:"token comment"},"// pathToRegExp '/username/1/2/a'=>[1,2]=>{xid:1,xname:2}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 把请求路径 和 配置的路径 取出params"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// let server = '/username/:xid/:xname/a';"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// let client = '/username/1/2/a';"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// let arr = [];"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// let regStr = server.replace(/:([^\\/]+)/g, function() {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     arr.push(arguments[1]);"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     return '([^\\/]+)'"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// let reg = new RegExp(regStr);"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// let [, ...args] = client.match(reg);"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// console.log(client.match(reg));"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// let params = arr.reduce((memo, current, index) => (memo[current] = args[index], memo), {});"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// console.log(params);"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br")])],-1),Qs=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// methods模块，所有的ajax方法"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" methods "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'methods'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"application"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"app"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的方法"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" method "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toLowerCase"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的路径"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"for"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(" i "),(0,t._)("span",{class:"token operator"},"<"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(" i"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" currentLayer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("i"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// 路径存在 并且 是正则 说明是路径参数 匹配出用户的参数 使用参数和路由返回出匹配的结果"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token comment"},"// currentLayer.path => reg"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token comment"},"// pathname /username/1/2"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"test"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"match"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("params "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"reduce"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("memo"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" current"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" index")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("memo"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" args"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" memo"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'*'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'进来'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"Cannot "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("method"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"}," "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 批量添加所有方法"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("methods"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"method"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        app"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// path如果有: 冒号，就是路径参数路由"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"includes"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"':'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" parms "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"replace"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},":([^\\/]+)"),(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-flags"},"g")]),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    parms"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arguments"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'([^\\/]+)'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"RegExp"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" parms"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" layer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                method"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                callback\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("layer"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"listen"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" application\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br")])],-1),na=(0,t._)("ul",null,[(0,t._)("li",null,"实现express中间件")],-1),sa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// cookie path"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 中间件"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 只要开头匹配就走"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 可以放公共的逻辑 执行的代码"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 一般情况下中间件放到路由的上方"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 有路径和handler，没有方法"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 用于鉴权，可以拦截，如果有权限可以接续，决定代码是否向下执行"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// path不传就是/"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/write'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// next就走下一个中间件或者接口，代表执行下个中间件的回调方法"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'4'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/write'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'5'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// app.use('/', function(req, res, next) {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     console.log(3)"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// app.use('/', function(req, res, next) {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     console.log(4)"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'xxxx'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br")])],-1),aa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// methods模块，所有的ajax方法"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" methods "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'methods'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"application"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"app"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的方法"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" method "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toLowerCase"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的路径"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token comment"},"// 默认先取出第一个看看是路由还是中间件"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" index "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index "),(0,t._)("span",{class:"token operator"},">="),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"Cannot "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("method"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"}," "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" currentLayer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'middle'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"startsWith"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token comment"},"// currentLayer.path => reg"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token comment"},"// pathname /username/1/2"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"test"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"match"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                        req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("params "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"reduce"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("memo"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" current"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" index")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)("\n                            "),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("memo"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" args"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" memo"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'*'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'进来'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    index"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"use"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" handler")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" handler "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'undefined'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            handler "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" layer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            method"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'middle'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            callback"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" handler\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("layer"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 批量添加所有方法"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("methods"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"method"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        app"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// path如果有: 冒号，就是路径参数路由"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"includes"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"':'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" parms "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"replace"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},":([^\\/]+)"),(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-flags"},"g")]),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    parms"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arguments"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'([^\\/]+)'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"RegExp"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" parms"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" layer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                method"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                callback\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("layer"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"listen"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" application\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"63"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"64"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"65"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"66"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"67"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"68"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"69"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"70"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"71"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"72"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"73"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"74"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"75"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"76"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"77"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"78"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"79"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"80"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"81"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"82"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"83"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"84"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"85"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"86"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"87"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"88"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"89"),(0,t._)("br")])],-1),ta=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 自己实现以下express功能 express内置的中间件 可以实现封装一些公共方法和属性"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" query "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("query "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" query"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"sendFile"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("p"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" options "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" abs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("options"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("root"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" p"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// mime"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("abs"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"send"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isBuffer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" value "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'string'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'text/html;charset=utf-8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" value "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'object'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'application/json;charset=utf-8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stringify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" value "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'number'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" value"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'_http_server'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token constant"},"STATUS_CODES"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("value"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'xxxx'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" name"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"123"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sendFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./package.json'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" root"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" __dirname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br")])],-1),ea=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// methods模块，所有的ajax方法"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" methods "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'methods'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"application"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"app"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的方法"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" method "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toLowerCase"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 获取用户请求的路径"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token comment"},"// 默认先取出第一个看看是路由还是中间件"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" index "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index "),(0,t._)("span",{class:"token operator"},">="),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"Cannot "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("method"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"}," "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" currentLayer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 有错误并且是中间件 函数的参数长度是4 就是找到了"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'middle'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("callback"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"4"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"//继续向下传递错误"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'middle'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" pathname "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"startsWith"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token comment"},"// currentLayer.path => reg"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token comment"},"// pathname /username/1/2"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"test"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" pathname"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"match"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                            req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("params "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"reduce"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("memo"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" current"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" index")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)("\n                                "),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("memo"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" args"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" memo"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("method "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("pathname "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"||"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'*'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'进来'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" currentLayer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"callback"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                        index"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                        "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// for (let i = 0; i < app.routes.length; i++) {"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//     let currentLayer = app.routes[i];"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//     // 路径存在 并且 是正则 说明是路径参数 匹配出用户的参数 使用参数和路由返回出匹配的结果"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//     if (currentLayer.path.parms) {"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//         // currentLayer.path => reg"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//         // pathname /username/1/2"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//         if (method === currentLayer.method && currentLayer.path.test(pathname)) {"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//             let [, ...args] = pathname.match(currentLayer.path);"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//             req.params = currentLayer.path.parms.reduce((memo, current, index) =>"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//                 (memo[current] = args[index], memo), {})"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//             return currentLayer.callback(req, res);"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//         }"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//     }"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//     if ((method === currentLayer.method || currentLayer.method == 'all') && (pathname === currentLayer.path || currentLayer.path == '*')) {"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//         console.log('进来')"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//         return currentLayer.callback(req, res);"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"//     }"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token comment"},"// }"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// res.end(`Cannot ${method} ${pathname}`)"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"use"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" handler")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"typeof"),(0,t.Uk)(" handler "),(0,t._)("span",{class:"token operator"},"=="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'undefined'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            handler "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/'"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" layer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            method"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'middle'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n            callback"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" handler\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("layer"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 批量添加所有方法"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("methods"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'all'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"forEach"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"method"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        app"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("method"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" callback")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// path如果有: 冒号，就是路径参数路由"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"includes"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"':'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" parms "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"replace"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},":([^\\/]+)"),(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-flags"},"g")]),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    parms"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arguments"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'([^\\/]+)'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"RegExp"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("parms "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" parms"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" layer "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                method"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                path"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n                callback\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("routes"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("layer"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    app"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"listen"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("app"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" application\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"63"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"64"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"65"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"66"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"67"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"68"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"69"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"70"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"71"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"72"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"73"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"74"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"75"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"76"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"77"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"78"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"79"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"80"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"81"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"82"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"83"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"84"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"85"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"86"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"87"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"88"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"89"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"90"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"91"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"92"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"93"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"94"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"95"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"96"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"97"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"98"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"99"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"100"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"101"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"102"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"103"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"104"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"105"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"106"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"107"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"108"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"109"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"110"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"111"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"112"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"113"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"114"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"115"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"116"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"117"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"118"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"119"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"120"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"121"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"122"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"123"),(0,t._)("br")])],-1),oa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// next()传参会跳过其他中间件直接找错误中间件（四个参数的，第一个是err）"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'xxxx'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 错误中间件：有四个参数"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br")])],-1),ca=(0,t._)("ul",null,[(0,t._)("li",null,"express ejs使用")],-1),pa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// express 中内置了模板引擎"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 会默认去找views文件夹下的index.ejs"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 不使用ejs后缀名：指定渲染方式"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"engine"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'.html'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'ejs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("__express"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 不带后缀名：设置模板引擎的后缀"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"set"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'view engine'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 设置文件夹名字"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"set"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'views'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'my'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 后缀名更改"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"render"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'index.html'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" name"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 不改后缀名"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"render"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'index.ejs'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" name"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br")])],-1),la=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("express内置中间件 "),(0,t._)("ul",null,[(0,t._)("li",null,"express.static()")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// app.use 可以提供一些公共的功能"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 1. 获取静态文件功能中间件:会在指定目录中找文件,请求路径处理不了就走next()(跟app.use的位置无关)"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("express"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"static"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 需要再子级目录找，要自己添加"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("express"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"static"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/my'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'ok'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br")])]),(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"自己实现获取静态文件功能的中间件"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 自己实现获取静态文件功能的中间件"),(0,t.Uk)("\nexpress"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"static"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"dirname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 为了方便传参，所以写成了高阶函数"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 中间件的函数都是一个高阶函数，返回的是一个函数"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"path"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" statObj")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token comment"},"// 中间件无法处理 向下执行"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isFile"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br")])])]),(0,t._)("ul",null,[(0,t._)("li",null,"body-parser 第三方中间件 请求体解析")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" bodyParser "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'body-parser'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 原来解析请求体"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// app.post('/ajax', function(req, res) {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     let arr = [];"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     req.on('data', function(data) {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//         arr.push(data);"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     })"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     req.on('end', function() {"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//         console.log(Buffer.concat(arr).toString())"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//         res.end()"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"//     })"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// })"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 使用中间件解析请求体"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 位置一般放在请求上面，因为需要先解析再执行请求。会把解析后的结果放在req.body上"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 解析json（）"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("bodyParser"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"json"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 解析表单格式"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("bodyParser"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"urlencoded"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"post"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/ajax'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("body"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("body"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br")])]),(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"自己实现body-parser"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 自己实现body-parser"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"bodyParser"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nbodyParser"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"json"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'content-type'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'application/json'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'end'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("body "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"concat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nbodyParser"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"urlencoded"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'content-type'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'application/x-www-form-urlencoded'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("data"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'end'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("body "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'querystring'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"concat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br")])])]),(0,t._)("ul",null,[(0,t._)("li",null,"cookie-parser express-session")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("  \n\n"),(0,t._)("span",{class:"token comment"},"// 使用包:将cookie解析后放到req属性上"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// cookie签名直接参数传"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cookieParser "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'cookie-parser'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" session "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express-session'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token function"},"cookieParser"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token function"},"session"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    resave"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"false"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 每次是否发放新的名字"),(0,t.Uk)("\n    saveUninitialized"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 只要客户端连接服务端，就提供一个session"),(0,t.Uk)("\n    secret"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"//签名的秘钥"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/read'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("cookies"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("a"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/write'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"cookie"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'name'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" signed"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token boolean"},"true"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("session"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("a "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'hello'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'ok'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br")])]),(0,t._)("ul",null,[(0,t._)("li",null,"body-parser不支持文件 使用multer处理文件内容")])])],-1),ua=(0,t._)("h4",{id:"koa",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#koa","aria-hidden":"true"},"#"),(0,t.Uk)(" koa")],-1),ka=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("特点 "),(0,t._)("ul",null,[(0,t._)("li",null,"增加了自己封装的ctx上下文"),(0,t._)("li",null,"koa 中间件支持异步 express 中间件不支持异步")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" Koa "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'koa'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// let Koa = require('./koa/application')"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// app是这个类的实例"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Koa"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 洋葱模型"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"async"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("ctx"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"async"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("ctx"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"4"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// koa统一捕获promise错误(调用了两次next)"),(0,t.Uk)("\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'error'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n\n"),(0,t._)("span",{class:"token comment"},"// async 函数执行后返回的是一个promise"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"async"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("ctx"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// ctx.req ctx.res 原生的"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// ctx.request ctx.response 自己封装的 尽量使用它封装的，不要使用原生的"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// res.end('xxxx')"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// ctx.req.url"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// ctx.request.req.url"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// ctx.request.url"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// ctx.url"),(0,t.Uk)("\n    ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("body "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'hello'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 返回给客户端"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 如果下一个中间件中有await异步的话，需要加上await或者return来等异步执行完再继续执行下一步"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"next"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"async"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("ctx"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" next")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"await"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Promise"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("resolve"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" reject")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"1000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("body "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'world'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'server start'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("源码"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// application.js"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" context "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./context'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" request "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./request'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" response "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./response'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" EventEmitter "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'events'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n\n"),(0,t._)("span",{class:"token keyword"},"class"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Koa"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"extends"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"EventEmitter"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"constructor"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("middlewares "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 防止用户直接修改context对象"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("context "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"create"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("context"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("request "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"create"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("response "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"create"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("response"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"use"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"fn"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("middlewares"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("fn"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token comment"},"// 产生ctx上下文"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"createContext"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ctx "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("context"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("request "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("response "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("response"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("request"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("req "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("req "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("response"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("res "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("res "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" ctx"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"compose"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("ctx"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" middlewares")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"-"),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token function-variable function"},"dispatch"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"async"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"index"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index "),(0,t._)("span",{class:"token operator"},"<="),(0,t.Uk)(" i"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" Promise"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"reject"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'multi called next()~~~~'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            i "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" index"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// 最后一个中间件，再调用next方法无效"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" middleware"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" middleware "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" middlewares"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"middleware"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("ctx"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(" dispatch"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"dispatch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"handlerRequest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ctx "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createContext"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 创建上下文"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 预先定义个404状态码"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        "),(0,t._)("span",{class:"token comment"},"// compose函数 组合函数 n种方式 reduce function next()"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" p "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"compose"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("middlewares"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 组合后会产生一个新的promise,等待这个promise执行完成后 取ctx.body 返回结果"),(0,t.Uk)("\n        p"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"then"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" body "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("body"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("body "),(0,t._)("span",{class:"token keyword"},"instanceof"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Stream"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token comment"},"// 说明当前是二进制流文件"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'application/octet-stream'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Disposition'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"attachment; filename="),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("body"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("path"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                body"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("body"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("body"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"Not Found"),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"catch"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"emit"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'error'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"handlerRequest"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"bind"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        server"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("args"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Koa"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"63"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"64"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"65"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"66"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"67"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"68"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"69"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"70"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"71"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"72"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"73"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// context.js"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" cxt "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// 公共代理方法"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token comment"},"// 获取代理"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"defineGetter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("property"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" key")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 取值时相当于去property上面取值"),(0,t.Uk)("\n    ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"__defineGetter__"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("property"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 设置代理"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"defineSetter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("property"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" key")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    ctx"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"__defineGetter__"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("property"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("key"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" value"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// ctx.url=ctx.request.url"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"defineGetter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'request'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"defineGetter"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'response'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'body'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ctx"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 上下文上的url"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// response.js"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" response "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    _body"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"''"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"get"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"body"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_body\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"set"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"body"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"value"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"200"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_body "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" value\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" response"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" request "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"get"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"url"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" request"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br")])])])],-1),_a=(0,t._)("h4",{id:"http头的应用",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#http头的应用","aria-hidden":"true"},"#"),(0,t.Uk)(" http头的应用")],-1),ia=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("p",null,"多语言"),(0,t._)("ul",null,[(0,t._)("li",null,"前端实现多语言 vue-i18n / 做成多个网站 / 服务端来实现"),(0,t._)("li",null,"Accept-Language: zh-CN,zh;q=0.9,en;q=0.8")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" defaultLanguage"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token string"},"'zh-CN'"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" language"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'accept-language'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token string"},"'text/plain;charset=utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("language"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    language"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("language"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"','"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"map"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"lan"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("l"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("q"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token string"},'"q=1"'),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("lan"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'";"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("lan"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)("l"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("q"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)("q"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"="'),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"sort"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("a"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("b")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("b"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("q"),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("a"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("q"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"for"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" i"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"<"),(0,t.Uk)("language"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("i"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token operator"},">"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" current"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("language"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("i"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("lan"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token keyword"},"if"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("languages"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("languages"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("current"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n      "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("languages"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("defaultLanguage"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token keyword"},"else"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("languages"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("defaultLanguage"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t._)("p",null,"断点续传 范围请求206"),(0,t._)("ul",null,[(0,t._)("li",null,"写一个客户端 1-5 5-10 10-`5"),(0,t._)("li",null,"请求头加：Range:bytes=0-5"),(0,t._)("li",null,"响应头：Content-Range:bytes 0-5/2381")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},'// curl -v --header "Range:bytes=0-5" http://www.baidu.com'),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},'// curl -v --header "Range:bytes=0-5" http://localhost:3000 '),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 发一个范围请求"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 下载的时候"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(),(0,t._)("span",{class:"token constant"},"DOWNLOAD_FILE"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'name.txt'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" total "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"statSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"DOWNLOAD_FILE"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("size"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" range "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'range'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-type'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'text/plain;charset=utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("range"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" start"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" end"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" range"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"match"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},"(\\d*)-(\\d*)"),(0,t._)("span",{class:"token regex-delimiter"},"/")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        start "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" start "),(0,t._)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"Number"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("start"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        end "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" end "),(0,t._)("span",{class:"token operator"},"?"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"Number"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("end"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" total"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"206"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Range'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"bytes "),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("start"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"-"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("end"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"/"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("total"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 返回部分数据"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"DOWNLOAD_FILE"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)(" start"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" end"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" end "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"1"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"DOWNLOAD_FILE"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nserver"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" start "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ws "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createWriteStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./test.txt'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"downLoad"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        hostname"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'localhost'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        port"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        headers"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            Range"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token template-string"},[(0,t._)("span",{class:"token template-punctuation string"},"`"),(0,t._)("span",{class:"token string"},"bytes="),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("start"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token string"},"-"),(0,t._)("span",{class:"token interpolation"},[(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"${"),(0,t.Uk)("start"),(0,t._)("span",{class:"token operator"},"+"),(0,t._)("span",{class:"token number"},"5"),(0,t._)("span",{class:"token interpolation-punctuation punctuation"},"}")]),(0,t._)("span",{class:"token template-punctuation string"},"`")]),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 监听服务端 返回的数据"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'data'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"chunk"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            ws"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"write"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("chunk"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" total "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'content-range'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("start "),(0,t._)("span",{class:"token operator"},"<="),(0,t.Uk)(" total"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                start "),(0,t._)("span",{class:"token operator"},"+="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"5"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token function"},"setTimeout"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token function"},"downLoad"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"1000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                ws"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token function"},"downLoad"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t._)("p",null,"判断内核"),(0,t._)("ul",null,[(0,t._)("li",null,"浏览器：navigator.userAgent"),(0,t._)("li",null,"服务端 user-agent 判断浏览器内核 跳转到不同网站上 临时跳转 302")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" core "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'user-agent'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("core"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"includes"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Android'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"302"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token comment"},"// 浏览器会解析地址 进行跳转"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Location'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'http://www.baidu.com'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 重定向"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"302"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Location'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'http://www.javascriptpeixun.cn'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 重定向"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nserver"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t._)("p",null,"referer"),(0,t._)("ul",null,[(0,t._)("li",null,"来源 安全 xss csrf"),(0,t._)("li",null,"防盗链 限制用户发请求的网站 来源 referer"),(0,t._)("li",null,"可以伪造 + 验证码 （影响用户体验）")]),(0,t._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t._)("pre",{class:"language-html"},[(0,t._)("code",null,[(0,t._)("span",{class:"token doctype"},[(0,t._)("span",{class:"token punctuation"},"<!"),(0,t._)("span",{class:"token doctype-tag"},"DOCTYPE"),(0,t.Uk)(),(0,t._)("span",{class:"token name"},"html"),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("html")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"lang"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("en"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("head")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("meta")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"charset"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("UTF-8"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("meta")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"name"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("viewport"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"content"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("width=device-width, initial-scale=1.0"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("meta")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"http-equiv"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("X-UA-Compatible"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"content"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("ie=edge"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("title")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("Document"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("title")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("head")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("body")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"\x3c!-- 其他服务器的图片在自己的网页上显示会出现防盗链现象（判断referer和主机名不一样，就是盗取） --\x3e"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"\x3c!-- host 本地域名改成 www.baidu.com --\x3e"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"\x3c!-- xxx.com --\x3e"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("img")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"src"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("http://a.zhufeng.cn:3000/1.jpg"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"alt"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("body")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("html")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" whiteList "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'localhost:3000'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'.'"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" statObj")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("err"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("statusCode "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"404"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("statObj"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"isDirectory"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// Host:a.zhufeng.cn:3000 主机名"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token comment"},"// Referer:http://b.zhufeng.cn:4000/1.html 判断引用来源"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" refererHost "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'referer'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("refererHost"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                refererHost "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" url"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"parse"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("refererHost"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("host"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" host "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'host'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)(),(0,t._)("span",{class:"token comment"},"// 当前的主机 当前的图片地址"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("refererHost "),(0,t._)("span",{class:"token operator"},"!=="),(0,t.Uk)(" host "),(0,t._)("span",{class:"token operator"},"&&"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)("whiteList"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"includes"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("refererHost"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n                    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'/bad.jpeg'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n                "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n            console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"join"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("url"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nserver"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t._)("p",null,"gzip压缩"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("压缩体积 "),(0,t._)("ul",null,[(0,t._)("li",null,"Content-Encoding: gzip res"),(0,t._)("li",null,"Accept-Encoding: gzip, deflate, br req")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" zlib "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'zlib'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// let gzip = zlib.createGzip(); // 流 转化流"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" url "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'url'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// fs.createReadStream('./test.txt').pipe(gzip).pipe(fs.createWriteStream('./test.gz'));"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" encoding "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token string"},"'accept-encoding'"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("encoding"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},"\\b(gzip)\\b"),(0,t._)("span",{class:"token regex-delimiter"},"/")]),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"test"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("encoding"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Encoding'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'xxx'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./1.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("zlib"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createGzip"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token regex"},[(0,t._)("span",{class:"token regex-delimiter"},"/"),(0,t._)("span",{class:"token regex-source language-regex"},"\\b(deflate)\\b"),(0,t._)("span",{class:"token regex-delimiter"},"/")]),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"test"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("encoding"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setHeader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Content-Encoding'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'deflate'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./1.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("zlib"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createDeflate"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./1.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"else"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createReadStream"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./1.html'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"pipe"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\nserver"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br")])])])])]),(0,t._)("li",null,[(0,t._)("p",null,"host"),(0,t._)("ul",null,[(0,t._)("li",null,"代理： 正向代理（客户端用密码，客户端对代理知道的，科学上网） 反向代理（客户端访问代理服务器，客户端不知道代理的存在，nginx）"),(0,t._)("li",null,"正向代理 就是我访问 外网 我需要挂一个代理来访问（客户知道代理的存在）"),(0,t._)("li",null,"反向代理 就是我访问 外网 某个网站前 会先判断 跳转到指定的网站（客户端不知道代理的存在）"),(0,t._)("li",null,"两个不同的host，相同的端口访问不同的网站"),(0,t._)("li",null,"正向代理 就是我访问 外网 我需要挂一个代理来访问（客户知道代理的存在）"),(0,t._)("li",null,[(0,t.Uk)("反向代理 就是我访问 外网 某个网站前 会先判断 跳转到指定的网站（客户端不知道代理的存在） "),(0,t._)("ul",null,[(0,t._)("li",null,"http-proxy")])])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" httpProxy "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http-proxy'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" p "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" httpProxy"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createProxyServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" proxy "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},'"a.zhufeng.cn:8081"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"http://localhost:3000"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},'"b.zhufeng.cn:8081"'),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"http://localhost:4000"'),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("host"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" host "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("headers"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("host"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    p"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"web"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        target"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" proxy"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("host"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"8081"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nhttp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'b'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"4000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])])])],-1),ra=(0,t._)("h4",{id:"http服务",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#http服务","aria-hidden":"true"},"#"),(0,t.Uk)(" http服务")],-1),Ua=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// node中的核心模块，专门用来创建http服务的"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" http"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'http'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// http.get只能发送get请求"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 相当于发了post localhost:3000/path"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" client"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("http"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"request"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  host"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'localhost'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  method"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'post'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  port"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  path"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'/user'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  headers"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    name"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'zfpx'"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 请求体"),(0,t.Uk)("\nclient"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"end"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'age=9'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br")])],-1),ba=(0,t._)("h3",{id:"crypto模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#crypto模块","aria-hidden":"true"},"#"),(0,t.Uk)(" crypto模块")],-1),ma=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("md5 "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("摘要算法 并不是加密 不能解密 "),(0,t._)("ul",null,[(0,t._)("li",null,"相同的内容 摘要后相同"),(0,t._)("li",null,"不同的内容 摘要出的结果完全不同"),(0,t._)("li",null,"长度永远相同"),(0,t._)("li",null,"摘要后不能反过来")])]),(0,t._)("li",null,[(0,t.Uk)("存密码 "),(0,t._)("ul",null,[(0,t._)("li",null,"gnzLDuqKcGxMNKFokfhOew== 12345 撞库")])])])]),(0,t._)("li",null,[(0,t.Uk)("加盐算法 "),(0,t._)("ul",null,[(0,t._)("li",null,"有密钥，一般用openssl生成一串字符串")])])],-1),da=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// md5"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" crypto "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'crypto'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" str "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" crypto"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createHash"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'md5'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"update"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'12345'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"digest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'base64'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nstr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" crypto"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createHash"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'md5'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"update"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"digest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'base64'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 加盐算法"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" secret "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'zf'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" str "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" crypto"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createHmac"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'sha256'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" secret"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"update"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'123456'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"digest"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'base64'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br")])],-1),fa=(0,t._)("h3",{id:"util模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#util模块","aria-hidden":"true"},"#"),(0,t.Uk)(" util模块")],-1),ga=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("util.promisify(xxx) "),(0,t._)("ul",null,[(0,t._)("li",null,"将回调方法改成promise（util较麻烦，一般用第三方模块mz，将node模块转化成promise形式）")])])],-1),ya=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"//拿出来是个属性实例"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" util"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'util'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" read"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("util"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"promisify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("readFile"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])],-1),ha=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("Util.inherits(); "),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("继承方法，构造函数，继承原型上的公有属性(原理"),(0,t._)("code",null,"Object.setPrototypefOf()"),(0,t.Uk)(")")])])])],-1),wa=(0,t._)("h3",{id:"readline模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#readline模块","aria-hidden":"true"},"#"),(0,t.Uk)(" readline模块")],-1),va=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("createInterface({input,output}) "),(0,t._)("ul",null,[(0,t._)("li",null,"setPrompt(str) 设置提示文字"),(0,t._)("li",null,"prompt() 提供输入时显示提示文字"),(0,t._)("li",null,"on('line',callback) 输入后回车的回调")])])],-1),xa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"getNumber"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" char")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" res "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" str"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"split"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"''"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"reduce"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("acc"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" cur")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("cur "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" char"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(" acc"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" acc"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("res"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" readline "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'readline'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" rl "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" readline"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createInterface"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    input"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" process"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("stdin"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    output"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" process"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("stdout\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"const"),(0,t.Uk)(" rl "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" readline"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createInterface"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("process"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("stdin"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" process"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("stdout"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nrl"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"setPrompt"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'Test> '"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nrl"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"prompt"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" arr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\nrl"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'line'"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"=>"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"push"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"getNumber"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token operator"},"..."),(0,t.Uk)("arr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    rl"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"prompt"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br")])],-1),ja=(0,t._)("h2",{id:"手写一个common-js规范",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#手写一个common-js规范","aria-hidden":"true"},"#"),(0,t.Uk)(" 手写一个common.js规范")],-1),qa=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("读取文件规则 "),(0,t._)("ul",null,[(0,t._)("li",null,"会默认添加后缀名.js，找不到再.json，找不到再.node")])]),(0,t._)("li",null,[(0,t.Uk)("require方法的实现 "),(0,t._)("ul",null,[(0,t._)("li",null,"内置实现了一个require方法"),(0,t._)("li",null,"通过Module._load方法 加载模块"),(0,t._)("li",null,"Module._resolveFilename 根据相对路径转化为绝对路径 并且增加后缀"),(0,t._)("li",null,"模块的缓存问题 Module._cache"),(0,t._)("li",null,"new Module 创建模块 id存的是名字 exports={} this"),(0,t._)("li",null,[(0,t.Uk)("tryModuleLoad(module) 尝试加载这个模块 "),(0,t._)("ul",null,[(0,t._)("li",null,"取出文件的后缀"),(0,t._)("li",null,"加载模块（读取文件）"),(0,t._)("li",null,"Module.wrap 包裹读取的内容"),(0,t._)("li",null,"使用runInthisContext 运行字符串"),(0,t._)("li",null,"让字符串执行 this改变成exports")])])])])],-1),Sa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" path "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'path'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" vm "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'vm'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"Module"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"id"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("id "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" id"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"this"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\nModule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("wrapper "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},'"(function(exports,module,require,__dirname,__filename){"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},'"})"'),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)("\n\nModule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_extensions "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},"'.js'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" content "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readFileSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fnStr "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("wrapper"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" content "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" Module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("wrapper"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"1"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fn "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" vm"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"runInThisContext"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("fnStr"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token function"},"fn"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"call"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" module"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" req"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},"'.json'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" json "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readFileSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token string"},"'utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" json"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token string"},"'.node'"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"tryModuleLoad"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"module"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" extension "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"extname"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("id"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    Module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_extensions"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("extension"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nModule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_cache "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"req"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"modulePath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token comment"},"// 要加载的文件的绝对路径"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" absPathname "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" path"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"resolve"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("__dirname"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" modulePath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" extNames "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" Object"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"keys"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_extensions"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" index "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" old "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" absPathname"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"find"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"absPathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("index "),(0,t._)("span",{class:"token operator"},"==="),(0,t.Uk)(" extNames"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("length"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" absPathname"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"try"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            fs"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"accessSync"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" absPathname"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"catch"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" ext "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" extNames"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("index"),(0,t._)("span",{class:"token operator"},"++"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" newPath "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" old "),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)(" ext"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n            "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"find"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("newPath"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    absPathname "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"find"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n    "),(0,t._)("span",{class:"token keyword"},"if"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("Module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_cache"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("absPathname"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" Module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_cache"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("absPathname"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" module "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"Module"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("absPathname"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    Module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("_cache"),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("absPathname"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" module"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token function"},"tryModuleLoad"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"return"),(0,t.Uk)(" module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" obj "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"req"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./a.js'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token comment"},"// 重复引用"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" obj1 "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"req"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./a.js'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 自动添加后缀"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" obj2 "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"req"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'./a'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("obj2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"23"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"24"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"25"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"26"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"27"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"28"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"29"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"30"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"31"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"32"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"33"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"34"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"35"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"36"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"37"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"38"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"39"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"40"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"41"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"42"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"43"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"44"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"45"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"46"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"47"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"48"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"49"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"50"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"51"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"52"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"53"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"54"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"55"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"56"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"57"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"58"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"59"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"60"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"61"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"62"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"63"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"64"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"65"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"66"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"67"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"68"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"69"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"70"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"71"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"72"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"73"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"74"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"75"),(0,t._)("br")])],-1),La=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"面试题"),(0,t._)("p",null,"node文件中的module.exports和exports什么关系？"),(0,t._)("ul",null,[(0,t._)("li",null,"exports是module.exports别名。两个变量指向同一个空间，如果文件中赋值给exports,那module.exports的值不会变。就无法require进来。但如果改的是exports得属性，那就相当于改的module.exports的属性，就可以require进来。")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("module"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("exports"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nmodule"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("exports"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("exports"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token punctuation"},"{"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\nexports"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("a"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("xxx"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])],-1),Ca=(0,t._)("h2",{id:"第三方模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#第三方模块","aria-hidden":"true"},"#"),(0,t.Uk)(" 第三方模块")],-1),Pa=(0,t._)("h3",{id:"npm",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#npm","aria-hidden":"true"},"#"),(0,t.Uk)(" npm")],-1),Ea=(0,t._)("ul",null,[(0,t._)("li",null,"安装 npm 全局安装 -g（npm里加了快捷键，命令行中使用） 局部安装 （安装到当前文件夹中）"),(0,t._)("li",null,"npm")],-1),Oa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("npm init "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("y\nnpm install jquery@"),(0,t._)("span",{class:"token number"},"2.1"),(0,t._)("span",{class:"token number"},".0"),(0,t.Uk)("\nnpm uninstall jquery\nnpm info react\n"),(0,t._)("span",{class:"token comment"},"// yarn"),(0,t.Uk)("\nnpm install yarn "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("g\nyarn add jquery\nyarn remove jquery\nyarn global add mz\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br")])],-1),Ta=(0,t._)("h3",{id:"第三方模块的查找",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#第三方模块的查找","aria-hidden":"true"},"#"),(0,t.Uk)(" 第三方模块的查找")],-1),za=(0,t._)("ul",null,[(0,t._)("li",null,"第三方模块 不能出现 ./ ../的路径"),(0,t._)("li",null,"先根据module.paths向上找到node_mudules文件夹"),(0,t._)("li",null,"node_modules中，找同名文件夹（文件文件夹顺序不确定）"),(0,t._)("li",null,"找pakage.json,找到main入口"),(0,t._)("li",null,"没有pakage.json,就找index.js")],-1),Na=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"TIP"),(0,t._)("ul",null,[(0,t._)("li",null,"script可以快捷运行命令行，start/test 不需要run")])],-1),Ra=(0,t._)("h2",{id:"实现全局命令",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#实现全局命令","aria-hidden":"true"},"#"),(0,t.Uk)(" 实现全局命令")],-1),Ha=(0,t._)("ol",null,[(0,t._)("li",null,"包里的package.json中加上bin属性，前面是命令 后面是执行的文件")],-1),Fa=(0,t._)("div",{class:"language-json ext-json line-numbers-mode"},[(0,t._)("pre",{class:"language-json"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// package.json"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token property"},'"name"'),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},'"jw"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token property"},'"main"'),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},'"a.js"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token property"},'"scripts"'),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token property"},'"dev"'),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},'"export a=1 & node a.js --color red"'),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token property"},'"bin"'),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token property"},'"jw"'),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},'"./a.js"'),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br")])],-1),Ma=(0,t._)("ol",{start:"2"},[(0,t._)("li",null,[(0,t._)("code",null,"#! /usr/bin/env node"),(0,t.Uk)("使用node来运行文件")])],-1),Wa=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// a.js"),(0,t.Uk)("\n#"),(0,t._)("span",{class:"token operator"},"!"),(0,t.Uk)(),(0,t._)("span",{class:"token operator"},"/"),(0,t.Uk)("usr"),(0,t._)("span",{class:"token operator"},"/"),(0,t.Uk)("bin"),(0,t._)("span",{class:"token operator"},"/"),(0,t.Uk)("env node\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'hello'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])],-1),Ia=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("进入到包根目录，输入"),(0,t._)("code",null,"npm link"),(0,t.Uk)("（让全局的npm中的命令指向本地这个文件）")])],-1),Da=(0,t._)("h3",{id:"把我的包发布到npm官网",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#把我的包发布到npm官网","aria-hidden":"true"},"#"),(0,t.Uk)(" 把我的包发布到npm官网")],-1),Aa=(0,t._)("ul",null,[(0,t._)("li",null,"切换官方源 nrm use npm")],-1),Ba=(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"nrm切换源"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("npm install nrm "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("g\nnrm ls\nnrm current\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])],-1),$a=(0,t._)("ul",null,[(0,t._)("li",null,"登录账号 npm addUser"),(0,t._)("li",null,"发布代码 npm publish，名字用-连接"),(0,t._)("li",null,"取消发布 npm unpublish --force")],-1),Ga=(0,t._)("h2",{id:"buffer类",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#buffer类","aria-hidden":"true"},"#"),(0,t.Uk)(" Buffer类")],-1),Ja=(0,t._)("ul",null,[(0,t._)("li",null,"(不要用new) 缓存 二进制（表现成了16进制）"),(0,t._)("li",null,"utf8(三个字节) / gbk / gb2312(两个字节)")],-1),Ka=(0,t._)("h3",{id:"声明方式",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#声明方式","aria-hidden":"true"},"#"),(0,t.Uk)(" 声明方式")],-1),Xa=(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Uk)("Buffer.alloc() "),(0,t._)("ul",null,[(0,t._)("li",null,"申请一个buffer内存")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" buffer"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"alloc"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t._)("span",{class:"token comment"},"//<Buffer 00 00 00>"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("Buffer.from() "),(0,t._)("ul",null,[(0,t._)("li",null,"把字符串或者数组转化成16进制")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"from"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'珠峰'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// <Buffer e7 8f a0 e5 b3 b0>"),(0,t.Uk)("\nBuffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"from"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"255"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"255"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"255"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// <Buffer ff ff ff>"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("buffer.toString() "),(0,t._)("ul",null,[(0,t._)("li",null,"把buffer转化成字符串，默认utf8")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// 珠峰"),(0,t.Uk)("\nbuffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'utf8'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// 同上"),(0,t.Uk)("\nbuffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'base64'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// 54+g5b0w"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])]),(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"TIP"),(0,t._)("ul",null,[(0,t._)("li",null,"node只支持utf8格式，可以用iconv-lite，把二进制gbk转成utf8")])])])],-1),Va=(0,t._)("div",{class:"custom-container warning"},[(0,t._)("p",{class:"custom-container-title"},"编码的问题"),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t._)("p",null,"二进制 255，八进制 377，十六进制 ff")]),(0,t._)("li",null,[(0,t._)("p",null,"node读取的结果默认为十六进制")]),(0,t._)("li",null,[(0,t._)("p",null,"base64"),(0,t._)("ol",null,[(0,t._)("li",null,"一切能放置路径的地方都能使用base64"),(0,t._)("li",null,"只是编码，没有加密，把原有体积扩大了1/3")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" str"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token string"},"'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nstr"),(0,t._)("span",{class:"token operator"},"+="),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toLowerCase"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nstr"),(0,t._)("span",{class:"token operator"},"+="),(0,t._)("span",{class:"token string"},"'0123456789+/'"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"57"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"56"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"62"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"32"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token comment"},"// 54+g"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])]),(0,t._)("ol",{start:"3"},[(0,t._)("li",null,[(0,t._)("code",null,"fileReader"),(0,t.Uk)("文件读取器，读成"),(0,t._)("code",null,"base64"),(0,t.Uk)("编码的")])]),(0,t._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,t._)("pre",{class:"language-html"},[(0,t._)("code",null,[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("input")]),(0,t.Uk)(),(0,t._)("span",{class:"token attr-name"},"type"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t.Uk)("file"),(0,t._)("span",{class:"token punctuation"},'"')]),(0,t.Uk)(),(0,t._)("span",{class:"token special-attr"},[(0,t._)("span",{class:"token attr-name"},"onchange"),(0,t._)("span",{class:"token attr-value"},[(0,t._)("span",{class:"token punctuation attr-equals"},"="),(0,t._)("span",{class:"token punctuation"},'"'),(0,t._)("span",{class:"token value javascript language-javascript"},[(0,t._)("span",{class:"token function"},"fn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("event"),(0,t._)("span",{class:"token punctuation"},")")]),(0,t._)("span",{class:"token punctuation"},'"')])]),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"/>")]),(0,t.Uk)("\n"),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"<"),(0,t.Uk)("script")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t._)("span",{class:"token script"},[(0,t._)("span",{class:"token language-javascript"},[(0,t.Uk)("\n  "),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"fn"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" reader"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token keyword"},"new"),(0,t.Uk)(),(0,t._)("span",{class:"token class-name"},"FileReader"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    reader"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"readAsDataURL"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("target"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("files"),(0,t._)("span",{class:"token punctuation"},"["),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    reader"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function-variable function"},"onload"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"e"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n      console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("e"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("currentTarget"),(0,t._)("span",{class:"token punctuation"},"."),(0,t.Uk)("result"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t.Uk)("\n")])]),(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token tag"},[(0,t._)("span",{class:"token punctuation"},"</"),(0,t.Uk)("script")]),(0,t._)("span",{class:"token punctuation"},">")]),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t._)("p",null,"转化进制")])]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// 任意进制转10进制"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token function"},"parseInt"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'11111111'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"2"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token comment"},"// 任意进制转任意进制，但转出来是字符串类型"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"255"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"toString"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"8"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br")])])],-1),Ya=(0,t._)("h3",{id:"方法-数组的方法-length-字节的个数",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#方法-数组的方法-length-字节的个数","aria-hidden":"true"},"#"),(0,t.Uk)(" 方法（数组的方法 length 字节的个数）")],-1),Za=(0,t._)("ul",null,[(0,t._)("li",null,"buffer一旦声明，就不能增加长度"),(0,t._)("li",null,"forEach"),(0,t._)("li",null,"slice"),(0,t._)("li",null,[(0,t.Uk)("copy(target,targetStart,sourceStart,sourceEnd)"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" b1"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"from"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'珠'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" big"),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"alloc"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"6"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nb1"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"copy"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("big"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"0"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"3"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br")])])]),(0,t._)("li",null,[(0,t.Uk)("Buffer.concat([buf1,buf2]) "),(0,t._)("ul",null,[(0,t._)("li",null,"默认自动给长度")]),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("Buffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"concat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("b1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("b2"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nBuffer"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"concat"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"["),(0,t.Uk)("b1"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("b2"),(0,t._)("span",{class:"token punctuation"},"]"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token number"},"6"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br")])]),(0,t._)("div",{class:"custom-container tip"},[(0,t._)("p",{class:"custom-container-title"},"自己实现concat方法"),(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,"\n")]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])])])]),(0,t._)("li",null,"split()"),(0,t._)("li",null,"indexOf('珠')")],-1),Qa=(0,t._)("h3",{id:"mz模块",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#mz模块","aria-hidden":"true"},"#"),(0,t.Uk)(" mz模块")],-1),nt=(0,t._)("ul",null,[(0,t._)("li",null,"将回调方法改成promise")],-1),st=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" fs"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'mz/fs'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])],-1),at=(0,t._)("h3",{id:"websocket",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#websocket","aria-hidden":"true"},"#"),(0,t.Uk)(" websocket")],-1),tt=(0,t._)("ul",null,[(0,t._)("li",null,"安装")],-1),et=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("npm i nodejs"),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("websocket "),(0,t._)("span",{class:"token operator"},"-"),(0,t._)("span",{class:"token constant"},"S"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br")])],-1),ot=(0,t._)("ul",null,[(0,t._)("li",null,"创建服务使用")],-1),ct=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token keyword"},"var"),(0,t.Uk)(" ws "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"nodejs-websocket"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"开始建立连接..."'),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"var"),(0,t.Uk)(" server "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(" ws"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"createServer"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token keyword"},"function"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"conn"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n  conn"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"text"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},"str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token keyword"},"var"),(0,t.Uk)(" msg "),(0,t._)("span",{class:"token operator"},"="),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n        type"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"message"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        text"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(),(0,t._)("span",{class:"token string"},'"something"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        id"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)("   "),(0,t._)("span",{class:"token string"},'"number"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("\n        date"),(0,t._)("span",{class:"token operator"},":"),(0,t.Uk)(" Date"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"now"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"message:"'),(0,t._)("span",{class:"token operator"},"+"),(0,t.Uk)("str"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n    conn"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"send"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token constant"},"JSON"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"stringify"),(0,t._)("span",{class:"token punctuation"},"("),(0,t.Uk)("msg"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  conn"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"close"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("code"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" reason")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"关闭连接"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n  conn"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"on"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"error"'),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(),(0,t._)("span",{class:"token keyword"},"function"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("code"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)(" reason")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)(),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    console"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"异常关闭"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n  "),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3001"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\nconsole"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"log"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},'"WebSocket建立完毕"'),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"11"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"12"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"13"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"14"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"15"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"16"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"17"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"18"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"19"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"20"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"21"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"22"),(0,t._)("br")])],-1),pt=(0,t._)("p",null,[(0,t._)("strong",null,"node核心模块")],-1),lt=(0,t._)("h2",{id:"express-1",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#express-1","aria-hidden":"true"},"#"),(0,t.Uk)(" express")],-1),ut=(0,t._)("ul",null,[(0,t._)("li",null,"安装")],-1),kt=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t.Uk)("npm install "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("g express"),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("generator\nnpm install "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("g express\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br")])],-1),_t=(0,t._)("ul",null,[(0,t._)("li",null,"快速创建express项目")],-1),it=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"// e.js作为模板引擎"),(0,t.Uk)("\nexpress "),(0,t._)("span",{class:"token operator"},"-"),(0,t.Uk)("e "),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token operator"},"/"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br")])],-1),rt=(0,t._)("ul",null,[(0,t._)("li",null,"使用")],-1),Ut=(0,t._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,t._)("pre",{class:"language-javascript"},[(0,t._)("code",null,[(0,t._)("span",{class:"token comment"},"//server.js"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" express"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"require"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'express'"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\n"),(0,t._)("span",{class:"token keyword"},"let"),(0,t.Uk)(" app"),(0,t._)("span",{class:"token operator"},"="),(0,t._)("span",{class:"token function"},"express"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"get"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token string"},"'/getUser'"),(0,t._)("span",{class:"token punctuation"},","),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token parameter"},[(0,t.Uk)("req"),(0,t._)("span",{class:"token punctuation"},","),(0,t.Uk)("res")]),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token operator"},"=>"),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("\n    res"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"json"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token punctuation"},"{"),(0,t.Uk)("name"),(0,t._)("span",{class:"token operator"},":"),(0,t._)("span",{class:"token string"},"'zfpx'"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t._)("span",{class:"token punctuation"},";"),(0,t.Uk)("\n"),(0,t._)("span",{class:"token punctuation"},"}"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n\napp"),(0,t._)("span",{class:"token punctuation"},"."),(0,t._)("span",{class:"token function"},"listen"),(0,t._)("span",{class:"token punctuation"},"("),(0,t._)("span",{class:"token number"},"3000"),(0,t._)("span",{class:"token punctuation"},")"),(0,t.Uk)("\n")])]),(0,t._)("div",{class:"line-numbers"},[(0,t._)("span",{class:"line-number"},"1"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"2"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"3"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"4"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"5"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"6"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"7"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"8"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"9"),(0,t._)("br"),(0,t._)("span",{class:"line-number"},"10"),(0,t._)("br")])],-1),bt={render:function(n,s){const a=(0,t.up)("RouterLink");return(0,t.wg)(),(0,t.iD)(t.HY,null,[o,(0,t._)("nav",c,[(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(a,{to:"#浏览器事件环-event-loop"},{default:(0,t.w5)((()=>[p])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#node-1"},{default:(0,t.w5)((()=>[l])),_:1}),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(a,{to:"#node安装"},{default:(0,t.w5)((()=>[u])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#node-start"},{default:(0,t.w5)((()=>[k])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#node-event-loop"},{default:(0,t.w5)((()=>[_])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#global"},{default:(0,t.w5)((()=>[i])),_:1})])])]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#内置模块"},{default:(0,t.w5)((()=>[r])),_:1}),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(a,{to:"#vm"},{default:(0,t.w5)((()=>[U])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#path"},{default:(0,t.w5)((()=>[b])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#fs模块"},{default:(0,t.w5)((()=>[m])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#events模块"},{default:(0,t.w5)((()=>[d])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#流"},{default:(0,t.w5)((()=>[f])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#http模块"},{default:(0,t.w5)((()=>[g])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#crypto模块"},{default:(0,t.w5)((()=>[y])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#util模块"},{default:(0,t.w5)((()=>[h])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#readline模块"},{default:(0,t.w5)((()=>[w])),_:1})])])]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#手写一个common-js规范"},{default:(0,t.w5)((()=>[v])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#第三方模块"},{default:(0,t.w5)((()=>[x])),_:1}),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(a,{to:"#npm"},{default:(0,t.w5)((()=>[j])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#第三方模块的查找"},{default:(0,t.w5)((()=>[q])),_:1})])])]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#实现全局命令"},{default:(0,t.w5)((()=>[S])),_:1}),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(a,{to:"#把我的包发布到npm官网"},{default:(0,t.w5)((()=>[L])),_:1})])])]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#buffer类"},{default:(0,t.w5)((()=>[C])),_:1}),(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(a,{to:"#声明方式"},{default:(0,t.w5)((()=>[P])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#方法-数组的方法-length-字节的个数"},{default:(0,t.w5)((()=>[E])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#mz模块"},{default:(0,t.w5)((()=>[O])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#websocket"},{default:(0,t.w5)((()=>[T])),_:1})])])]),(0,t._)("li",null,[(0,t.Wm)(a,{to:"#express-1"},{default:(0,t.w5)((()=>[z])),_:1})])])]),N,R,H,F,M,W,I,D,A,B,$,G,J,K,X,V,Y,Z,Q,nn,sn,an,tn,en,on,cn,pn,ln,un,kn,_n,rn,Un,bn,mn,dn,fn,gn,yn,hn,wn,vn,xn,jn,qn,Sn,Ln,Cn,Pn,En,On,Tn,zn,Nn,Rn,Hn,Fn,Mn,Wn,In,Dn,An,Bn,$n,Gn,Jn,Kn,Xn,Vn,Yn,Zn,Qn,ns,ss,as,ts,es,os,cs,ps,ls,us,ks,_s,is,rs,Us,bs,ms,ds,fs,gs,ys,hs,ws,vs,xs,js,qs,Ss,Ls,Cs,Ps,Es,Os,Ts,zs,Ns,Rs,Hs,Fs,Ms,Ws,Is,Ds,As,Bs,$s,Gs,Js,Ks,Xs,Vs,Ys,Zs,Qs,na,sa,aa,ta,ea,oa,ca,pa,la,ua,ka,_a,ia,ra,Ua,ba,ma,da,fa,ga,ya,ha,wa,va,xa,ja,qa,Sa,La,Ca,Pa,Ea,Oa,Ta,za,Na,Ra,Ha,Fa,Ma,Wa,Ia,Da,Aa,Ba,$a,Ga,Ja,Ka,Xa,Va,Ya,Za,Qa,nt,st,at,tt,et,ot,ct,pt,lt,ut,kt,_t,it,rt,Ut],64)}}},9882:(n,s,a)=>{n.exports=a.p+"assets/img/event-loop-browser.a8115efb.jpg"}}]);