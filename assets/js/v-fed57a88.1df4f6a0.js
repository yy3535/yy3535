"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7307],{7428:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-fed57a88",path:"/Frontend/vuesource.html",title:"vue 源码",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"准备工作",slug:"准备工作",children:[{level:3,title:"Flow",slug:"flow",children:[]},{level:3,title:"Vue.js 源码构建",slug:"vue-js-源码构建",children:[]}]},{level:2,title:"nextTick",slug:"nexttick",children:[]},{level:2,title:"核心点MVVM和DOM-diff",slug:"核心点mvvm和dom-diff",children:[]},{level:2,title:"vue对象劫持",slug:"vue对象劫持",children:[]},{level:2,title:"数组劫持",slug:"数组劫持",children:[]},{level:2,title:"编译文本",slug:"编译文本",children:[]},{level:2,title:"依赖收集",slug:"依赖收集",children:[]},{level:2,title:"异步批量更新",slug:"异步批量更新",children:[]},{level:2,title:"数组的依赖收集更新？？",slug:"数组的依赖收集更新",children:[]},{level:2,title:"watch??",slug:"watch",children:[]},{level:2,title:"computed",slug:"computed",children:[]},{level:2,title:"虚拟dom和初次渲染，子节点比较",slug:"虚拟dom和初次渲染-子节点比较",children:[]},{level:2,title:"虚拟dom融合vue代码",slug:"虚拟dom融合vue代码",children:[]},{level:2,title:"Vue源码剖析",slug:"vue源码剖析",children:[{level:3,title:"一.目录源码剖析",slug:"一-目录源码剖析",children:[]},{level:3,title:"二.如何看Vue源代码",slug:"二-如何看vue源代码",children:[]},{level:3,title:"三.Vue的初始化工作",slug:"三-vue的初始化工作",children:[]},{level:3,title:"四.数据响应式原理",slug:"四-数据响应式原理",children:[]},{level:3,title:"五.计算属性的实现",slug:"五-计算属性的实现",children:[]},{level:3,title:"六.Watch的实现原理",slug:"六-watch的实现原理",children:[]},{level:3,title:"七.Dom-Diff原理",slug:"七-dom-diff原理",children:[]}]},{level:2,title:"总结图",slug:"总结图",children:[]},{level:2,title:"实现broadcast",slug:"实现broadcast",children:[]},{level:2,title:"组件",slug:"组件",children:[]},{level:2,title:"插件原理",slug:"插件原理",children:[{level:3,title:"vue-lazyload组件实现",slug:"vue-lazyload组件实现",children:[]},{level:3,title:"JS垃圾收集",slug:"js垃圾收集",children:[]},{level:3,title:"函数柯里化",slug:"函数柯里化",children:[]}]}],filePathRelative:"Frontend/vuesource.md",git:{updatedTime:1584339728e3,contributors:[]}}},3793:(n,s,a)=>{a.r(s),a.d(s,{default:()=>Qs});var e=a(6252),t=a(9429),l=a(8160);const o=(0,e._)("h1",{id:"vue-源码",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#vue-源码","aria-hidden":"true"},"#"),(0,e.Uk)(" vue 源码")],-1),c={href:"https://github.com/ustbhuangyi/vue-analysis",target:"_blank",rel:"noopener noreferrer"},p=(0,e.Uk)("电子书"),u=(0,e._)("h2",{id:"准备工作",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#准备工作","aria-hidden":"true"},"#"),(0,e.Uk)(" 准备工作")],-1),_=(0,e._)("h3",{id:"flow",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#flow","aria-hidden":"true"},"#"),(0,e.Uk)(" Flow")],-1),k=(0,e._)("p",null,"Flow 是 facebook 出品的 JavaScript 静态类型检查工具。",-1),r=(0,e._)("h4",{id:"为什么用-flow",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#为什么用-flow","aria-hidden":"true"},"#"),(0,e.Uk)(" 为什么用 Flow")],-1),i=(0,e._)("p",null,"JavaScript 是动态类型语言，它的灵活性有目共睹，但是过于灵活的副作用是很容易就写出非常隐蔽的隐患代码，在编译期甚至看上去都不会报错，但在运行阶段就可能出现各种奇怪的 bug。",-1),d=(0,e._)("p",null,"类型检查是当前动态类型语言的发展趋势，所谓类型检查，就是在编译期尽早发现（由类型错误引起的）bug，又不影响代码运行（不需要运行时动态检查类型），使编写 JavaScript 具有和编写 Java 等强类型语言相近的体验。",-1),U=(0,e._)("h4",{id:"flow-的工作方式",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#flow-的工作方式","aria-hidden":"true"},"#"),(0,e.Uk)(" Flow 的工作方式")],-1),b=(0,e._)("p",null,"通常类型检查分成 2 种方式：",-1),m=(0,e._)("p",null,"类型推断：通过变量的使用上下文来推断出变量类型，然后根据这些推断来检查类型。",-1),h=(0,e._)("p",null,"类型注释：事先注释好我们期待的类型，Flow 会基于这些注释来判断。",-1),g=(0,e._)("ul",null,[(0,e._)("li",null,"类型推断")],-1),v=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"/*@flow*/"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"split"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"str"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" str"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"split"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"' '"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"split"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"11"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),w=(0,e._)("ul",null,[(0,e._)("li",null,"类型注释")],-1),f=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"/*@flow*/"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("x"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" y")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" x "),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" y\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'Hello'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"11"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),y=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"/*@flow*/"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("x"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" number"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" y"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" number")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" number "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" x "),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" y\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'Hello'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"11"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),x=(0,e._)("h4",{id:"flow-在-vue-js-源码中的应用",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#flow-在-vue-js-源码中的应用","aria-hidden":"true"},"#"),(0,e.Uk)(" Flow 在 Vue.js 源码中的应用")],-1),j=(0,e._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,e._)("pre",{class:"language-text"},[(0,e._)("code",null,"npm install -g flow-bin\nflow init // 创建.flowconfig配置文件\nflow\n")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br")])],-1),V=(0,e._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,e._)("pre",{class:"language-text"},[(0,e._)("code",null,"flow\n├── compiler.js        # 编译相关\n├── component.js       # 组件数据结构\n├── global-api.js      # Global API 结构\n├── modules.js         # 第三方库定义\n├── options.js         # 选项相关\n├── ssr.js             # 服务端渲染相关\n├── vnode.js           # 虚拟 node 相关\n")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),C=(0,e._)("p",null,"可以看到，Vue.js 有很多自定义类型的定义，在阅读源码的时候，如果遇到某个类型并想了解它完整的数据结构的时候，可以回来翻阅这些数据结构的定义。",-1),z=(0,e._)("h3",{id:"vue-js-源码构建",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#vue-js-源码构建","aria-hidden":"true"},"#"),(0,e.Uk)(" Vue.js 源码构建")],-1),S=(0,e._)("p",null,"Vue.js 源码是基于 Rollup 构建的，它的构建相关配置都在 scripts 目录下。",-1),L=(0,e._)("h2",{id:"nexttick",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#nexttick","aria-hidden":"true"},"#"),(0,e.Uk)(" nextTick")],-1),E=(0,e._)("p",null,"重看nextTick 派发更新 依赖",-1),D=(0,e._)("h1",{id:"珠峰vue源码",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#珠峰vue源码","aria-hidden":"true"},"#"),(0,e.Uk)(" 珠峰vue源码")],-1),$=(0,e._)("h2",{id:"核心点mvvm和dom-diff",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#核心点mvvm和dom-diff","aria-hidden":"true"},"#"),(0,e.Uk)(" 核心点MVVM和DOM-diff")],-1),A=(0,e._)("ul",null,[(0,e._)("li",null,"vue中如何实现数据劫持"),(0,e._)("li",null,"数组得劫持"),(0,e._)("li",null,"vue中的观察者模式"),(0,e._)("li",null,"计算属性和watch的区别（原理）"),(0,e._)("li",null,"vue中数据的批量更新"),(0,e._)("li",null,"nextTick原理"),(0,e._)("li",null,"什么是虚拟dom及虚拟dom的作用"),(0,e._)("li",null,"vue中的diff实现")],-1),I=(0,e._)("h2",{id:"vue对象劫持",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#vue对象劫持","aria-hidden":"true"},"#"),(0,e.Uk)(" vue对象劫持")],-1),R=(0,e._)("ol",null,[(0,e._)("li",null,"使用构造函数来写vue，因为这种方式可以分多个文件来给Vue类添加方法，结构清晰明了"),(0,e._)("li",null,"_init(options)初始化--\x3einitState(vm) MVVM数据重新初始化--\x3einitData 重新初始化data--\x3eobserve(data) 观察数据--\x3enew Observer()--\x3ethis.walk--\x3edefineReactive--\x3eObject.defineProperty()(注意此时要对value observe(value)进行递归观察，set中也要对更新的值递归观察)"),(0,e._)("li",null,"去掉取值时vm._data.msg的data(vm._data为之前的观察数据)：initData--\x3eproxy(vm,'_data',key) （vm上的数据代理为vm_data上的数据）--\x3eObject.defineProperty()--\x3ereturn vm['_data'][key] vm['_data'][key]=newValue")],-1),T=(0,e._)("h2",{id:"数组劫持",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#数组劫持","aria-hidden":"true"},"#"),(0,e.Uk)(" 数组劫持")],-1),M=(0,e._)("ol",null,[(0,e._)("li",null,"以上代码数组的增删，set无法观察到。需要对原生的方法进行劫持"),(0,e._)("li",null,"Observer--\x3eisArray--\x3eObject.create()新建对象复制原数组方法--\x3e给复制的方法赋值一个函数，函数中调用老的方法(函数劫持，切片编程)。data的__proto__指向新对象。"),(0,e._)("li",null,"数组中添加了对象：observerArray(inserted) 对数组观测 --\x3eobserve(inserted[i]) 对添加的每一个成员观测"),(0,e._)("li",null,"数组劫持观测数据两个缺点：[0,1,2]直接改变索引下不能被监测到，[1,2,3].length--,长度变化不会监测到"),(0,e._)("li",null,"数组劫持可以监测到：数组里的对象可以监测，push/splice/unshift可以监测")],-1),O=(0,e._)("h2",{id:"编译文本",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#编译文本","aria-hidden":"true"},"#"),(0,e.Uk)(" 编译文本")],-1),P=(0,e._)("ol",null,[(0,e._)("li",null,"_init(options)初始化--\x3evm.$mount()--\x3edocument.querySelector拿到组件--\x3enew Watcher(vm,updateComponent())--\x3e_update()--\x3edocument.createDocumentFragment()(操作文档碎片，减少真实dom的操作导致的渲染)--\x3enode.appendChild(firstChild)将真实dom移动到文档碎片中（vue1.0的做法）"),(0,e._)("li",null,"compiler--\x3e文本节点：compilerText--\x3ereplace--\x3e（reduce迭代data.school.name获得value）"),(0,e._)("li",null,"compiler--\x3e元素节点：compiler()"),(0,e._)("li",null,"编译完后放回真实dom中 el.appendChild(node)")],-1),H=(0,e._)("h2",{id:"依赖收集",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#依赖收集","aria-hidden":"true"},"#"),(0,e.Uk)(" 依赖收集")],-1),W=(0,e._)("p",null,"使用Dep类来收集依赖，收集一个个watcher，需要更新时再把watcher全部执行",-1),q=(0,e._)("ol",null,[(0,e._)("li",null,"vm.$mount()--\x3enew Watcher(vm,updateComponent())"),(0,e._)("li",null,"this.get()--\x3epushTarget(this) target指向当前watch"),(0,e._)("li",null,"this.getter.call(this.vm)--\x3evm._update(vm._render())--\x3e调用当前属性的get方法--\x3edep.addSub(watcher)"),(0,e._)("li",null,"修改数据后--\x3eset()--\x3edep.notify()--\x3ethis.subs.forEach(watcher=>watcher.update())=>update--\x3ethis.get()--\x3e重新渲染"),(0,e._)("li",null,"popTarget() target置为空"),(0,e._)("li",null,"?????? 同一个data如果调用多次会有多个watcher，会更新时多次渲染：defineReactive--\x3eget()--\x3edep.depend()(让dep中可以存watcher,watcher中可以存dep,实现多对多的关系)--\x3eDep.target.addDep(this)--\x3e ？？？？")],-1),F=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" id"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("dep"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("id"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token operator"},"!"),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("depsId"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"has"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("id"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("depsId"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("id"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("deps"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"push"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("dep"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e._)("span",{class:"token comment"},"// 让watcher记住当前的dep"),(0,e.Uk)("\n  dep"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"addSub"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br")])],-1),N=(0,e._)("h2",{id:"异步批量更新",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#异步批量更新","aria-hidden":"true"},"#"),(0,e.Uk)(" 异步批量更新")],-1),J=(0,e._)("p",null,"nextTick实现原理：",-1),Q=(0,e._)("ol",null,[(0,e._)("li",null,[(0,e._)("p",null,"短时间内多次给一个data赋值，会多次渲染更新，影响性能，需要批量更新。如果立即调用get，会导致页面刷新，需要异步来更新：new Watcher--\x3eupdate--\x3equeueWatcher(this)--\x3e批量更新的都是同一个watcher，所以对重复的watcher进行过滤操作--\x3equeue.push(watcher)--\x3e实现异步更新 nextTick(flushQueue)--\x3eflushQueue 更新 --\x3equeue.forEach(watcher=>watcher.run())")]),(0,e._)("li",null,[(0,e._)("p",null,"nextTick->先使用异步微任务(promise没有再使用 mutationObserver)没有再使用异步宏任务(setImmediate没有再使用setTimeout)")])],-1),B=(0,e._)("h2",{id:"数组的依赖收集更新",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#数组的依赖收集更新","aria-hidden":"true"},"#"),(0,e.Uk)(" 数组的依赖收集更新？？")],-1),G=(0,e._)("ol",null,[(0,e._)("li",null,"对象数组是可以依赖收集的，但是push/unshift/splice不能收集依赖"),(0,e._)("li",null,"Observer--\x3ethis.dep=new Dep()--\x3eisArray")],-1),Y=(0,e._)("h2",{id:"watch",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#watch","aria-hidden":"true"},"#"),(0,e.Uk)(" watch??")],-1),K=(0,e._)("ol",null,[(0,e._)("li",null,"initState--\x3einitWatch(vm)--\x3ecreateWatcher(vm,key,handler)--\x3ereturn vm.$watch(key,handler)"),(0,e._)("li",null,"this.$watch的实现 Vue.prototype.$watch(expr,$watch)--\x3enew Watcher(vm,expr,handler,{user:true}) 叫用户watcher--\x3ethis.value=this.get() 取老值--\x3erun之后拿到更新后的值 let value=this.get()--\x3e如果新值和老值不一样，就调用回调函数")],-1),X=(0,e._)("h2",{id:"computed",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#computed","aria-hidden":"true"},"#"),(0,e.Uk)(" computed")],-1),Z=(0,e._)("ol",null,[(0,e._)("li",null,"initState--\x3einitComputed(vm,opts.computed)--\x3ewatcher=vm._watchersComputed=Object.create(null) 创建一个对象存储计算属性的watcher对象,并将计算属性的配置放到vm上"),(0,e._)("li",null,"new Watcher(vm,userDef,()=>{},{lazy:true}) 创建计算属性watcher,lazy dirty都配置true--\x3ethis.value=this.lazy?undefined:this.get() 默认值是undefined"),(0,e._)("li",null,"Object.defineProperty(vm,key,{get:createComputedGetter(vm,key)}) 当用户在取值模板上写了表达式之后，取值时就会走到这个表达式里--\x3e如果有watcher,有计算属性，--\x3edirty是true--\x3ewatcher.evaluate() 求值--\x3ethis.get()--\x3epushTarget(this) 把计算属性watcher放入watcher栈，所以现在栈中有一个渲染watcher和一个计算属性watcher,Dep.target是栈中最后一个即计算属性watcher--\x3ethis.getter.call(this.vm)执行计算属性方法，--\x3e栈中计算属性watcher pop出去，Dep.target为渲染watcher,Dep.target有值得时候，两个属性会都收集渲染watcher，所以数据变化后，会先执行计算属性watcher,再执行渲染watcher watcher.depend()--\x3ethis.deps[i].depend()--\x3ewatcher--\x3edirty=false 值求过了，下次渲染不用求了"),(0,e._)("li",null,"值有变化时--\x3ewatcher.js update()--\x3edirty=true 计算属性依赖的值变化了 稍后取值时重新计算"),(0,e._)("li",null,"watcher.update--\x3eif(this.lazy){this.dirty=false} 会在页面重新取值，但不重新渲染，需要再加一个渲染watcher"),(0,e._)("li",null,"observe--\x3eif(watcher)--\x3eif(Dep.target){watcher.depend()} 如果有计算属性watcher,就在两个dep里分别存入渲染watcher"),(0,e._)("li",null,"watcher.js--\x3edepend(){let deps=this.deps.length}--\x3ethis.deps[i].depend()")],-1),nn=(0,e._)("h2",{id:"虚拟dom和初次渲染-子节点比较",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#虚拟dom和初次渲染-子节点比较","aria-hidden":"true"},"#"),(0,e.Uk)(" 虚拟dom和初次渲染，子节点比较")],-1),sn=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("h"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("render"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("patch"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./vdom'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// h=>createElement 用于来创建元素的方法 返回值是一个虚拟dom"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// render 将虚拟dom渲染成真实节点，并放到某个容器中"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// patch 比对两个虚拟节点 并且用新的节点去更新老的节点"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" oldVnode"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"h"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'div'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("id"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'container'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token function"},"h"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'span'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("style"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("color"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'red'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("background"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'yellow'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'hello'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token string"},"'zf'"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" container"),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("document"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"getElementById"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'app'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"render"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("oldVnode"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("container"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" newVnode"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token function"},"h"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'div'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("id"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'aa'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token function"},"h"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'span'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("style"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("color"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'green'"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'world'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token string"},"'px'"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"setTimeout"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 新节点和老节点对比，更新真实dom元素"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token function"},"patch"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("oldVnode"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("newVnode"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token number"},"1000"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br")])],-1),an=(0,e._)("ul",null,[(0,e._)("li",null,"vue2.0使用虚拟dom实现编译"),(0,e._)("li",null,[(0,e.Uk)("操作文档碎片性能低，所以自己构建虚拟dom节点对象来编译。 "),(0,e._)("ol",null,[(0,e._)("li",null,"虚拟dom内容比实际dom内容少得多。"),(0,e._)("li",null,"虚拟dom可以实现dom之前和之后的比对，减少更新，不用直接替换")])])],-1),en=(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"返回的虚拟dom对象"),(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  tag"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'div'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  props"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  children"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    tag"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token keyword"},"undefined"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    props"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token keyword"},"undefined"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    children"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token keyword"},"undefined"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    text"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'hello'"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token operator"},"<"),(0,e.Uk)("div"),(0,e._)("span",{class:"token operator"},">"),(0,e.Uk)("hello"),(0,e._)("span",{class:"token operator"},"<"),(0,e._)("span",{class:"token operator"},"/"),(0,e.Uk)("div"),(0,e._)("span",{class:"token operator"},">"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Vue"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token function"},"render"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"h"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"h"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'div'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'hello'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br")])]),(0,e._)("ol",null,[(0,e._)("li",null,"h(tag,props,...children)--\x3ereturn vnode(tag,props,key,children)--\x3ereturn vnode对象"),(0,e._)("li",null,"将vnode渲染成真实dom挂在到页面上。返回渲染完的dom")]),(0,e._)("ul",null,[(0,e._)("li",null,"render(vnode,container)--\x3evnode.el=createElm(vnode)--\x3eupdateProperties()--\x3estyle老的有，新的没有，el.style[key]=''。props老的里有，新的里没有，delete el[key]--\x3e属性是style，el.style[stylename]=newProps.style[stylename]--\x3e都不是 el[key]=newProps[key]--\x3edocument.createElement/document.createTextNode(text)"),(0,e._)("li",null,"appendChild"),(0,e._)("li",null,"return el")]),(0,e._)("ol",{start:"3"},[(0,e._)("li",null,"patch(oldVnode,newVnode) 比较新旧虚拟节点 并尽量少地渲染新节点更新页面 返回新dom元素"),(0,e._)("li",null,[(0,e.Uk)("标签不一样直接替换成新节点 oldVnode.el.parentNode.replaceChild(createEle(newVnode),oldVnode) "),(0,e._)("ol",null,[(0,e._)("li",null,"标签一样，当前标签是undefined，内容不一样，就文本内容替换 oldVnode.el.textContent=newVnode.test"),(0,e._)("li",null,"标签一样，属性不一样 let el=newVnode.el=oldVnode.el 复用--\x3eupdateProperties(newVnode,oldVnode.props) 做属性的比对"),(0,e._)("li",null,[(0,e.Uk)("比较children "),(0,e._)("ol",null,[(0,e._)("li",null,[(0,e.Uk)("老的有孩子 新的有孩子 "),(0,e._)("ol",null,[(0,e._)("li",null,[(0,e.Uk)("updateChildren(el,oldChildren,newChildren) while(oldStartIndex<=oldEndIndex&&newStartIndex<=newEndIndex)--\x3e "),(0,e._)("ol",null,[(0,e._)("li",null,[(0,e.Uk)("添加元素、删除元素 "),(0,e._)("ol",null,[(0,e._)("li",null,"从后面添加元素 四个指针，前面的指针一起往后退，判断是否一样，一样就往后退一个，直到老的头指针到结尾了，就把新增的这一段添加到新节点中去，或者把旧的一段删除 isSameVNode(oldStartVnode,newStartVnode)--\x3ereturn (oldVnode.tag===newVnode.tag)&&(oldVnode.key===newVnode.key)--\x3epatch(oldStartVnode,newStartVnode) 用新的属性更新老的属性--\x3eoldStartVnode=oldChildren[++oldStartIndex] --\x3enewStartVnode=newChildren[++newStartIndex] 让指针后移并且Vnode赋为现在的值 --\x3enewStartIndex<=newEndIndex 添加的情况--\x3eparent.appendChild(createElm(newChildren[i])) 把新的剩下的放进旧的 --\x3e 删除的情况"),(0,e._)("li",null,"从前面添加元素 使用尾指针重复以上步骤，插入插在头部 insertBefore(插入的元素，参考位置节点)")])]),(0,e._)("li",null,[(0,e.Uk)("排列正序、排列倒序 "),(0,e._)("ol",null,[(0,e._)("li",null,"倒序：拿老的头指针和新的尾指针比较，如果相同就把老的第一个元素移到老的尾指针后面"),(0,e._)("li",null,"正序：拿老的尾指针和新的头指针比较，如果相同就把老的最后一个元素移到老的头指针前面")])])])])])]),(0,e._)("li",null,[(0,e.Uk)("老的有孩子 新的没孩子 "),(0,e._)("ol",null,[(0,e._)("li",null,"el.innerHTML=''")])]),(0,e._)("li",null,[(0,e.Uk)("老的没孩子 新的有孩子 "),(0,e._)("ol",null,[(0,e._)("li",null,"let child=newChildren[i]"),(0,e._)("li",null,"el.appendChild(createElm(child)) 将新的儿子放入老节点中")])])])])])])]),(0,e._)("div",{class:"custom-container tip"},[(0,e._)("p",{class:"custom-container-title"},"为什么不能使用索引作为key"),(0,e._)("p",null,"比如倒序的情况abcd变成dcba，最佳情况是abc移动三次即可完成更新。如果使用索引，abcd四个位置不变，但内容全部要更新，渲染四次（创建新节点并替换）。移动三次比渲染四次性能高太多。")])],-1),tn=(0,e._)("h2",{id:"虚拟dom融合vue代码",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#虚拟dom融合vue代码","aria-hidden":"true"},"#"),(0,e.Uk)(" 虚拟dom融合vue代码")],-1),ln=(0,e._)("p",null,"vm.$mount()--\x3evm._update(vm._render())--\x3elet render=vm.$options.render 获取用户写的render方法--\x3elet vnode=render.call(vm,h) return vnode 执行用户的render方法 返回vnode vm._update(vnode)--\x3e初次渲染 vm.$el=render(vnode,el)--\x3e更新操作 let $el=patch(preVnode,vnode)",-1),on=(0,e._)("h2",{id:"vue源码剖析",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#vue源码剖析","aria-hidden":"true"},"#"),(0,e.Uk)(),(0,e._)("code",null,"Vue"),(0,e.Uk)("源码剖析")],-1),cn=(0,e._)("h3",{id:"一-目录源码剖析",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#一-目录源码剖析","aria-hidden":"true"},"#"),(0,e.Uk)(" 一.目录源码剖析")],-1),pn=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"compiler"),(0,e.Uk)("(编译模块) 将模板"),(0,e._)("code",null,"template"),(0,e.Uk)("转化成"),(0,e._)("code",null,"render"),(0,e.Uk)("函数")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"core"),(0,e.Uk)(" (核心模块 )")]),(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"components"),(0,e.Uk)(" 内置的组件")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"global-api"),(0,e.Uk)(" 全局的"),(0,e._)("code",null,"api")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"instance"),(0,e.Uk)(),(0,e._)("code",null,"Vue"),(0,e.Uk)("实例相关的核心逻辑")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"observer"),(0,e.Uk)(),(0,e._)("code",null,"Vue"),(0,e.Uk)("中"),(0,e._)("code",null,"MVVM"),(0,e.Uk)("响应式数据原理")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"util"),(0,e.Uk)("核心模块中的工具方法")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"vdom"),(0,e.Uk)(" 虚拟"),(0,e._)("code",null,"dom"),(0,e.Uk)("模块")])])])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"platform"),(0,e.Uk)("(平台模块) 通过不同入口编译出不同的"),(0,e._)("code",null,"vue.js")]),(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("code",null,"web"),(0,e.Uk)(" 浏览器中使用的"),(0,e._)("code",null,"vue")]),(0,e._)("li",null,[(0,e._)("code",null,"weex "),(0,e.Uk)(),(0,e._)("code",null,"weex"),(0,e.Uk)(" 基于"),(0,e._)("code",null,"vue"),(0,e.Uk)("的移动端跨平台"),(0,e._)("code",null," ui")])])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"server"),(0,e.Uk)(" 服务端渲染相关代码")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"sfc"),(0,e.Uk)(" 将"),(0,e._)("code",null,".vue"),(0,e.Uk)(" 文件编译成对象")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"shared"),(0,e.Uk)(" 所有模块中共享的方法")])])],-1),un=(0,e._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,e._)("pre",{class:"language-text"},[(0,e._)("code",null,"src\n├── compiler        # 编译模块 \n├── core            # 核心模块 \n├── platforms       # 平台模块\n├── server          # 服务端渲染\n├── sfc             # .vue 文件编译成对象\n├── shared          # 所有模块中的共享代码\n")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br")])],-1),_n=(0,e._)("h4",{id:"compiler",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#compiler","aria-hidden":"true"},"#"),(0,e.Uk)(" compiler")],-1),kn=(0,e._)("p",null,"compiler 目录包含 Vue.js 所有编译相关的代码。它包括把模板解析成 ast 语法树，ast 语法树优化，代码生成等功能。",-1),rn=(0,e._)("p",null,"编译的工作可以在构建时做（借助 webpack、vue-loader 等辅助插件）；也可以在运行时做，使用包含构建功能的 Vue.js。显然，编译是一项耗性能的工作，所以更推荐前者——离线编译。",-1),dn=(0,e._)("h4",{id:"core",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#core","aria-hidden":"true"},"#"),(0,e.Uk)(" core")],-1),Un=(0,e._)("p",null,"core 目录包含了 Vue.js 的核心代码，包括内置组件、全局 API 封装，Vue 实例化、观察者、虚拟 DOM、工具函数等等。",-1),bn=(0,e._)("h4",{id:"platform",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#platform","aria-hidden":"true"},"#"),(0,e.Uk)(" platform")],-1),mn=(0,e._)("p",null,"Vue.js 是一个跨平台的 MVVM 框架，它可以跑在 web 上，也可以配合 weex 跑在 native 客户端上。platform 是 Vue.js 的入口，2 个目录代表 2 个主要入口，分别打包成运行在 web 上和 weex 上的 Vue.js。",-1),hn=(0,e._)("h4",{id:"server",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#server","aria-hidden":"true"},"#"),(0,e.Uk)(" server")],-1),gn=(0,e._)("p",null,"Vue.js 2.0 支持了服务端渲染，所有服务端渲染相关的逻辑都在这个目录下。注意：这部分代码是跑在服务端的 Node.js，不要和跑在浏览器端的 Vue.js 混为一谈。",-1),vn=(0,e._)("p",null,'服务端渲染主要的工作是把组件渲染为服务器端的 HTML 字符串，将它们直接发送到浏览器，最后将静态标记"混合"为客户端上完全交互的应用程序。',-1),wn=(0,e._)("h4",{id:"sfc",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#sfc","aria-hidden":"true"},"#"),(0,e.Uk)(" sfc")],-1),fn=(0,e._)("p",null,"通常我们开发 Vue.js 都会借助 webpack 构建， 然后通过 .vue 单文件来编写组件。",-1),yn=(0,e._)("p",null,"这个目录下的代码逻辑会把 .vue 文件内容解析成一个 JavaScript 的对象。",-1),xn=(0,e._)("h4",{id:"shared",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#shared","aria-hidden":"true"},"#"),(0,e.Uk)(" shared")],-1),jn=(0,e._)("p",null,"Vue.js 会定义一些工具方法，这里定义的工具方法都是会被浏览器端的 Vue.js 和服务端的 Vue.js 所共享的。",-1),Vn=(0,e._)("h3",{id:"二-如何看vue源代码",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#二-如何看vue源代码","aria-hidden":"true"},"#"),(0,e.Uk)(" 二.如何看"),(0,e._)("code",null,"Vue"),(0,e.Uk)("源代码")],-1),Cn=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("通过"),(0,e._)("code",null,"package.json"),(0,e.Uk)("来看项目入口 "),(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("code",null,"main"),(0,e.Uk)(" 默认引入包会查找"),(0,e._)("code",null,"main"),(0,e.Uk)("对应的文件(require引入)")]),(0,e._)("li",null,[(0,e._)("code",null,"module"),(0,e.Uk)(" 如果使用"),(0,e._)("code",null,"webpack"),(0,e.Uk)("默认会以"),(0,e._)("code",null,"module"),(0,e.Uk)("对应的文件为入口(import引入)")])])])],-1),zn=(0,e._)("blockquote",null,[(0,e._)("p",null,[(0,e.Uk)("打包出的结果会放到"),(0,e._)("code",null,"dist"),(0,e.Uk)("目录下，我们需要查找打包的命令在哪里?")])],-1),Sn=(0,e._)("p",null,[(0,e.Uk)("通过"),(0,e._)("code",null,"scripts"),(0,e.Uk)("的脚本来进行打包,找到"),(0,e._)("code",null,"build"),(0,e.Uk)("的相关字段")],-1),Ln=(0,e._)("div",{class:"language-bash ext-sh line-numbers-mode"},[(0,e._)("pre",{class:"language-bash"},[(0,e._)("code",null,[(0,e._)("span",{class:"token string"},'"build"'),(0,e._)("span",{class:"token builtin class-name"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"node scripts/build.js"'),(0,e.Uk)(" \n"),(0,e._)("span",{class:"token string"},'"build:ssr"'),(0,e._)("span",{class:"token builtin class-name"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"npm run build -- web-runtime-cjs,web-server-renderer"'),(0,e.Uk)("\n"),(0,e._)("span",{class:"token string"},'"build:weex"'),(0,e._)("span",{class:"token builtin class-name"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'"npm run build -- weex"'),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br")])],-1),En=(0,e._)("p",null,[(0,e.Uk)("核心打包执行的文件是"),(0,e._)("code",null,"build.js")],-1),Dn=(0,e._)("p",null,[(0,e._)("strong",null,"打包的模块类型")],-1),$n=(0,e._)("p",null,[(0,e.Uk)("模块的区别:"),(0,e._)("code",null,"cjs"),(0,e.Uk)("("),(0,e._)("code",null,"commonjs"),(0,e.Uk)("规范) 、"),(0,e._)("code",null,"es"),(0,e.Uk)("("),(0,e._)("code",null,"es6Module"),(0,e.Uk)(")、"),(0,e._)("code",null,"umd"),(0,e.Uk)(" ("),(0,e._)("code",null,"Universal Module Definition"),(0,e.Uk)(" ) （包含"),(0,e._)("code",null,"AMD"),(0,e.Uk)("、"),(0,e._)("code",null,"cmd"),(0,e.Uk)("、"),(0,e._)("code",null,"CommonJs"),(0,e.Uk)("）")],-1),An=(0,e._)("p",null,[(0,e._)("strong",null,"分析打包流程"),(0,e.Uk)("：")],-1),In=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("1.先查看"),(0,e._)("code",null,"dist"),(0,e.Uk)("目录是否存在,如果不存在就创建此目录")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("2.根据自己的配置生成"),(0,e._)("code",null,"rollup"),(0,e.Uk)("的配置")])]),(0,e._)("li",null,[(0,e._)("p",null,"3.根据用户打包时传递的参数过滤配置")]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("4.进行打包"),(0,e._)("code",null,"roolup.rollup(config)"),(0,e.Uk)(),(0,e._)("code",null,"入口在src-platforms-web-entry-runtime"),(0,e.Uk)(",并且生成打包后的结果写入到目录中"),(0,e._)("code",null,"write")])])],-1),Rn=(0,e._)("p",null,[(0,e._)("code",null,"Vue"),(0,e.Uk)("的两种模式:"),(0,e._)("code",null,"Runtime-Only"),(0,e.Uk)(" 不能在运行时编译模板只支持用户编写"),(0,e._)("code",null,"render function"),(0,e.Uk)(","),(0,e._)("code",null,"Runtime-with-Compiler"),(0,e.Uk)("运行时可以编译模板文件体积大。")],-1),Tn=(0,e._)("p",null,[(0,e._)("strong",null,[(0,e.Uk)("找到"),(0,e._)("code",null,"Vue"),(0,e.Uk)("的入口")]),(0,e.Uk)(":")],-1),Mn=(0,e._)("p",null,[(0,e.Uk)("以"),(0,e._)("code",null,"Runtime-with-Compiler"),(0,e.Uk)("为入口 找到,"),(0,e._)("code",null,"platform/web/entry-runtime-with-compiler")],-1),On=(0,e._)("p",null,"分析入口查找:",-1),Pn=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("1.先找到"),(0,e._)("code",null,"entry-runtime-with-compliler"),(0,e.Uk)(",重写"),(0,e._)("code",null,"$mount"),(0,e.Uk)("方法")]),(0,e._)("li",null,[(0,e.Uk)("2.找到"),(0,e._)("code",null,"runtime/index"),(0,e.Uk)(" 主要包含"),(0,e._)("code",null,"$mount"),(0,e.Uk)("核心方法 ("),(0,e._)("code",null,"__patch__"),(0,e.Uk)("方法")]),(0,e._)("li",null,[(0,e.Uk)("3."),(0,e._)("code",null,"core/index"),(0,e.Uk)("在"),(0,e._)("code",null,"Vue"),(0,e.Uk)("的构造函数增加全局"),(0,e._)("code",null,"api")]),(0,e._)("li",null,[(0,e.Uk)("4."),(0,e._)("code",null,"instance/index"),(0,e.Uk)("找到"),(0,e._)("code",null,"Vue"),(0,e.Uk)("的构造函数,给"),(0,e._)("code",null,"Vue"),(0,e.Uk)("构造函数增加多个原型方法")])],-1),Hn=(0,e._)("p",null,[(0,e._)("img",{src:t,alt:""})],-1),Wn=(0,e._)("h3",{id:"三-vue的初始化工作",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#三-vue的初始化工作","aria-hidden":"true"},"#"),(0,e.Uk)(" 三."),(0,e._)("code",null,"Vue"),(0,e.Uk)("的初始化工作")],-1),qn=(0,e._)("p",null,[(0,e.Uk)("通过"),(0,e._)("code",null,"demo"),(0,e.Uk)("来找到真实引入的"),(0,e._)("code",null,"Vue.js"),(0,e.Uk)("文件 "),(0,e._)("code",null,"vue/dist/vue.esm.js")],-1),Fn=(0,e._)("p",null,[(0,e._)("strong",null,"分析初始化过程"),(0,e.Uk)(":")],-1),Nn=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("1."),(0,e._)("code",null,"new Vue"),(0,e.Uk)("时会调用"),(0,e._)("code",null,"_init"),(0,e.Uk)("方法")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("2.增加了"),(0,e._)("code",null,"_uid"),(0,e.Uk)("给每个实例增加唯一标识")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("3.将用户的所有属性挂载到"),(0,e._)("code",null,"vm.$options"),(0,e.Uk)("上")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("4.初始化状态 "),(0,e._)("code",null,"initState()"),(0,e.Uk)("将用户传递的属性挂载到"),(0,e._)("code",null,"vm._data"),(0,e.Uk)(" 上并且代理到"),(0,e._)("code",null,"vue"),(0,e.Uk)("的实例上")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("5.如果有"),(0,e._)("code",null,"el"),(0,e.Uk)("属性就进行挂载,并且调用"),(0,e._)("code",null,"$mount"),(0,e.Uk)("方法")])])],-1),Jn=(0,e._)("p",null,[(0,e._)("strong",null,"分析挂载流程"),(0,e.Uk)(":")],-1),Qn=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("1.如果用户使用"),(0,e._)("code",null,"runtime-with-compiler"),(0,e.Uk)("会调用他内部的"),(0,e._)("code",null,"$mount"),(0,e.Uk)("方法")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("2.先判断是否有"),(0,e._)("code",null,"render"),(0,e.Uk)("方法,如果没有"),(0,e._)("code",null,"render"),(0,e.Uk)("会查找"),(0,e._)("code",null,"template"),(0,e.Uk)("并且将"),(0,e._)("code",null,"template"),(0,e.Uk)("变成"),(0,e._)("code",null,"render"),(0,e.Uk)("方法,如果没有"),(0,e._)("code",null,"template"),(0,e.Uk)("默认会使用"),(0,e._)("code",null,"el"),(0,e.Uk)("指定的"),(0,e._)("code",null,"dom"),(0,e.Uk)("元素")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("3.调用"),(0,e._)("code",null,"runtime/index"),(0,e.Uk)("中的"),(0,e._)("code",null,"$mount"),(0,e.Uk)("方法,内部会统一处理调用"),(0,e._)("code",null,"mountComponent")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("4.会校验"),(0,e._)("code",null,"render"),(0,e.Uk)("方法的存在,并且会将当前的真实"),(0,e._)("code",null,"dom"),(0,e.Uk)("挂载到"),(0,e._)("code",null,"vm.$el")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("5.生成"),(0,e._)("code",null,"updateComponent"),(0,e.Uk)("方法,并且初始化渲染"),(0,e._)("code",null,"watcher"),(0,e.Uk)(",内部会立刻调用"),(0,e._)("code",null,"updateComponent"),(0,e.Uk)("方法")]),(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("vm"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"_update"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("vm"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"_render"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" hydrating"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("6."),(0,e._)("code",null,"vm._render"),(0,e.Uk)("作用是返回"),(0,e._)("code",null,"vnode"),(0,e.Uk)(" 内部会调用解析好的"),(0,e._)("code",null,"render"),(0,e.Uk)("方法("),(0,e._)("code",null,"vm._renderProxy"),(0,e.Uk)(" 和 "),(0,e._)("code",null,"vm.$createElement"),(0,e.Uk)(")")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e._)("code",null,"vm.$createElement"),(0,e.Uk)(" => "),(0,e._)("code",null,"vdom/create-element"),(0,e.Uk)(" => "),(0,e._)("code",null,"_createElement"),(0,e.Uk)(" =>"),(0,e._)("code",null," vnode")])]),(0,e._)("li",null,[(0,e._)("p",null,[(0,e.Uk)("7."),(0,e._)("code",null,"vm._update"),(0,e.Uk)(" 将"),(0,e._)("code",null,"vnode"),(0,e.Uk)(" 渲染成真实的"),(0,e._)("code",null,"dom"),(0,e.Uk)("元素")]),(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("code",null,"vm.__patch__"),(0,e.Uk)(" 默认会调用 "),(0,e._)("code",null,"vdom/patch方法")]),(0,e._)("li",null,[(0,e._)("code",null,"patch"),(0,e.Uk)("方法会根据"),(0,e._)("code",null,"vm.$el"),(0,e.Uk)("创建虚拟节点和新的节点,映射虚拟节点和新节点的关系")]),(0,e._)("li",null,[(0,e.Uk)("递归创建子元素，将子元素插入到新的节点中。最终将新的节点插入到"),(0,e._)("code",null,"vm.$el"),(0,e.Uk)("的后面")]),(0,e._)("li",null,[(0,e.Uk)("删除掉"),(0,e._)("code",null,"vm.$el"),(0,e.Uk)("对应的节点")])])])],-1),Bn=(0,e._)("h3",{id:"四-数据响应式原理",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#四-数据响应式原理","aria-hidden":"true"},"#"),(0,e.Uk)(" 四.数据响应式原理")],-1),Gn=(0,e._)("p",null,[(0,e.Uk)("将"),(0,e._)("code",null,"data"),(0,e.Uk)("对应的数据转化成采用"),(0,e._)("code",null,"Object.defineProperty"),(0,e.Uk)("来定义")],-1),Yn=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("1.会执行"),(0,e._)("code",null,"initState"),(0,e.Uk)("方法 => "),(0,e._)("code",null,"initData"),(0,e.Uk)(" => "),(0,e._)("code",null,"observe")]),(0,e._)("li",null,[(0,e.Uk)("2."),(0,e._)("code",null,"new Observer"),(0,e.Uk)(" 收到要观察的数据 => "),(0,e._)("code",null,"this.walk"),(0,e.Uk)(" => "),(0,e._)("code",null,"defineReactive"),(0,e.Uk)(" => 如果观察对象的值是一个对象的话，会递归观察=> 采用"),(0,e._)("code",null,"Object.defineProperty"),(0,e.Uk)(" 来重新定义属性")]),(0,e._)("li",null,[(0,e.Uk)("3.默认会先初始化"),(0,e._)("code",null,"Watcher"),(0,e.Uk)("实例，将此实例放到"),(0,e._)("code",null,"Dep.target"),(0,e.Uk)("上，并且给每一个属性增加一个"),(0,e._)("code",null,"dep"),(0,e.Uk)("属性,此"),(0,e._)("code",null,"dep"),(0,e.Uk)("会将当前的"),(0,e._)("code",null,"Dep.target"),(0,e.Uk)("存起来。")]),(0,e._)("li",null,[(0,e.Uk)("4.每次更新值都会通知对应"),(0,e._)("code",null,"dep"),(0,e.Uk)("中存放的"),(0,e._)("code",null,"watcher"),(0,e.Uk)(" 让他们调用update方法最终会将要执行的"),(0,e._)("code",null,"watcher"),(0,e.Uk)("放到"),(0,e._)("code",null,"queue"),(0,e.Uk)("中，最后调用"),(0,e._)("code",null,"nextTick(flushSchedulerQueue)"),(0,e.Uk)("方法清空队列,让视图更新")])],-1),Kn=(0,e._)("h3",{id:"五-计算属性的实现",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#五-计算属性的实现","aria-hidden":"true"},"#"),(0,e.Uk)(" 五.计算属性的实现")],-1),Xn=(0,e._)("p",null,[(0,e.Uk)("默认会创建一个计算属性"),(0,e._)("code",null,"watcher"),(0,e.Uk)("，当取值时会调用用户定义的计算属性方法,会对依赖的属性取值，此时依赖的属性会将计算属性的"),(0,e._)("code",null,"watcher"),(0,e.Uk)("收集起来,最后计算属性"),(0,e._)("code",null,"watcher"),(0,e.Uk)("会将渲染"),(0,e._)("code",null,"watcher"),(0,e.Uk)("放到对应的每个属性的"),(0,e._)("code",null,"dep"),(0,e.Uk)("中, 属性变化时会依次执行计算属性"),(0,e._)("code",null,"watcher"),(0,e.Uk)("和渲染"),(0,e._)("code",null,"watcher")],-1),Zn=(0,e._)("h3",{id:"六-watch的实现原理",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#六-watch的实现原理","aria-hidden":"true"},"#"),(0,e.Uk)(" 六."),(0,e._)("code",null,"Watch"),(0,e.Uk)("的实现原理")],-1),ns=(0,e._)("p",null,[(0,e.Uk)("内部调用"),(0,e._)("code",null,"vm.$watch"),(0,e.Uk)(",默认会创建一个"),(0,e._)("code",null,"watcher"),(0,e.Uk)(",会将表达式根据"),(0,e._)("code",null,"."),(0,e.Uk)("分割,去"),(0,e._)("code",null,"vm"),(0,e.Uk)("上取值，取值的过程中会将此"),(0,e._)("code",null,"watcher"),(0,e.Uk)("收集到当前属性的依赖中，属性变化会通知此"),(0,e._)("code",null,"watcher"),(0,e.Uk)("执行")],-1),ss=(0,e._)("h3",{id:"七-dom-diff原理",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#七-dom-diff原理","aria-hidden":"true"},"#"),(0,e.Uk)(" 七."),(0,e._)("code",null,"Dom-Diff"),(0,e.Uk)("原理")],-1),as=(0,e._)("h2",{id:"总结图",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#总结图","aria-hidden":"true"},"#"),(0,e.Uk)(" 总结图")],-1),es=(0,e._)("p",null,[(0,e._)("img",{src:l,alt:"vueSource"})],-1),ts=(0,e._)("h2",{id:"实现broadcast",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#实现broadcast","aria-hidden":"true"},"#"),(0,e.Uk)(" 实现broadcast")],-1),ls=(0,e._)("h2",{id:"组件",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#组件","aria-hidden":"true"},"#"),(0,e.Uk)(" 组件")],-1),os=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e._)("p",null,"表单组件")]),(0,e._)("li",null,[(0,e._)("p",null,"异步组件")]),(0,e._)("li",null,[(0,e._)("p",null,"递归组件")]),(0,e._)("li",null,[(0,e._)("p",null,"弹框组件")])],-1),cs=(0,e._)("h2",{id:"插件原理",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#插件原理","aria-hidden":"true"},"#"),(0,e.Uk)(" 插件原理")],-1),ps=(0,e._)("h3",{id:"vue-lazyload组件实现",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#vue-lazyload组件实现","aria-hidden":"true"},"#"),(0,e.Uk)(" vue-lazyload组件实现")],-1),us=(0,e._)("ul",null,[(0,e._)("li",null,"使用")],-1),_s=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// main.js"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// vue-lazyload 图片懒加载 v-lazy"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(" Vue "),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'vue'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(" VuelazyLoad "),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./vue-lazyload'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(" loading "),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./loading.jpg'"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(" App "),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./App.vue'"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// use方法是一个全局的api 会调用 VuelazyLoad install"),(0,e.Uk)("\nVue"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"use"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("VuelazyLoad"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    preLoad"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"1.3"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 可见区域的1.3倍"),(0,e.Uk)("\n    loading"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// loading图"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// use的默认调用就会执行VuelazyLoad的install方法"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Vue"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    el"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token string"},"'#app'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function-variable function"},"render"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token parameter"},"h"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token function"},"h"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("App"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br")])],-1),ks=(0,e._)("div",{class:"language-vue ext-vue line-numbers-mode"},[(0,e._)("pre",{class:"language-vue"},[(0,e._)("code",null,[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("template")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("div")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"class"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("box"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("li")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"v-for"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("img in imgs"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},":key"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("img"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("img")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"v-lazy"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("img"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("li")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("        \n    "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("div")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("template")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e._)("span",{class:"token script"},[(0,e._)("span",{class:"token language-javascript"},[(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(" axios "),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'axios'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 基于promise async + await"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"data"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("imgs"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n     "),(0,e._)("span",{class:"token function"},"created"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// vue的生命周期是同步执行的"),(0,e.Uk)("\n       axios"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"get"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'http://www.fullstackjavascript.cn:9999/api/img'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"then"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("data"),(0,e._)("span",{class:"token punctuation"},"}")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n\n           "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("imgs "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" data"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n       "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n     "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("script")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("style")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e._)("span",{class:"token style"},[(0,e._)("span",{class:"token language-css"},[(0,e.Uk)("\n"),(0,e._)("span",{class:"token selector"},".box"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"height"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("300px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"overflow"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" scroll"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 200px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token selector"},"img"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token property"},"width"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)(" 100px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token property"},"height"),(0,e._)("span",{class:"token punctuation"},":"),(0,e.Uk)("100px"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("style")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br")])],-1),rs=(0,e._)("p",null,"实现",-1),is=(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Uk)("主要做的就是 "),(0,e._)("ol",null,[(0,e._)("li",null,"监控父亲的滚动事件"),(0,e._)("li",null,"当滚动时候 检测当前的图片是否出现在了可视区域内")])])],-1),ds=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// vue-lazyload/index.js"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"/* eslint-disable */"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(" Lazy "),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./lazy'"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// install 方法中有两个参数 Vue的构造函数"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 希望我们写vue插件的时候 不去依赖vue"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"install"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("Vue"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("options")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"//_Vue = Vue; // 为了保证和当前用户使用的Vue构造函数是同一个"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// vue-lazyload 主要就是提供一个指令"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// 1) 可能注册一些全局组件 2） 给vue的原型的扩展属性  3) 可以赋予一些全局指令和过滤器"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" LazyClass "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"Lazy"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("Vue"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token class-name"},"LazyClass"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("test"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token string"},"'xx'"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" lazy "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"LazyClass"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("options"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"debugger"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        Vue"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"directive"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'lazy'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 只要绑定就回调用"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token comment"},"// 保证当前add方法执行的时候 this永远指向lazy实例"),(0,e.Uk)("\n            bind"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)("lazy"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"bind"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("lazy"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br")])],-1),Us=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// vue-lazyload/lazy.js"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"/* eslint-disable */"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// 存放懒加载功能的文件"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"import"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("throttle"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("debounce"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"from"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'lodash'"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"export"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"default"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"Vue"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"class"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"ReactiveListener"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"constructor"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("el"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("src"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("elRenderer"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("options"),(0,e._)("span",{class:"token punctuation"},"}")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("el "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" el"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("src "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" src"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("elRenderer "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)("elRenderer"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("options "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" options"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("state "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("loading"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"checkInView"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 判断是否渲染"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("top"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("el"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"getBoundingClientRect"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 高度就是图片的位置"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" top "),(0,e._)("span",{class:"token operator"},"<"),(0,e.Uk)(" window"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("innerHeight "),(0,e._)("span",{class:"token operator"},"*"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("options"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("preLoad\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"load"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 加载当前的listener"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token comment"},"// 开始渲染 渲染前 需要默认渲染loading状态"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"elRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'loading'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token function"},"loadImageAsync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("src"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("state"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("loading "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 加载完毕了"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"elRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'loaded'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"elRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token string"},"'error'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 异步加载图片"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(" \n    "),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"loadImageAsync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("src"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("resolve"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("reject")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" image "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Image"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        image"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("src "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" src"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        image"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("onload "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" resolve"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        image"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("onerror "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" reject\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"class"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"LazyClass"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"constructor"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"options"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("options "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" options"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 将用户传入的数据保存到当前的实例上"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("listenerQueue "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("bindHandler "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n            "),(0,e._)("span",{class:"token comment"},"// 在一段时间内 不停的触发方法"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token comment"},"//  防抖(最终触发一次) 节流(默认每隔一段时间执行一次)"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("lazyLoadHandler "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"throttle"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" \n                "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" catIn "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("listenerQueue"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"forEach"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"listener"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("listener"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("state"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("loading"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 如果已经渲染过的图片就不在进行渲染了"),(0,e.Uk)("\n                    catIn "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" listener"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"checkInView"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 判断是否应该渲染"),(0,e.Uk)("\n                    catIn "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" listener"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"load"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 加载对应的listener"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token number"},"500"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("el"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("bindings"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("vnode")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            \n            "),(0,e._)("span",{class:"token comment"},"// addEventListener('scroll')  监控当前图片是否在显示区域的范围"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token comment"},"// 这里获取不到真实的dom"),(0,e.Uk)("\n            Vue"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"nextTick"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token operator"},"=>"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"scrollParent"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" parent "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" el"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("parentNode"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token keyword"},"while"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("parent"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"scroll"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"test"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token function"},"getComputedStyle"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("parent"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'overflow'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                            "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" parent"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n                        parent "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" parent"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("parentNode "),(0,e._)("span",{class:"token comment"},"// 不停的向上找 找带有overflow的属性"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" parent\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" parent "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"scrollParent"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token comment"},"// 我要判断当前这个图片是否要加载"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" src "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" bindings"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("value"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 对应的v-lazy的值"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" listener "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"ReactiveListener"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    el"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 真实的dom"),(0,e.Uk)("\n                    src"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                    elRenderer"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"elRenderer"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"bind"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n                    options"),(0,e._)("span",{class:"token operator"},":"),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("options"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// {默认会看是渲染loading}"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("listenerQueue"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"push"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("listener"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"if"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token operator"},"!"),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("bindHandler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("bindHandler "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                    console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'绑定一次'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n                    parent"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"addEventListener"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'scroll'"),(0,e._)("span",{class:"token punctuation"},","),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("lazyLoadHandler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 滚动时判断"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("   \n               \n                "),(0,e._)("span",{class:"token comment"},"// 默认需要先进行一次判断 "),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"lazyLoadHandler"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"elRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("listener"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("state")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 渲染当前实例的什么状态"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("el"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" listener"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" src "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"''"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"switch"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("state"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"case"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'loading'"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)("\n                    src "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" listener"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("options"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("loading "),(0,e._)("span",{class:"token operator"},"||"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"''"),(0,e.Uk)("\n                    "),(0,e._)("span",{class:"token keyword"},"break"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"case"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'error'"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)("\n                    src "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" listener"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("options"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("error "),(0,e._)("span",{class:"token operator"},"||"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"''"),(0,e.Uk)("\n                "),(0,e._)("span",{class:"token keyword"},"default"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)("\n                    src "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" listener"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("src\n                    "),(0,e._)("span",{class:"token keyword"},"break"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n            el"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"setAttribute"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'src'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("src"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"43"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"44"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"45"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"46"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"47"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"48"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"49"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"50"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"51"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"52"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"53"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"54"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"55"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"56"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"57"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"58"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"59"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"60"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"61"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"62"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"63"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"64"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"65"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"66"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"67"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"68"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"69"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"70"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"71"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"72"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"73"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"74"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"75"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"76"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"77"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"78"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"79"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"80"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"81"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"82"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"83"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"84"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"85"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"86"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"87"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"88"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"89"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"90"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"91"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"92"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"93"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"94"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"95"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"96"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"97"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"98"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"99"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"100"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"101"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"102"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"103"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"104"),(0,e._)("br")])],-1),bs=(0,e._)("h3",{id:"js垃圾收集",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#js垃圾收集","aria-hidden":"true"},"#"),(0,e.Uk)(" JS垃圾收集")],-1),ms=(0,e._)("h4",{id:"简介",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#简介","aria-hidden":"true"},"#"),(0,e.Uk)(" 简介")],-1),hs=(0,e._)("ul",null,[(0,e._)("li",null,"js使用自动内存管理，这被称为“垃圾回收机制”，优点是可以简化开发，节省代码。缺点是无法完整掌握内存的分配和回收过程"),(0,e._)("li",null,[(0,e.Uk)("内存有限制 "),(0,e._)("ul",null,[(0,e._)("li",null,"因为V8垃圾收集工作原理导致，1.4g内存完成一次垃圾收集需要1s以上，暂停期间内，应用性能和响应能力都会下降")])]),(0,e._)("li",null,"JS对象通过V8引擎来分配内存"),(0,e._)("li",null,[(0,e._)("code",null,"process.memoryUsage"),(0,e.Uk)("返回一个对象，包含了Node进程的内存占用信息 "),(0,e._)("ul",null,[(0,e._)("li",null,"rss:所有内存占用，包括指令区和堆栈(代码区域，栈[本地变量和指针，基本类型]，堆[对象，闭包]，堆还分为使用到的堆和未使用的)"),(0,e._)("li",null,"heapTotal:“堆”占用的内存，包括用到的和没用到的"),(0,e._)("li",null,"heapUsed:“堆”用到的内存"),(0,e._)("li",null,"external:V8引擎内部的C++对象占用的内存")])])],-1),gs=(0,e._)("h4",{id:"v8的垃圾回收机制",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#v8的垃圾回收机制","aria-hidden":"true"},"#"),(0,e.Uk)(" V8的垃圾回收机制")],-1),vs=(0,e._)("ul",null,[(0,e._)("li",null,"按存活时间分为新生代和老生代")],-1),ws=(0,e._)("h3",{id:"函数柯里化",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#函数柯里化","aria-hidden":"true"},"#"),(0,e.Uk)(" 函数柯里化")],-1),fs=(0,e._)("p",null,"柯里化，英语：Currying(果然是满满的英译中的既视感)，是把接受多个参数的函数变换成接受一个单一参数（最初函数的第一个参数）的函数，并且返回接受余下的参数而且返回结果的新函数的技术。",-1),ys=(0,e._)("ul",null,[(0,e._)("li",null,"例子")],-1),xs=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// 普通的add函数"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("x"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" y")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" x "),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" y\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"// Currying后"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"curryingAdd"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"x"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"y"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" x "),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" y\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("           "),(0,e._)("span",{class:"token comment"},"// 3"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"curryingAdd"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("   "),(0,e._)("span",{class:"token comment"},"// 3"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br")])],-1),js=(0,e._)("p",null,"实际上就是把add函数的x，y两个参数变成了先用一个函数接收x然后返回一个函数去处理y参数。现在思路应该就比较清晰了，就是只传递给函数一部分参数来调用它，让它返回一个函数去处理剩下的参数。",-1),Vs=(0,e._)("h4",{id:"currying好处",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#currying好处","aria-hidden":"true"},"#"),(0,e.Uk)(" Currying好处")],-1),Cs=(0,e._)("ol",null,[(0,e._)("li",null,"参数复用")],-1),zs=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// 正常正则验证字符串 reg.test(txt)"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"// 函数封装后"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"check"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("reg"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" txt")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" reg"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"test"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("txt"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"check"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\d+"),(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-flags"},"g")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'test'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("       "),(0,e._)("span",{class:"token comment"},"//false"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"check"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"[a-z]+"),(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-flags"},"g")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'test'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("    "),(0,e._)("span",{class:"token comment"},"//true"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"// Currying后"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"curryingCheck"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"reg"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"txt"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" reg"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"test"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("txt"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" hasNumber "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"curryingCheck"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\d+"),(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-flags"},"g")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" hasLetter "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"curryingCheck"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"[a-z]+"),(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-flags"},"g")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"hasNumber"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'test1'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("      "),(0,e._)("span",{class:"token comment"},"// true"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"hasNumber"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'testtest'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("   "),(0,e._)("span",{class:"token comment"},"// false"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"hasLetter"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'21212'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("      "),(0,e._)("span",{class:"token comment"},"// false"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br")])],-1),Ss=(0,e._)("p",null,"上面的示例是一个正则的校验，正常来说直接调用check函数就可以了，但是如果我有很多地方都要校验是否有数字，其实就是需要将第一个参数reg进行复用，这样别的地方就能够直接调用hasNumber，hasLetter等函数，让参数能够复用，调用起来也更方便。",-1),Ls=(0,e._)("ol",{start:"2"},[(0,e._)("li",null,"提前确认")],-1),Es=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"on"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("element"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("document"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("addEventListener"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("element "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" event "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            element"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"addEventListener"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("element "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" event "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            element"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"attachEvent"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'on'"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" on "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("document"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("addEventListener"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("element"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("element "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" event "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                element"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"addEventListener"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("element"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("element "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" event "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n                element"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"attachEvent"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'on'"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"//换一种写法可能比较好理解一点，上面就是把isSupport这个参数给先确定下来了"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"on"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("isSupport"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" element"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    isSupport "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" isSupport "),(0,e._)("span",{class:"token operator"},"||"),(0,e.Uk)(" document"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("addEventListener"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("isSupport"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" element"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"addEventListener"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" element"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"attachEvent"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'on'"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" event"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" handler"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br")])],-1),Ds=(0,e._)("p",null,"我们在做项目的过程中，封装一些dom操作可以说再常见不过，上面第一种写法也是比较常见，但是我们看看第二种写法，它相对一第一种写法就是自执行然后返回一个新的函数，这样其实就是提前确定了会走哪一个方法，避免每次都进行判断。",-1),$s=(0,e._)("ol",{start:"3"},[(0,e._)("li",null,"延迟运行")],-1),As=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token class-name"},"Function"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function-variable function"},"bind"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"context"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" _this "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"this"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" args "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Array"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"slice"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("arguments"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n \n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"_this"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"apply"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("context"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" args"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br")])],-1),Is=(0,e._)("p",null,"像我们js中经常使用的bind，实现的机制就是Currying.",-1),Rs=(0,e._)("h4",{id:"通用的封装方法",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#通用的封装方法","aria-hidden":"true"},"#"),(0,e.Uk)(" 通用的封装方法")],-1),Ts=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// 初步封装"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"currying"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"fn"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// args 获取第一个方法内的全部参数"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" args "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Array"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"slice"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("arguments"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// 将后面方法里的全部参数和args进行合并"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" newArgs "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" args"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"concat"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token class-name"},"Array"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"slice"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("arguments"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// 把合并后的参数通过apply作为fn的参数并执行"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"fn"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"apply"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" newArgs"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br")])],-1),Ms=(0,e._)("p",null,"这边首先是初步封装,通过闭包把初步参数给保存下来，然后通过获取剩下的arguments进行拼接，最后执行需要currying的函数。",-1),Os=(0,e._)("p",null,"但是好像还有些什么缺陷，这样返回的话其实只能多扩展一个参数，currying(a)(b)(c)这样的话，貌似就不支持了（不支持多参数调用），一般这种情况都会想到使用递归再进行封装一层。",-1),Ps=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// 支持多参数传递"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"progressCurrying"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("fn"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" args")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" _this "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"this"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" len "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" fn"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("length"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" args "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" args "),(0,e._)("span",{class:"token operator"},"||"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" _args "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Array"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"slice"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("arguments"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token class-name"},"Array"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"push"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"apply"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("args"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" _args"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n        "),(0,e._)("span",{class:"token comment"},"// 如果参数个数小于最初的fn.length，则递归调用，继续收集参数"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("_args"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("length "),(0,e._)("span",{class:"token operator"},"<"),(0,e.Uk)(" len"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"progressCurrying"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("_this"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" fn"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" _args"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n        "),(0,e._)("span",{class:"token comment"},"// 参数收集完毕，则执行fn"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"fn"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"apply"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"this"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" _args"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br")])],-1),Hs=(0,e._)("p",null,"这边其实是在初步的基础上，加上了递归的调用，只要参数个数小于最初的fn.length，就会继续执递归。",-1),Ws=(0,e._)("h4",{id:"curry的性能",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#curry的性能","aria-hidden":"true"},"#"),(0,e.Uk)(" curry的性能")],-1),qs=(0,e._)("ul",null,[(0,e._)("li",null,"存取arguments对象通常要比存取命名参数要慢一点"),(0,e._)("li",null,"一些老版本的浏览器在arguments.length的实现上是相当慢的"),(0,e._)("li",null,"使用fn.apply( … ) 和 fn.call( … )通常比直接调用fn( … ) 稍微慢点"),(0,e._)("li",null,"创建大量嵌套作用域和闭包函数会带来花销，无论是在内存还是速度上")],-1),Fs=(0,e._)("p",null,"其实在大部分应用中，主要的性能瓶颈是在操作DOM节点上，这js的性能损耗基本是可以忽略不计的，所以curry是可以直接放心的使用。",-1),Ns=(0,e._)("h4",{id:"【经典面试题】",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#【经典面试题】","aria-hidden":"true"},"#"),(0,e.Uk)(" 【经典面试题】")],-1),Js=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// 实现一个add方法，使计算结果能够满足如下预期："),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"6"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"4"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"10"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"4"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"5"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"15"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 第一次执行时，定义一个数组专门用来存储所有的参数"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(" _args "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Array"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("prototype"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"slice"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"call"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("arguments"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"// 在内部声明一个函数，利用闭包的特性保存_args并收集所有的参数值"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"var"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"_adder"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        _args"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"push"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token operator"},"..."),(0,e.Uk)("arguments"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" _adder"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n\n    "),(0,e._)("span",{class:"token comment"},"// 利用toString隐式转换的特性，当最后执行时隐式转换，并计算最终的值返回"),(0,e.Uk)("\n    _adder"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function-variable function"},"toString"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" _args"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"reduce"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"function"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("a"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" b")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" a "),(0,e._)("span",{class:"token operator"},"+"),(0,e.Uk)(" b"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" _adder"),(0,e._)("span",{class:"token punctuation"},";"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("                "),(0,e._)("span",{class:"token comment"},"// 6"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"4"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("             "),(0,e._)("span",{class:"token comment"},"// 10"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"4"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"5"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("          "),(0,e._)("span",{class:"token comment"},"// 15"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token function"},"add"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"2"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"6"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"1"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("                "),(0,e._)("span",{class:"token comment"},"// 9"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br")])],-1),Qs={render:function(n,s){const a=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[o,(0,e._)("p",null,[(0,e._)("a",c,[p,(0,e.Wm)(a)])]),u,_,k,r,i,d,U,b,m,h,g,v,w,f,y,x,j,V,C,z,S,L,E,D,$,A,I,R,T,M,O,P,H,W,q,F,N,J,Q,B,G,Y,K,X,Z,nn,sn,an,en,tn,ln,on,cn,pn,un,_n,kn,rn,dn,Un,bn,mn,hn,gn,vn,wn,fn,yn,xn,jn,Vn,Cn,zn,Sn,Ln,En,Dn,$n,An,In,Rn,Tn,Mn,On,Pn,Hn,Wn,qn,Fn,Nn,Jn,Qn,Bn,Gn,Yn,Kn,Xn,Zn,ns,ss,as,es,ts,ls,os,cs,ps,us,_s,ks,rs,is,ds,Us,bs,ms,hs,gs,vs,ws,fs,ys,xs,js,Vs,Cs,zs,Ss,Ls,Es,Ds,$s,As,Is,Rs,Ts,Ms,Os,Ps,Hs,Ws,qs,Fs,Ns,Js],64)}}},9429:(n,s,a)=>{n.exports=a.p+"assets/img/constructor.0fd3719a.png"},8160:(n,s,a)=>{n.exports=a.p+"assets/img/vueSource.352798dc.png"}}]);