<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>01-JS基础知识 | yy3535</title>
    <meta name="description" content="yy3535的笔记">
    <link rel="icon" href="/img/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.9cd8b68b.css" as="style"><link rel="preload" href="/assets/js/app.ecbeccda.js" as="script"><link rel="preload" href="/assets/js/16.2f7621ec.js" as="script"><link rel="prefetch" href="/assets/js/10.005f17aa.js"><link rel="prefetch" href="/assets/js/11.f4ec3a10.js"><link rel="prefetch" href="/assets/js/12.a311b1f9.js"><link rel="prefetch" href="/assets/js/13.b057365d.js"><link rel="prefetch" href="/assets/js/14.1e583427.js"><link rel="prefetch" href="/assets/js/15.d8c83288.js"><link rel="prefetch" href="/assets/js/17.631936ae.js"><link rel="prefetch" href="/assets/js/18.fb66a340.js"><link rel="prefetch" href="/assets/js/19.bd564d39.js"><link rel="prefetch" href="/assets/js/2.066c3c73.js"><link rel="prefetch" href="/assets/js/20.0cb4841e.js"><link rel="prefetch" href="/assets/js/21.db0eeace.js"><link rel="prefetch" href="/assets/js/22.514f2712.js"><link rel="prefetch" href="/assets/js/23.b7054ffa.js"><link rel="prefetch" href="/assets/js/24.5abde7c4.js"><link rel="prefetch" href="/assets/js/25.5602975b.js"><link rel="prefetch" href="/assets/js/26.b82495ca.js"><link rel="prefetch" href="/assets/js/27.4df749c3.js"><link rel="prefetch" href="/assets/js/28.046a1808.js"><link rel="prefetch" href="/assets/js/29.0e292e38.js"><link rel="prefetch" href="/assets/js/3.64aa5436.js"><link rel="prefetch" href="/assets/js/30.fe9f5a0a.js"><link rel="prefetch" href="/assets/js/31.9f6ff218.js"><link rel="prefetch" href="/assets/js/32.f62164bc.js"><link rel="prefetch" href="/assets/js/33.b93423d5.js"><link rel="prefetch" href="/assets/js/34.2e195e0e.js"><link rel="prefetch" href="/assets/js/35.026c3db3.js"><link rel="prefetch" href="/assets/js/36.15631743.js"><link rel="prefetch" href="/assets/js/4.f2e8398c.js"><link rel="prefetch" href="/assets/js/5.384bdda2.js"><link rel="prefetch" href="/assets/js/6.3b2dfc5d.js"><link rel="prefetch" href="/assets/js/7.447a8182.js"><link rel="prefetch" href="/assets/js/8.3a636bdc.js"><link rel="prefetch" href="/assets/js/9.2964cd24.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9cd8b68b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.jpg" alt="yy3535" class="logo"> <span class="site-name can-hide">yy3535</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Frontend/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/Backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/Operation/" class="nav-link">运维</a></div><div class="nav-item"><a href="/Todo/" class="nav-link">待整理</a></div><div class="nav-item"><a href="https://github.com/yy3535/yy3535" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Frontend/" class="nav-link router-link-active">前端</a></div><div class="nav-item"><a href="/Backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/Operation/" class="nav-link">运维</a></div><div class="nav-item"><a href="/Todo/" class="nav-link">待整理</a></div><div class="nav-item"><a href="https://github.com/yy3535/yy3535" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>js</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Frontend/js/jsbasic/" class="active sidebar-link">01-JS基础知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#_01-变量类型和计算知识点" class="sidebar-link">01-变量类型和计算知识点</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#答题" class="sidebar-link">答题</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#_02-原型和原型链知识点" class="sidebar-link">02-原型和原型链知识点</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#答题-2" class="sidebar-link">答题</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#_03-作用域和闭包知识点" class="sidebar-link">03-作用域和闭包知识点</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#解题" class="sidebar-link">解题</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#_04异步知识点" class="sidebar-link">04异步知识点</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#解答" class="sidebar-link">解答</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#_05其他基础知识知识点" class="sidebar-link">05其他基础知识知识点</a></li><li class="sidebar-sub-header"><a href="/Frontend/js/jsbasic/#解答-2" class="sidebar-link">解答</a></li></ul></li><li><a href="/Frontend/js/jsbasic/zepto.html" class="sidebar-link">zepto源码解读</a></li><li><a href="/Frontend/js/jsbasic/shenrubibao.html" class="sidebar-link">深入理解javascript原型链和闭包</a></li><li><a href="/Frontend/js/jswebapi/" class="sidebar-link">02-JS-WEB-API</a></li><li><a href="/Frontend/js/devenv/" class="sidebar-link">03-开发环境</a></li><li><a href="/Frontend/js/runenv/" class="sidebar-link">04-运行环境</a></li><li><a href="/Frontend/js/es6/" class="sidebar-link">ES6</a></li><li><a href="/Frontend/js/designpatterns/" class="sidebar-link">前端设计模式</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>css</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Frontend/css.html" class="sidebar-link">css</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Frontend/vue.html" class="sidebar-link">vue</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Frontend/webpack.html" class="sidebar-link">webpack</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>小工具</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Frontend/vuepress.html" class="sidebar-link">vuepress</a></li><li><a href="/Frontend/markdown.html" class="sidebar-link">markdown</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="_01-js基础知识"><a href="#_01-js基础知识" aria-hidden="true" class="header-anchor">#</a> 01-JS基础知识</h1> <p></p><div class="table-of-contents"><ul><li><a href="#_01-变量类型和计算知识点">01-变量类型和计算知识点</a><ul><li><a href="#变量类型">变量类型</a></li><li><a href="#变量计算（此处为值类型的计算）">变量计算（此处为值类型的计算）</a></li></ul></li><li><a href="#答题">答题</a><ul><li><a href="#js中使用-typeof-能得到的哪些类型">JS中使用typeof能得到的哪些类型</a></li><li><a href="#何时使用-何时使用">何时使用=== 何时使用==</a></li><li><a href="#js中有哪些内置函数-——-数据封装类对象">JS中有哪些内置函数 —— 数据封装类对象</a></li><li><a href="#js变量按照存储方式区分为哪些类型，并描述其特点">JS变量按照存储方式区分为哪些类型，并描述其特点</a></li><li><a href="#如何理解json">如何理解JSON</a></li></ul></li><li><a href="#_02-原型和原型链知识点">02-原型和原型链知识点</a><ul><li><a href="#构造函数">构造函数</a></li><li><a href="#构造函数-扩展">构造函数 - 扩展</a></li><li><a href="#几个要点">几个要点</a></li><li><a href="#原型">原型</a></li><li><a href="#原型链">原型链</a></li><li><a href="#原型链中的-this">原型链中的this</a></li><li><a href="#instanceof">instanceof</a></li><li><a href="#扩展参考">扩展参考</a></li></ul></li><li><a href="#答题">答题</a><ul><li><a href="#如何-准确-判断一个变量是数组类型">如何准确判断一个变量是数组类型</a></li><li><a href="#写一个原型链继承的例子">写一个原型链继承的例子</a></li><li><a href="#描述-new-一个对象的过程">描述 new 一个对象的过程</a></li><li><a href="#zepto（或其他框架）-源码中如何使用原型链">zepto（或其他框架） 源码中如何使用原型链</a></li></ul></li><li><a href="#_03-作用域和闭包知识点">03-作用域和闭包知识点</a><ul><li><a href="#执行上下文">执行上下文</a></li><li><a href="#this">this</a></li><li><a href="#作用域">作用域</a></li><li><a href="#作用域链">作用域链</a></li><li><a href="#闭包">闭包</a></li><li><a href="#扩展阅读">扩展阅读</a></li></ul></li><li><a href="#解题">解题</a><ul><li><a href="#说一下对变量提升的理解">说一下对变量提升的理解</a></li><li><a href="#说明-this-几种不同的使用场景">说明 this 几种不同的使用场景</a></li><li><a href="#创建-10-个-a-标签，点击的时候弹出来对应的序号">创建 10 个 a 标签，点击的时候弹出来对应的序号</a></li><li><a href="#如何理解作用域">如何理解作用域</a></li><li><a href="#实际开发中闭包的应用">实际开发中闭包的应用</a></li></ul></li><li><a href="#_04异步知识点">04异步知识点</a><ul><li><a href="#什么是异步">什么是异步</a></li><li><a href="#异步和单线程">异步和单线程</a></li><li><a href="#异步的问题和解决方案">异步的问题和解决方案</a></li><li><a href="#参考和扩展阅读">参考和扩展阅读</a></li></ul></li><li><a href="#解答">解答</a><ul><li><a href="#同步和异步的区别是什么？分别举一个同步和异步的例子">同步和异步的区别是什么？分别举一个同步和异步的例子</a></li><li><a href="#一个关于-settimeout-的笔试题">一个关于setTimeout的笔试题</a></li><li><a href="#前端使用异步的场景有哪些">前端使用异步的场景有哪些</a></li></ul></li><li><a href="#_05其他基础知识知识点">05其他基础知识知识点</a><ul><li><a href="#正则表达式">正则表达式</a></li><li><a href="#日期函数">日期函数</a></li><li><a href="#math">Math</a></li><li><a href="#数组常用-api">数组常用 API</a></li><li><a href="#对象常用-api">对象常用 API</a></li></ul></li><li><a href="#解答">解答</a><ul><li><a href="#获取-2017-06-10-格式的日期">获取2017-06-10格式的日期</a></li><li><a href="#获取随机数，要求是长度一直的字符串格式">获取随机数，要求是长度一直的字符串格式</a></li><li><a href="#写一个能遍历对象和数组的-foreach-函数">写一个能遍历对象和数组的forEach函数</a></li><li><a href="#实现一个深拷贝">实现一个深拷贝</a></li><li><a href="#其他面试题">其他面试题</a></li></ul></li></ul></div><p></p> <h2 id="_01-变量类型和计算知识点"><a href="#_01-变量类型和计算知识点" aria-hidden="true" class="header-anchor">#</a> 01-变量类型和计算知识点</h2> <h3 id="变量类型"><a href="#变量类型" aria-hidden="true" class="header-anchor">#</a> 变量类型</h3> <p>JS变量最基本的分类就是<strong>值类型</strong>和<strong>引用类型</strong>，两者有何区别呢，可以通过例子看出来。</p> <p><strong>值类型：string,boolean,number,undefined</strong></p> <p><strong>引用类型：object(date,RegExp),array,function,null</strong></p> <p>以下是值类型的一个例子</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a
a <span class="token operator">=</span> <span class="token number">200</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
</code></pre></div><p>以下是引用类型的一个例子</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>age<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a
b<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">21</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
</code></pre></div><p><code>typeof</code>可以知道一个值类型是什么类型，而对于引用类型，它就无能为力了。但是它可以将引用类型区分出<code>function</code>，为什么 ———— 因为<code>function</code>相对于其他引用类型（如对象、数组）来说，具有非常特殊的意义，JS 中的函数非常重要，接下来的原型、作用域都会深入讲解函数。</p> <p>JS 中的某些表现，就已经体现了函数的特殊意义，例如：对象和数组，JS中没有内置的（不考虑 JS-WEB-API），而函数却内置了很多，例如 <code>Object</code> <code>Array</code> <code>Boolean</code> <code>Number</code> <code>String</code> <code>Function</code> <code>Date</code> <code>RegExp</code> <code>Error</code>。这些函数 JS 本身就有，要是没有它们，就没法愉快的写 JS 代码了。因为他们是基础数据类型的构造函数（后面会讲解）</p> <p><strong><code>typeof</code>可以区分类型有<code>number</code> <code>string</code> <code>boolean</code> <code>undefined</code>（值类型） <code>function</code> <code>object</code>（引用类型）</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 特例</span>
<span class="token keyword">typeof</span> <span class="token keyword">null</span> <span class="token comment">// object 因为 null 也是引用类型。null 就相当于引用类型中的 undefined</span>
</code></pre></div><p>那么针对第二个例子，如何将<code>a</code>的内容复制给<code>b</code>，并且保证<code>b</code>的修改不会影响到<code>a</code>呢？那就需要<strong>深度复制</strong>，意思就是对<code>a</code>的属性进行递归遍历，再依次复制，这块我们会放在后面专门讲解。</p> <h3 id="变量计算（此处为值类型的计算）"><a href="#变量计算（此处为值类型的计算）" aria-hidden="true" class="header-anchor">#</a> 变量计算（此处为值类型的计算）</h3> <blockquote><p>本节专门讲解值类型的计算，引用类型的计算放在后面作为“JS 算法”统一讲解。</p></blockquote> <p>组简单的计算，就是数字的加减乘除、字符串的拼接和替换，这个太简单了，这里不提了。但是 JS 在值类型的运算过程中，特别需要注意和利用<strong>强制类型转换</strong>这一特性，有以下场景：</p> <ul><li><strong>字符串拼接</strong></li> <li><strong><code>==</code></strong></li> <li><strong>逻辑运算（<code>if</code> <code>!</code> <code>||</code> <code>&amp;&amp;</code>）</strong></li></ul> <p>字符串拼接最常见的错误如下，特别要注意。如何规避呢 ———— 对进行计算的变量通过<code>typeof</code>来判断类型 ———— 太麻烦？编码本身就是一个体力活！</p> <ul><li><strong>字符串拼接</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token number">10</span>   <span class="token comment">// 110</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">'10'</span> <span class="token comment">// '10010'</span>
</code></pre></div><p>接下来，<code>==</code>也会进行强制类型转换，如</p> <ul><li><strong><code>==</code></strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//==</span>
<span class="token number">100</span> <span class="token operator">==</span> <span class="token string">'100'</span>   <span class="token comment">// true</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token string">''</span>  <span class="token comment">// true</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span>  <span class="token comment">// true</span>
</code></pre></div><p>针对<code>100 == '100'</code>就是和拼接字符串一样的类型转换，而针对下面两个例子，就是一个逻辑运算上的强制类型转换（马上会讲解）。所以，要求你写 JS 代码时，所有的地方都要使用<code>===</code>而不能使用<code>==</code>，但是阅读 jquery 源码后我发现一个特例，就是<code>obj.a == null</code>，使用很简洁。</p> <p>最后，逻辑运算中的强制类型转换，先以<code>if</code>为例说明</p> <ul><li><strong>逻辑运算（<code>if</code> <code>!</code> <code>||</code> <code>&amp;&amp;</code>）</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//if语句</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ....</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ....</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ....</span>
<span class="token punctuation">}</span>
</code></pre></div><p>所有经过<code>if</code>判断的变量，都会进行逻辑运算的强制类型转换，转换为<code>true</code>或者<code>false</code>。</p> <ul><li><strong>逻辑运算（<code>if</code> <code>!</code> <code>||</code> <code>&amp;&amp;</code>）</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//逻辑运算符</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">&amp;&amp;</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">''</span> <span class="token operator">||</span> <span class="token string">'abc'</span><span class="token punctuation">)</span>  <span class="token comment">// 'abc'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>abc<span class="token punctuation">)</span>  <span class="token comment">// true</span>

<span class="token comment">// 判断一个变量会被当做 true 还是 false</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token operator">!</span>a<span class="token punctuation">)</span>
</code></pre></div><p><strong>if(obj.a==null){
//这里相当于obj.a===null||obj.a===undefined,简写形式
}</strong></p> <h2 id="答题"><a href="#答题" aria-hidden="true" class="header-anchor">#</a> 答题</h2> <h3 id="js中使用typeof能得到的哪些类型"><a href="#js中使用typeof能得到的哪些类型" aria-hidden="true" class="header-anchor">#</a> JS中使用<code>typeof</code>能得到的哪些类型</h3> <p>针对这个题目，可以通过以下程序进行验证</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">typeof</span> <span class="token keyword">undefined</span> <span class="token comment">// undefined</span>
<span class="token keyword">typeof</span> <span class="token string">'abc'</span> <span class="token comment">// string</span>
<span class="token keyword">typeof</span> <span class="token number">123</span> <span class="token comment">// number</span>
<span class="token keyword">typeof</span> <span class="token boolean">true</span> <span class="token comment">// boolean</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">// object</span>
<span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// object</span>
<span class="token keyword">typeof</span> <span class="token keyword">null</span> <span class="token comment">// object</span>
<span class="token keyword">typeof</span> console<span class="token punctuation">.</span>log <span class="token comment">// function</span>
</code></pre></div><h3 id="何时使用-何时使用"><a href="#何时使用-何时使用" aria-hidden="true" class="header-anchor">#</a> 何时使用<code>===</code> 何时使用<code>==</code></h3> <p>首先你得明白两者的区别。<code>==</code>会先试图类型转换，然后再比较，而<code>===</code>不会类型转换，直接比较。如下例子：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">1</span> <span class="token operator">==</span> <span class="token string">'1'</span> <span class="token comment">// true</span>
<span class="token number">1</span> <span class="token operator">===</span> <span class="token string">'1'</span> <span class="token comment">// false</span>
<span class="token number">0</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token comment">// true</span>
<span class="token number">0</span> <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token comment">// false</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token comment">// true</span>
<span class="token keyword">null</span> <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token comment">// false</span>
</code></pre></div><p>根据 jQuery 源码中的写法，只推荐在一个地方用<code>==</code>，其他地方都必须用<code>===</code>。这个用<code>==</code>的地方就是：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>a <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment">// 这里相当于 obj.a === null || obj.a === undefined ，简写形式</span>
<span class="token punctuation">}</span>
</code></pre></div><p>编程是需要绝对严谨的态度，我们只在这一个地方让它进行类型转换，来简化我们的写法，因为这个场景非常简单和固定。而其他场景下，我们都必须使用<code>===</code>，除非有特殊的业务需要。</p> <h3 id="js中有哪些内置函数-——-数据封装类对象"><a href="#js中有哪些内置函数-——-数据封装类对象" aria-hidden="true" class="header-anchor">#</a> JS中有哪些内置函数 —— 数据封装类对象</h3> <p><code>Object</code> <code>Array</code> <code>Boolean</code> <code>Number</code> <code>String</code> <code>Function</code> <code>Date</code> <code>RegExp</code> <code>Error</code></p> <p>对于这种问题，回复时能把基本常用的回答上来就可以，没必要背书把所有的都写上。</p> <h3 id="js变量按照存储方式区分为哪些类型，并描述其特点"><a href="#js变量按照存储方式区分为哪些类型，并描述其特点" aria-hidden="true" class="header-anchor">#</a> JS变量按照存储方式区分为哪些类型，并描述其特点</h3> <ul><li>值类型 <code>undefined</code> <code>string</code> <code>number</code> <code>boolean</code></li> <li>引用类型 <code>object</code> <code>function</code></li></ul> <p>最后补充一点，在 JS 中，所有的引用类型都可以自由设置属性</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
arr<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
fn<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span>
</code></pre></div><h3 id="如何理解json"><a href="#如何理解json" aria-hidden="true" class="header-anchor">#</a> 如何理解JSON</h3> <p>这个问题，很容易被一些初学者误答。其实，JSON 是什么？从 JS 角度回答，太简单了，<code>console.log(JSON)</code>得到<code>JSON</code>只是一个对象，有<code>parse</code>和<code>stringify</code>两个方法，使用也非常简单</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>a<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token constant">JOSN</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'{&quot;a&quot;:10,&quot;b&quot;:20}'</span><span class="token punctuation">)</span>
</code></pre></div><p>我之所以误答，就是怕初学者把这个问题搞大，因为 json 也是一种数据格式，这一点和 xml 一样。但是在 JS 的面试题中，如果问到这个问题，直接说明<code>parse</code>和<code>stringify</code>两个方法的用法即可，面试官如果有追问，你再去继续回答。</p> <h2 id="_02-原型和原型链知识点"><a href="#_02-原型和原型链知识点" aria-hidden="true" class="header-anchor">#</a> 02-原型和原型链知识点</h2> <p>JS 是基于原型的语言，原型理解起来非常简单。任何长存不会被遗弃和提到的东西，都是最简单的东西。</p> <h3 id="构造函数"><a href="#构造函数" aria-hidden="true" class="header-anchor">#</a> 构造函数</h3> <p>所有的 JS 入门教程都会有类似这样的例子</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
    <span class="token keyword">this</span><span class="token punctuation">.</span>class <span class="token operator">=</span> <span class="token string">'class-1'</span>
    <span class="token comment">// return this  // 默认有这一行</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'zhangsan'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token comment">// var f1 = new Foo('lisi', 22)  // 创建多个对象</span>
</code></pre></div><p>以上示例是通过<code>new Foo</code>创建出来一个<code>f</code>对象，对象有<code>name</code> <code>age</code> <code>class</code>三个属性，<strong>这样我们就称<code>Foo</code>是<code>f</code>的构造函数</strong>。构造函数这个概念在高级语言中都存在，它就像一个模板一样，可以创建出若干个示例。</p> <p>函数执行的时候，如果前面带有<code>new</code>，那么函数内部的<code>this</code>在执行时就完全不一样了，不带<code>new</code>的情况我们下一章节会讲到。<strong>带<code>new</code>执行时，函数中的<code>this</code>就会变成一个空对象，让程序为其属性赋值，然后最终返回。</strong><code>return this</code>是默认执行的，如何验证？———— 你可以最后加一个<code>return {x:10}</code>试一下。返回之后，<code>f</code>就被赋值成了这个新对象，这样就创建完成了。</p> <h3 id="构造函数-扩展"><a href="#构造函数-扩展" aria-hidden="true" class="header-anchor">#</a> 构造函数 - 扩展</h3> <p>**- <code>var a = {}</code>其实是<code>var a = new Object()</code>的语法糖</p> <ul><li><code>var a = []</code>其实是<code>var a = new Array()</code>的语法糖</li> <li><code>function Foo(){...}</code>其实是<code>var Foo = new Function(...)</code>的语法糖**</li></ul> <p>大家看到以上几点，明白我要表达的意思了吗？</p> <p><strong>如何判断一个函数是否是一个变量的构造函数呢 ———— 使用<code>instanceof</code></strong>，原理接下来就会讲到。</p> <h3 id="几个要点"><a href="#几个要点" aria-hidden="true" class="header-anchor">#</a> 几个要点</h3> <p>以下要点，要全部明白并且记住！！！在此我会详细解释</p> <ul><li><strong>所有的引用类型（数组、对象、函数），都具有对象特性，即可自由扩展属性（除了<code>null</code>意外）</strong></li> <li><strong>所有的引用类型（数组、对象、函数），都有一个<code>__proto__</code>(隐式原型)属性，属性值是一个普通的对象</strong></li> <li><strong>所有的函数，都有一个<code>prototype</code>（显示原型）属性，属性值也是一个普通的对象</strong></li> <li><strong>所有的引用类型（数组、对象、函数），<code>__proto__</code>属性值指向它的构造函数的<code>prototype</code>属性值</strong></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> arr<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">fn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
fn<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
</code></pre></div><h3 id="原型"><a href="#原型" aria-hidden="true" class="header-anchor">#</a> 原型</h3> <p>我们先将一开始的示例做一下改动，然后看一下执行的效果</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 构造函数</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">alertName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 创建示例</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'zhangsan'</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span><span class="token function-variable function">printName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 测试</span>
f<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span><span class="token function">alertName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>执行<code>printName</code>时很好理解，但是执行<code>alertName</code>时发生了什么？这里再记住一个重点 <strong>当试图得到一个对象的某个属性时，如果这个对象本身没有这个属性，那么会去它的<code>__proto__</code>（即它的构造函数的<code>prototype</code>）中寻找</strong></p> <p>那么<strong>如何判断一个这个属性是不是对象本身的属性呢？使用<code>hasOwnProperty</code>，常用的地方是遍历一个对象的时候</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> item
<span class="token keyword">for</span> <span class="token punctuation">(</span>item <span class="token keyword">in</span> f<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 高级浏览器已经在 for in 中屏蔽了来自原型的属性，但是这里建议大家还是加上这个判断，保证程序的健壮性</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="原型链"><a href="#原型链" aria-hidden="true" class="header-anchor">#</a> 原型链</h3> <p>还是接着上面的示例，执行<code>f.toString()</code>时，又发生了什么？因为<code>f</code>本身没有<code>toString()</code>，并且<code>f.__proto__</code>（即<code>Foo.prototype</code>）中也没有<code>toString</code>。这个问题还是得拿出刚才那句话————<strong>当试图得到一个对象的某个属性时，如果这个对象本身没有这个属性，那么会去它的<code>__proto__</code>（即它的构造函数的<code>prototype</code>）中寻找</strong></p> <p>如果在<code>f.__proto__</code>中没有找到<code>toString</code>，那么就继续去<code>f.__proto__.__proto__</code>中寻找，因为<code>f.__proto__</code>就是一个普通的对象而已嘛！</p> <p>这样一直往上找，你会发现是一个链式的结构，所以叫做“原型链”。直到找到最上层都没有找到，那么就宣告失败，返回<code>undefined</code>。最上层是什么 ———— <code>Object.prototype.__proto__ === null</code></p> <h3 id="原型链中的this"><a href="#原型链中的this" aria-hidden="true" class="header-anchor">#</a> 原型链中的<code>this</code></h3> <p>所有的从原型或者更高级的原型中得到、执行的方法，其中的<code>this</code>在执行时，就指向了当前这个触发事件执行的对象。因此<code>printName</code>和<code>alertName</code>中的<code>this</code>都是<code>f</code>。</p> <h3 id="instanceof"><a href="#instanceof" aria-hidden="true" class="header-anchor">#</a> instanceof</h3> <p>开始介绍的<code>instanceof</code>这里再讲一下原理。如果要计算<code>f instanceof Foo</code>是不是正确，就要判断<code>f</code>的原型一层一层往上，能否对应到<code>Foo.prototype</code>。同理，如果要计算<code>f instanceof Object</code>是不是正确，就要判断<code>f</code>的原型一层一层往上，能否对应到<code>Object.prototype</code></p> <h3 id="扩展参考"><a href="#扩展参考" aria-hidden="true" class="header-anchor">#</a> 扩展参考</h3> <p>讲解原型和原型链，绝对要参考我之前写过的文章[《深入理解JS原型和闭包系列博客》]</p> <h2 id="答题-2"><a href="#答题-2" aria-hidden="true" class="header-anchor">#</a> 答题</h2> <h3 id="如何准确判断一个变量是数组类型"><a href="#如何准确判断一个变量是数组类型" aria-hidden="true" class="header-anchor">#</a> 如何<strong>准确</strong>判断一个变量是数组类型</h3> <p>只有<code>instanceof</code>才能判断一个对象是否是真正的数组，<code>instanceof</code>的具体原理后面会讲到。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
arr <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token comment">// true</span>
<span class="token keyword">typeof</span> arr <span class="token comment">// object，typeof 是无法判断是否是数组的</span>
</code></pre></div><p>扩展：实际应用中，和数组同样重要、起同样作用并且更加灵活的数据结构还是“伪数组”或者“类数据”（jquery 就用到了）。因此，<strong>在实际应用中，只需要判断<code>length</code>属性是否是数字即可。</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> likeArr <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'aaa'</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'bbb'</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'ccc'</span><span class="token punctuation">,</span>
    length<span class="token punctuation">:</span> <span class="token number">3</span>
<span class="token punctuation">}</span>

<span class="token keyword">typeof</span> arr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token comment">// true</span>
<span class="token keyword">typeof</span> likeArr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token comment">// true</span>
</code></pre></div><p>PS：<strong>为何需要要扩展补充？</strong> 在面试过程中，面试官很希望能从你那里得到“惊喜”，即面的他提问的问题，你正确回答之后，还能有所补充，这样你会加分不少。在日常工作中也一样，如果你能在完成工作之后再去考虑如何更有质量、更有效率的完成工作，或者通过本次工作的总结出一种方式，能更好的完成接下来的工作，那你的 leader 绝对高看你一眼。这其实就是我们所说的<strong>积极、主动和工作热情</strong>，光嘴说没用，你得实干。</p> <h3 id="写一个原型链继承的例子"><a href="#写一个原型链继承的例子" aria-hidden="true" class="header-anchor">#</a> 写一个原型链继承的例子</h3> <p>接下来继续回答这个问题。你看其他人的培训或者看书，这个例子一般都会给你弄一些小猫小狗小动物来演示，例如</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 动物</span>
<span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'animal eat'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 狗</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">bark</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dog bark'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 哈士奇</span>
<span class="token keyword">var</span> hashiqi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Elem</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>elem<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token class-name">Elem</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">html</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> elem<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>elem
	<span class="token keyword">if</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">{</span>
		elem<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span>val
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token comment">//链式操作</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> elem<span class="token punctuation">.</span>innerHTML
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Elem</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">on</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> elem<span class="token operator">=</span><span class="token keyword">this</span><span class="token punctuation">.</span>elem
	elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> div1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Elem</span><span class="token punctuation">(</span><span class="token string">'detail-page'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div1<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
div1<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">'&lt;p&gt;hello imooc&lt;/p&gt;'</span><span class="token punctuation">)</span>
div1<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 构造函数</span>
<span class="token keyword">function</span> <span class="token function">DomElement</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> result <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
    <span class="token keyword">var</span> length <span class="token operator">=</span> result<span class="token punctuation">.</span>length
    <span class="token keyword">var</span> i
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> selectorResult<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> length
<span class="token punctuation">}</span>
<span class="token comment">// 修改原型</span>
<span class="token class-name">DomElement</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
    constructor<span class="token punctuation">:</span> DomElement<span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">forEach</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> i
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> elem <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> elem<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">on</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">elem</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            elem<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用</span>
<span class="token keyword">var</span> $div <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DomElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
$div<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="描述-new-一个对象的过程"><a href="#描述-new-一个对象的过程" aria-hidden="true" class="header-anchor">#</a> 描述 new 一个对象的过程</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'foo'</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'beijing'</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>创建一个新对象</li> <li><code>this</code>指向这个新对象</li> <li>执行代码，即对<code>this</code>赋值</li> <li>返回<code>this</code></li></ul> <h3 id="zepto（或其他框架）-源码中如何使用原型链"><a href="#zepto（或其他框架）-源码中如何使用原型链" aria-hidden="true" class="header-anchor">#</a> zepto（或其他框架） 源码中如何使用原型链</h3> <p>参考我在慕课网的视频教程<a href="http://www.imooc.com/learn/745" target="_blank" rel="noopener noreferrer">zepto设计和源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，免费的。</p> <h2 id="_03-作用域和闭包知识点"><a href="#_03-作用域和闭包知识点" aria-hidden="true" class="header-anchor">#</a> 03-作用域和闭包知识点</h2> <p>本节我们将全面梳理 JS 代码的执行过程，涉及到的概念有非常多。所以大家一定要耐心听，如果你此前不了解这一块，而通过本教程掌握了这方面知识，对你的基础知识将会有质的提醒。</p> <h3 id="执行上下文"><a href="#执行上下文" aria-hidden="true" class="header-anchor">#</a> 执行上下文</h3> <p>先看下面的例子，你可能会对结果比较差异。当然，我不建议在实际开发中通过这种方式来炫技，我们这里演示纯粹是为了讲解知识点做一个铺垫。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>  <span class="token comment">// undefined</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>

<span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'zhangsan'</span><span class="token punctuation">)</span>  <span class="token comment">// 'zhangsan' 20</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    age <span class="token operator">=</span> <span class="token number">20</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span>
    <span class="token keyword">var</span> age
<span class="token punctuation">}</span>
</code></pre></div><p>在一段 JS 脚本（即一个<code>&lt;script&gt;</code>标签中）执行之前，会先创建一个<strong>全局执行上下文</strong>环境，先把代码中即将执行的（内部函数的不算，因为你不知道函数何时执行）变量、函数声明（和“函数表达式”的区别）都拿出来。变量先暂时赋值为<code>undefined</code>，函数则先声明好可使用。这一步做完了，然后再开始正式执行程序。再次强调，这是在代码执行之前才开始的工作。</p> <p>另外，一个函数在执行之前，也会创建一个<strong>函数执行上下文</strong>环境，跟<strong>全局上下文</strong>差不多，不过<strong>函数执行上线文</strong>中会多出<code>this</code> <code>arguments</code>和函数的参数。参数和<code>arguments</code>好理解，这里的<code>this</code>咱们需要专门讲解。</p> <p>总结一下</p> <ul><li>范围：一段<code>&lt;script&gt;</code>或者一个函数</li> <li>全局：变量定义，函数声明</li> <li>函数：变量定义，函数声明，this，arguments</li></ul> <h3 id="this"><a href="#this" aria-hidden="true" class="header-anchor">#</a> this</h3> <p>先搞明白一个很重要的概念 ———— <strong><code>this</code>的值是在执行的时候才能确认，定义的时候不能确认！</strong> 为什么呢 ———— 因为<code>this</code>是执行上下文环境的一部分，而执行上下文需要在代码执行之前确定，而不是定义的时候。看如下例子</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'A'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fn</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
a<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// this === a</span>
a<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> <span class="token string">'B'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// this === {name: 'B'}</span>
<span class="token keyword">var</span> fn1 <span class="token operator">=</span> a<span class="token punctuation">.</span>fn
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// this === window</span>
</code></pre></div><p><code>this</code>执行会有不同，主要集中在这几个场景中</p> <ul><li>作为构造函数执行（new的时候，this会是一个空对象，在构造函数中赋值后返回）</li> <li>作为对象属性执行（可能有三种结果，如上）</li> <li>作为普通函数执行（可能有两种结果，如下）</li> <li>用于<code>call</code> <code>apply</code> <code>bind</code></li></ul> <p>前两种情况咱们之前都介绍过了，这里只是统一的提出来，汇总一下，不再详细讲了。这里主要说第三种</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// window</span>
<span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>a<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// {a:100}  和 call 同理的还有 apply bind</span>
</code></pre></div><h3 id="作用域"><a href="#作用域" aria-hidden="true" class="header-anchor">#</a> 作用域</h3> <p>作为有 JS 基础的同学，你应该了解 JS 没有块级作用域。例如</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'zhangsan'</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
</code></pre></div><p>从上面的例子可以体会到作用域的概念，作用域就是一个独立的地盘，让变量不会外泄、暴露出去。上面的<code>name</code>就被暴露出去了，因此，<strong>JS 没有块级作用域，只有全局作用域和函数作用域</strong>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">200</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'global'</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>全局作用域就是最外层的作用域，如果我们写了很多行 JS 代码，变量定义都没有用函数包括，那么他们就全部都在全局作用域中。这样的坏处就是很容易装车。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 张三写的代码中</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">}</span>

<span class="token comment">// 李四写的代码中</span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span><span class="token boolean">true</span><span class="token punctuation">}</span>
</code></pre></div><p>这就是为何 jquery zepto 等库的源码，所有的代码都会放在<code>(function(){....})()</code>中。因为放在里面的所有变量，都不会被外泄和暴露，不会污染到外面，不会对其他的库或者 JS 脚本造成影响。这是函数作用域的一个体现。</p> <h3 id="作用域链"><a href="#作用域链" aria-hidden="true" class="header-anchor">#</a> 作用域链</h3> <p>首先认识一下什么叫做<strong>自由变量</strong>。如下代码中，<code>console.log(a)</code>要得到<code>a</code>变量，但是在当前的作用域中没有定义<code>a</code>（可对比一下<code>b</code>）。当前作用域没有定义的变量，这成为<strong>自由变量</strong>。自由变量如何得到 ———— 向父级作用域寻找。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">200</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>如果父级也没呢？再一层一层向上寻找，直到找到全局作用域还是没找到，就宣布放弃。这种一层一层的关系，就是<strong>作用域链</strong>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
<span class="token keyword">function</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">200</span>
    <span class="token keyword">function</span> <span class="token constant">F2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">300</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token constant">F2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="闭包"><a href="#闭包" aria-hidden="true" class="header-anchor">#</a> 闭包</h3> <p>直接看一个例子</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">200</span>
<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>自由变量将从作用域链中去寻找，但是<strong>依据的是函数定义时的作用域链，而不是函数执行时</strong>，以上这个例子就是闭包。闭包主要有两个应用场景：</p> <ul><li>函数作为返回值，上面的例子就是</li> <li>函数作为参数传递，看以下例子</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">100</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token constant">F2</span><span class="token punctuation">(</span><span class="token parameter">f1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">200</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token constant">F1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token constant">F2</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>面试题</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>var name = &quot;The Window&quot;;
var object = {
    name : &quot;My Object&quot;,
    getNameFunc : function(){
        return (function(){
             alert(this.name);
        })();
    },

    getName:function(){
        alert(this.name);
    }
};
object.getNameFunc();  //The Window
object.getName();  //My Object
</code></pre></div><p>答：函数 getNameFunc 内返回一个闭包，因此 this 指向全局对象，所以 this.name 即为定义在全部作用域下的 name（&quot;The Window&quot;）。
而函数 getName 内并未返回闭包，因此 this 指向当前对象，所以 this.name 即为当前作用域下的 name（&quot;My Object&quot;）。</p> <h3 id="扩展阅读"><a href="#扩展阅读" aria-hidden="true" class="header-anchor">#</a> 扩展阅读</h3> <p>请参考我之前写过的文章<a href="http://www.cnblogs.com/wangfupeng1988/p/3977924.html" target="_blank" rel="noopener noreferrer">《深入理解JS原型和闭包系列博客》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="解题"><a href="#解题" aria-hidden="true" class="header-anchor">#</a> 解题</h2> <h3 id="说一下对变量提升的理解"><a href="#说一下对变量提升的理解" aria-hidden="true" class="header-anchor">#</a> 说一下对变量提升的理解</h3> <p>函数执行时会先创建当前的上下文环境，其中这两点会产生“变量提升”的效果</p> <ul><li>变量定义</li> <li>函数声明</li></ul> <h3 id="说明-this-几种不同的使用场景"><a href="#说明-this-几种不同的使用场景" aria-hidden="true" class="header-anchor">#</a> 说明 this 几种不同的使用场景</h3> <ul><li>作为构造函数执行</li> <li>作为对象属性执行</li> <li>作为普通函数执行</li> <li>call apply bind</li></ul> <h3 id="创建-10-个-a-标签，点击的时候弹出来对应的序号"><a href="#创建-10-个-a-标签，点击的时候弹出来对应的序号" aria-hidden="true" class="header-anchor">#</a> 创建 10 个 a 标签，点击的时候弹出来对应的序号</h3> <p>错误的写法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> i<span class="token punctuation">,</span> a
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    a<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span>
    a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>正确的写法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> i
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        a<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token string">'&lt;br&gt;'</span>
        a<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">alert</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面的回答已经结束了，但是还有一点可以优化，如果能做到，那将会给你加分。提示一下，是关于 DOM 操作的性能问题的。这里先按下不表，等后面讲解性能问题的时候再说。有兴趣的可以先去查查<code>DocumentFragment</code></p> <h3 id="如何理解作用域"><a href="#如何理解作用域" aria-hidden="true" class="header-anchor">#</a> 如何理解作用域</h3> <p>根据我之前写过的<a href="http://www.cnblogs.com/wangfupeng1988/p/3977924.html" target="_blank" rel="noopener noreferrer">《深入理解JS原型和闭包》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>系列博客，详细讲解作用域和闭包。</p> <h3 id="实际开发中闭包的应用"><a href="#实际开发中闭包的应用" aria-hidden="true" class="header-anchor">#</a> 实际开发中闭包的应用</h3> <p>闭包的实际应用，主要是用来封装变量。即把变量隐藏起来，不让外面拿到和修改。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">isFirstLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> _list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_list<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            _list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用</span>
<span class="token keyword">var</span> firstLoad <span class="token operator">=</span> <span class="token function">isFirstLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">firstLoad</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">firstLoad</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token function">firstLoad</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><h2 id="_04异步知识点"><a href="#_04异步知识点" aria-hidden="true" class="header-anchor">#</a> 04异步知识点</h2> <h3 id="什么是异步"><a href="#什么是异步" aria-hidden="true" class="header-anchor">#</a> 什么是异步</h3> <p>先看下面的 demo，根据程序阅读起来表达的意思，应该是先打印<code>100</code>，1秒钟之后打印<code>200</code>，最后打印<code>300</code>。但是实际运营根本不是那么回事。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre></div><p>再对比以下程序。先打印<code>100</code>，再弹出<code>200</code>（等待用户确认），最后打印<code>300</code>。这个运行效果就符合预期要求。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>  <span class="token comment">// 1秒钟之后点击确认</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre></div><p>这俩到底有何区别？———— 第一个示例中间的步骤根本没有阻塞接下来程序的运行，而第二个示例却阻塞了后面程序的运行。前面这种表现就叫做<strong>异步</strong>（后面这个叫做<strong>同步</strong>）</p> <p>为何需要异步呢？如果第一个示例中间步骤是一个 ajax 请求，现在网络比较慢，请求需要5秒钟。如果是同步，这5秒钟页面就卡死在这里啥也干不了了。</p> <p>最后，前端 JS 脚本用到异步的场景主要有两个：</p> <ul><li>定时 <code>setTimeout</code> <code>setInverval</code></li> <li>网络请求，如 <code>ajax</code> <code>&lt;img&gt;</code>加载</li> <li>事件绑定（后面会有解释）</li></ul> <p>ajax 代码示例</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'./data1.json'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>
</code></pre></div><p>img 代码示例（常用语打点统计）</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'loaded'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'/xxx.png'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>
</code></pre></div><p>事件绑定</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'clicked'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="异步和单线程"><a href="#异步和单线程" aria-hidden="true" class="header-anchor">#</a> 异步和单线程</h3> <p>JS 在客户端运行的时候，只有一个线程可运行，因此想要两件事儿同时干是不可能的。如果没有异步，我们只能同步干，就像第二个示例一样，等待过程中卡住了，但是有了异步就没有问题了。那么单线程是如何实现异步的呢？</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre></div><p>那上面的示例来说，有以下几点。重点从这个过程中体会<strong>单线程</strong>这个概念，即事情都是一步一步做的，不能两件事儿一起做。</p> <ul><li>执行第一行，打印<code>100</code></li> <li>执行<code>setTimeout</code>后，传入<code>setTimeout</code>的函数会被暂存起来，不会立即执行。</li> <li>执行最后一行，打印<code>300</code></li> <li>待所有程序执行完，处于空闲状态时，会立马看有没有暂存起来的要执行。</li> <li>发现暂存起来的<code>setTimeout</code>中的函数无需等待时间，就立即来过来执行</li></ul> <p>下面再来一个<code>setTimeout</code>的例子。规则和上面的一样，只不过这里暂存起来的函数，需要等待 1s 之后才能被执行。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre></div><p>下面再来一个 ajax 的例子。规则也是一样的，只不过这里暂存起来的函数，要等待网络请求返回之后才能被执行，具体时间不一定。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre></div><p>最后再解释一下事件绑定，如下代码。其实事件绑定的实现原理和上面的是一样的，也是会把时间暂存，但是要等待用户点击只有，才能被执行。原理是一样的，因此事件绑定在原理上来说，可以算作是异步。但是从设计上来说，还是分开好理解一些。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
$btn<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>重点：异步的实现机制，以及对单线程的理解</strong></p> <hr> <p>下面的暂时先不讲</p> <h3 id="异步的问题和解决方案"><a href="#异步的问题和解决方案" aria-hidden="true" class="header-anchor">#</a> 异步的问题和解决方案</h3> <p>异步遇到的最大的问题</p> <ul><li>callback-hell</li> <li>易读性差，即书写顺序和执行顺序不一致</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start'</span><span class="token punctuation">)</span>
$<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'./data1.json'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span>
    $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'./data2.json'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data2<span class="token punctuation">)</span>
        $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'./data3.json'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data3<span class="token punctuation">)</span>
            $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'./data4.json'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data4<span class="token punctuation">)</span>
                <span class="token comment">// ...继续嵌套...</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>
</code></pre></div><p>不过目前已经有了非常明确的解决方案 —— Promise，并且 Promise 放在 ES6 的标准中了。很遗憾本教程的范围不包括 ES6 ，因为 ES6 包含的内容太多了，放在这个教程中会很庞大，成本太高。</p> <blockquote><p>要想把异步讲全面，那得单独需要一门课程花5-7个小时去讲解（JS、jquery、ES6、node）。如果这样一讲，那就又带出了ES6的很多知识，又得花额外的时间去讲解，这样算下来，就得10多个小时。</p></blockquote> <p>我提供了一个参考链接，如果大家有本节课的基础，再去看参考链接的内容，应该能掌握异步更高级的知识。</p> <h3 id="参考和扩展阅读"><a href="#参考和扩展阅读" aria-hidden="true" class="header-anchor">#</a> 参考和扩展阅读</h3> <ul><li><a href="http://www.cnblogs.com/wangfupeng1988/p/6513070.html" target="_blank" rel="noopener noreferrer">深入理解 JavaScript 异步系列（1）——基础<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.cnblogs.com/wangfupeng1988/p/6515779.html" target="_blank" rel="noopener noreferrer">深入理解 JavaScript 异步系列（2）—— jquery的解决方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.cnblogs.com/wangfupeng1988/p/6515855.html" target="_blank" rel="noopener noreferrer">深入理解 JavaScript 异步系列（3）—— ES6 中的 Promise<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.cnblogs.com/wangfupeng1988/p/6532713.html" target="_blank" rel="noopener noreferrer">深入理解 JavaScript 异步系列（4）—— Generator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.cnblogs.com/wangfupeng1988/p/6532734.html" target="_blank" rel="noopener noreferrer">深入理解 JavaScript 异步系列（5）—— async await<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="解答"><a href="#解答" aria-hidden="true" class="header-anchor">#</a> 解答</h2> <h3 id="同步和异步的区别是什么？分别举一个同步和异步的例子"><a href="#同步和异步的区别是什么？分别举一个同步和异步的例子" aria-hidden="true" class="header-anchor">#</a> 同步和异步的区别是什么？分别举一个同步和异步的例子</h3> <p>同步会阻塞代码执行，而异步不会。<code>alert</code>是同步，<code>setTimeout</code>是异步</p> <h3 id="一个关于settimeout的笔试题"><a href="#一个关于settimeout的笔试题" aria-hidden="true" class="header-anchor">#</a> 一个关于<code>setTimeout</code>的笔试题</h3> <p>面试题中，<code>setTimeout</code>的基本是必会出现的</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 以下代码执行后，打印出来的结果是什么</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><p>该题目的答案是<code>1 3 5 2 4</code>，不知道跟你答对了没有。具体的原理，我们后面再详细讲解。</p> <h3 id="前端使用异步的场景有哪些"><a href="#前端使用异步的场景有哪些" aria-hidden="true" class="header-anchor">#</a> 前端使用异步的场景有哪些</h3> <ul><li>setTimeout setInterval</li> <li>网络请求</li> <li>事件绑定（可以说一下自己的理解）</li></ul> <h2 id="_05其他基础知识知识点"><a href="#_05其他基础知识知识点" aria-hidden="true" class="header-anchor">#</a> 05其他基础知识知识点</h2> <h3 id="正则表达式"><a href="#正则表达式" aria-hidden="true" class="header-anchor">#</a> 正则表达式</h3> <p><code>test</code>函数的用法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> ua <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex">/\bMicroMessenger\b/i</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>ua<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>用于<code>replace</code>的示例</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/(^\s+)|(\s+$)/g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>match</code>函数的用法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'http://www.abc.com/path/xxx.html?a=10&amp;b=20&amp;c=30#topic'</span>  <span class="token comment">// 后面的 #topic 也可能没有</span>
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex">/\?(.+?)(#|$)/</span>
<span class="token keyword">var</span> matchResult <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>matchResult<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// a=10&amp;b=20&amp;c=30</span>
</code></pre></div><p>略过正则表达式，不讲</p> <hr> <h3 id="日期函数"><a href="#日期函数" aria-hidden="true" class="header-anchor">#</a> 日期函数</h3> <p>日期函数最常用的 API 如下</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 获取当前时间毫秒数</span>
<span class="token keyword">var</span> dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
dt<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 获取毫秒数</span>
dt<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 年</span>
dt<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 月（0 - 11）</span>
dt<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 日（0 - 31）</span>
dt<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 小时（0 - 23）</span>
dt<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 分钟（0 - 59）</span>
dt<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 秒（0 - 59）</span>
</code></pre></div><h3 id="math"><a href="#math" aria-hidden="true" class="header-anchor">#</a> Math</h3> <p>Math 最常用的只有一个 API —— <code>Math.random()</code>，常用于清除浏览器缓存，比如频繁访问一个链接，就在链接后加一个random()</p> <p>背讲义所有方法。</p> <h3 id="数组常用-api"><a href="#数组常用-api" aria-hidden="true" class="header-anchor">#</a> 数组常用 API</h3> <ul><li>Array.forEach</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 遍历数组的所有元素</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>Array.every</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用来判断所有的数组元素，都满足一个条件</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> ture
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre></div><ul><li>Array.some</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 用来判断所有的数组元素，只要有一个满足条件即可</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> ture
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre></div><ul><li>Array.sort</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 从小到大排序</span>
    <span class="token keyword">return</span> a <span class="token operator">-</span> b
    <span class="token comment">// 从大到小排序</span>
    <span class="token comment">// return b - a</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
</code></pre></div><ul><li>Array.map</li></ul> <p>第一个函数返回对数组每个元素进行操作，创建一个新数组</p> <div class="language- extra-class"><pre class="language-text"><code>Array.map(function(currentValue,index,arr),this.Value)
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将元素重新组装，并返回</span>
    <span class="token keyword">return</span> <span class="token string">'&lt;b&gt;'</span> <span class="token operator">+</span> item <span class="token operator">+</span> <span class="token string">'&lt;/b&gt;'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
</code></pre></div><ul><li>Array.filter</li></ul> <p>第一个函数返回筛选条件，筛选符合条件的元素。</p> <div class="language- extra-class"><pre class="language-text"><code>Array.filter(function(currentValue,index,arr),this.Value)
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过某一个条件过滤数组</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span>
</code></pre></div><ul><li>Array.reduce</li></ul> <p>第一个函数返回总值和每一项的计算，对数组进行计算后得到结果</p> <div class="language- extra-class"><pre class="language-text"><code>Array.reduce(function(total,currentValue,index,arr),initialValue)
</code></pre></div><ul><li>Array.from</li></ul> <p>from() 方法用于通过拥有 length 属性的对象或可迭代的对象来返回一个数组。</p> <div class="language- extra-class"><pre class="language-text"><code>Array.from(object, mapFunction, thisValue)
</code></pre></div><h3 id="对象常用-api"><a href="#对象常用-api" aria-hidden="true" class="header-anchor">#</a> 对象常用 API</h3> <ul><li>for-in</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    x<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    y<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    z<span class="token punctuation">:</span> <span class="token number">300</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> key
<span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 注意这里的 hasOwnProperty，再讲原型链时候讲过了</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="解答-2"><a href="#解答-2" aria-hidden="true" class="header-anchor">#</a> 解答</h2> <h3 id="获取2017-06-10格式的日期"><a href="#获取2017-06-10格式的日期" aria-hidden="true" class="header-anchor">#</a> 获取<code>2017-06-10</code>格式的日期</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token parameter">dt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> year <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> month <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">var</span> date <span class="token operator">=</span> dt<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 强制类型转换</span>
        month <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> month
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>date <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 强制类型转换</span>
        date <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> date
    <span class="token punctuation">}</span>
    <span class="token comment">// 强制类型转换</span>
    <span class="token keyword">return</span> year <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> month <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> date
<span class="token punctuation">}</span>
<span class="token keyword">var</span> dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> formatDate <span class="token operator">=</span> <span class="token function">formatDate</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>formatDate<span class="token punctuation">)</span>
</code></pre></div><h3 id="获取随机数，要求是长度一直的字符串格式"><a href="#获取随机数，要求是长度一直的字符串格式" aria-hidden="true" class="header-anchor">#</a> 获取随机数，要求是长度一直的字符串格式</h3> <p>使用<code>Math.random()</code>可获取字符串，但是返回的是一个小于 1 的小数，而且小数点后面长度不同</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> random <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> random <span class="token operator">=</span> random <span class="token operator">+</span> <span class="token string">'0000000000'</span>  <span class="token comment">// 后面加上 10 个零</span>
<span class="token keyword">var</span> random <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>random<span class="token punctuation">)</span>
</code></pre></div><p>背诵字符串的方法</p> <h3 id="写一个能遍历对象和数组的foreach函数"><a href="#写一个能遍历对象和数组的foreach函数" aria-hidden="true" class="header-anchor">#</a> 写一个能遍历对象和数组的<code>forEach</code>函数</h3> <p>遍历数组使用<code>forEach</code>，而遍历对象使用<code>for in</code>，但是在实际开发中，可以使用一个函数就遍历两者，jquery 就有这样的函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> key
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 准确判断是不是数组</span>
        obj<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">fn</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 不是数组就是对象</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            							       		   <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token function">fn</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token comment">// 注意，这里参数的顺序换了，为了和对象的遍历格式一致</span>
<span class="token function">forEach</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">}</span>
<span class="token function">forEach</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="实现一个深拷贝"><a href="#实现一个深拷贝" aria-hidden="true" class="header-anchor">#</a> 实现一个深拷贝</h3> <div class="language- extra-class"><pre class="language-text"><code>function deepCopy(obj){
    //递归跳出去的条件，不加的话就相当于死循环
    if(typeof obj!='object'){
        return obj;
    }
    var newObj;
    if(obj instanceof Array){
        newObj=[];
    }else{
        newObj={};
    }
    //将obj身上的所有属性复制到newObj身上
    for(var attr in obj){
        //自己调用自己  （递归）
        newObj[attr]=deepCopy(obj[attr]);
    }
    return newObj;
};
</code></pre></div><h3 id="其他面试题"><a href="#其他面试题" aria-hidden="true" class="header-anchor">#</a> 其他面试题</h3> <ul><li>setTimeout设置为0有什么作用？</li></ul> <div class="language- extra-class"><pre class="language-text"><code>var fuc = [1,2,3];
for(var i in fuc){
  setTimeout(function(){console.log(fuc[i])},0);
  console.log(fuc[i]);
}
//1
//2
//3
//3
//3
</code></pre></div><p>虽然设置为0秒后执行任务，实际上是大于0秒才执行的。可是这有什么用呢？</p> <p>用处就在于我们可以改变任务的执行顺序！因为浏览器会在执行完当前任务队列中的任务，再执行setTimeout队列中积累的的任务。</p> <p>通过设置任务在延迟到0s后执行，就能改变任务执行的先后顺序，延迟该任务发生，使之异步执行。</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/Frontend/js/jsbasic/zepto.html">
          zepto源码解读
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.ecbeccda.js" defer></script><script src="/assets/js/16.2f7621ec.js" defer></script>
  </body>
</html>
